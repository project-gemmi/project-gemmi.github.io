<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gemmi C++ API: /home/wojdyr/gemmi/gemmi/include/gemmi/cifdoc.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Gemmi C++ API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c5b8fc87970ee713285cf5bc9d6a8cb4.html">gemmi</a></li><li class="navelem"><a class="el" href="dir_43e4b0c8c232c2116c35cb27587a3d7e.html">include</a></li><li class="navelem"><a class="el" href="dir_f2d8f33d6739e7520ac414e2006066cc.html">gemmi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">cifdoc.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="cifdoc_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Copyright 2017 Global Phasing Ltd.</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// struct Document that represents the CIF file (but can be also</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// read from JSON file, such as CIF-JSON or mmJSON).</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#ifndef GEMMI_CIFDOC_HPP_</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#define GEMMI_CIFDOC_HPP_</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &quot;<a class="code" href="iterator_8hpp.html">iterator.hpp</a>&quot;</span>  <span class="comment">// for StrideIter, IndirectIter</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &quot;<a class="code" href="atox_8hpp.html">atox.hpp</a>&quot;</span>  <span class="comment">// for string_to_int</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &quot;<a class="code" href="fail_8hpp.html">fail.hpp</a>&quot;</span>  <span class="comment">// for fail</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;<a class="code" href="util_8hpp.html">util.hpp</a>&quot;</span>  <span class="comment">// for starts_with, to_lower, cat</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;cstring&gt;</span>   <span class="comment">// for memchr</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// for move, find_if, all_of, min, rotate</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;initializer_list&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;iosfwd&gt;</span>    <span class="comment">// for size_t, ptrdiff_t</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;new&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;stdexcept&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;unordered_set&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#if defined(_MSC_VER)</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#pragma warning(push)</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="comment">// warning C4244: an integer type is converted to a smaller integer type</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#pragma warning(disable: 4244)</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="comment">// warning C4267: conversion from &#39;size_t&#39; to &#39;type&#39;, possible loss of data</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#pragma warning(disable: 4267)</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacegemmi.html">gemmi</a> {</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="keyword">namespace </span>cif {</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="keyword">using</span> std::size_t;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="keyword">using</span> <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">gemmi::fail</a>;</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02ae">   37</a></span><span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02ae">ItemType</a> : <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> {</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>  <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">Pair</a>,</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>,</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>  <a class="code hl_enumvalue" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aea3bb3e8c8a24891ba0f7608bcc96f8b0a">Frame</a>,</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>  <a class="code hl_enumvalue" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aea0be8406951cdfda82f00f79328cf4efc">Comment</a>,</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>  <a class="code hl_enumvalue" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aeabf0adaf97ee2347ae783cc6d56f88d67">Erased</a>,</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>};</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#ae94de270f749561556b3dfc7bae29a07">   45</a></span><span class="keyword">inline</span> uint8_t <a class="code hl_function" href="namespacegemmi_1_1cif.html#ae94de270f749561556b3dfc7bae29a07">char_table</a>(<span class="keywordtype">char</span> c) {</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>  <span class="keyword">static</span> <span class="keyword">const</span> uint8_t table[256] = {</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>   <span class="comment">// 0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>      0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 2, 0, 0, <span class="comment">// 0</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, <span class="comment">// 1</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>      2, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, <span class="comment">// 2</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, <span class="comment">// 3</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, <span class="comment">// 4</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, <span class="comment">// 5</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, <span class="comment">// 6</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, <span class="comment">// 7</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>   <span class="comment">// 128-255</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>      0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>  };</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  <span class="keywordflow">return</span> table[<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(c)];</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>}</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a177ba38bf00d6a38d63bfaee0b2e3bcf">   65</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a177ba38bf00d6a38d63bfaee0b2e3bcf">assert_tag</a>(<span class="keyword">const</span> std::string&amp; tag) {</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>  <span class="keywordflow">if</span> (tag[0] != <span class="charliteral">&#39;_&#39;</span>)</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;Tag should start with &#39;_&#39;, got: &quot;</span> + tag);</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>}</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#ab9ea00e63acd9bb7aa9312029341427a">   70</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#ab9ea00e63acd9bb7aa9312029341427a">ensure_mmcif_category</a>(std::string&amp; <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>) {</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>[0] != <span class="charliteral">&#39;_&#39;</span>)</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;Category should start with &#39;_&#39;, got: &quot;</span> + <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>  <span class="keywordflow">if</span> (*(<a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>.end() - 1) != <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a> += <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>}</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a4812498831f81a091de7c5248ae2d09a">   77</a></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a4812498831f81a091de7c5248ae2d09a">is_null</a>(<span class="keyword">const</span> std::string&amp; value) {</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  <span class="keywordflow">return</span> value.size() == 1 &amp;&amp; (value[0] == <span class="charliteral">&#39;?&#39;</span> || value[0] == <span class="charliteral">&#39;.&#39;</span>);</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>}</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a2fa5c5b0c76f1cbae07b880a978b8c5b">   81</a></span><span class="keyword">inline</span> std::string <a class="code hl_function" href="namespacegemmi_1_1cif.html#a2fa5c5b0c76f1cbae07b880a978b8c5b">as_string</a>(<span class="keyword">const</span> std::string&amp; value) {</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>  <span class="keywordflow">if</span> (value.empty() || <a class="code hl_function" href="namespacegemmi_1_1cif.html#a4812498831f81a091de7c5248ae2d09a">is_null</a>(value))</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>  <span class="keywordflow">if</span> (value[0] == <span class="charliteral">&#39;&quot;&#39;</span> || value[0] == <span class="charliteral">&#39;\&#39;&#39;</span>)</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="keywordflow">return</span> std::string(value.begin() + 1, value.end() - 1);</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>  <span class="keywordflow">if</span> (value[0] == <span class="charliteral">&#39;;&#39;</span> &amp;&amp; value.size() &gt; 2 &amp;&amp; *(value.end() - 2) == <span class="charliteral">&#39;\n&#39;</span>) {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <span class="keywordtype">bool</span> crlf = *(value.end() - 3) == <span class="charliteral">&#39;\r&#39;</span>;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <span class="keywordflow">return</span> std::string(value.begin() + 1, value.end() - (crlf ? 3 : 2));</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  }</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>  <span class="keywordflow">return</span> value;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>}</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a741eb67cda0ba2b5a8110ce96718f69d">   93</a></span><span class="keyword">inline</span> std::string <a class="code hl_function" href="namespacegemmi_1_1cif.html#a2fa5c5b0c76f1cbae07b880a978b8c5b">as_string</a>(<span class="keyword">const</span> std::string* value) {</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>  <span class="keywordflow">return</span> value ? <a class="code hl_function" href="namespacegemmi_1_1cif.html#a2fa5c5b0c76f1cbae07b880a978b8c5b">as_string</a>(*value) : std::string();</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>}</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a06ac2450f93acc24f653e50f2635f499">   97</a></span><span class="keyword">inline</span> <span class="keywordtype">char</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a06ac2450f93acc24f653e50f2635f499">as_char</a>(<span class="keyword">const</span> std::string&amp; value, <span class="keywordtype">char</span> null) {</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacegemmi_1_1cif.html#a4812498831f81a091de7c5248ae2d09a">is_null</a>(value))</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    <span class="keywordflow">return</span> null;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>  <span class="keywordflow">if</span> (value.size() &lt; 2)</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <span class="keywordflow">return</span> value[0];</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>  <span class="keyword">const</span> std::string s = <a class="code hl_function" href="namespacegemmi_1_1cif.html#a2fa5c5b0c76f1cbae07b880a978b8c5b">as_string</a>(value);</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>  <span class="keywordflow">if</span> (s.size() &lt; 2)</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <span class="keywordflow">return</span> s[0];</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>  <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;Not a single character: &quot;</span> + value);</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>}</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#ae351c8cc0971a7ce253a4ff6a93432eb">  108</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#ae351c8cc0971a7ce253a4ff6a93432eb">as_int</a>(<span class="keyword">const</span> std::string&amp; str) {</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="namespacegemmi.html#a01c2cc6980a0a0de892990673670bbdc">string_to_int</a>(str, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>}</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a5096ada4247a7e18202fc6bfdea5063a">  112</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#ae351c8cc0971a7ce253a4ff6a93432eb">as_int</a>(<span class="keyword">const</span> std::string&amp; str, <span class="keywordtype">int</span> null) {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a4812498831f81a091de7c5248ae2d09a">is_null</a>(str) ? null : <a class="code hl_function" href="namespacegemmi_1_1cif.html#ae351c8cc0971a7ce253a4ff6a93432eb">as_int</a>(str);</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>}</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span><span class="comment">// for use in templates (see also as_any() functions in numb.hpp)</span></div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a20b5c32fa619ae2bc2a351a9c06e5ed1">  117</a></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a20b5c32fa619ae2bc2a351a9c06e5ed1">as_any</a>(<span class="keyword">const</span> std::string&amp; s, <span class="keywordtype">int</span> null) { <span class="keywordflow">return</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#ae351c8cc0971a7ce253a4ff6a93432eb">as_int</a>(s, null); }</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a57270553cefbeb2cf8a8029bd8787c45">  118</a></span><span class="keyword">inline</span> <span class="keywordtype">char</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a20b5c32fa619ae2bc2a351a9c06e5ed1">as_any</a>(<span class="keyword">const</span> std::string&amp; s, <span class="keywordtype">char</span> null) { <span class="keywordflow">return</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a06ac2450f93acc24f653e50f2635f499">as_char</a>(s, null); }</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">  121</a></span><span class="keyword">using</span> <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">Pair</a> = std::array&lt;std::string, 2&gt;;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><span class="comment">// used only as arguments when creating Item</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1LoopArg.html">  124</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1LoopArg.html">LoopArg</a> {};</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1FrameArg.html#a180cb658aafa5d07e877f8c056f09600">  125</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1FrameArg.html">FrameArg</a> { std::string <a class="code hl_variable" href="structgemmi_1_1cif_1_1FrameArg.html#a180cb658aafa5d07e877f8c056f09600">str</a>; };</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1CommentArg.html#a0393eceea9a8dc6eac2280930c1a7223">  126</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1CommentArg.html">CommentArg</a> { std::string <a class="code hl_variable" href="structgemmi_1_1cif_1_1CommentArg.html#a0393eceea9a8dc6eac2280930c1a7223">str</a>; };</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html">  128</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a> {</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">  129</a></span>  std::vector&lt;std::string&gt; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">  130</a></span>  std::vector&lt;std::string&gt; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>;</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span> </div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  <span class="comment">// search and access</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#ae939de430a2e2e4bfe10c716e4fe6496">  133</a></span>  <span class="keywordtype">int</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#ae939de430a2e2e4bfe10c716e4fe6496">find_tag_lc</a>(<span class="keyword">const</span> std::string&amp; lctag)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    <span class="keyword">auto</span> f = std::find_if(<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.begin(), <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.end(),</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        [&amp;lctag](<span class="keyword">const</span> std::string&amp; t) { return gemmi::iequal(t, lctag); });</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    <span class="keywordflow">return</span> f == <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.end() ? -1 : f - <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.begin();</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>  }</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#a3341176041c4a0459215d5af990c2858">  138</a></span>  <span class="keywordtype">int</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a3341176041c4a0459215d5af990c2858">find_tag</a>(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#ae939de430a2e2e4bfe10c716e4fe6496">find_tag_lc</a>(<a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(tag));</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>  }</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#ae7e666a463479aafb622cbe93477451d">  141</a></span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#ae7e666a463479aafb622cbe93477451d">has_tag</a>(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a3341176041c4a0459215d5af990c2858">find_tag</a>(tag) != -1; }</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#a320c4a01c0cfa6ba13600ca58121f1eb">  142</a></span>  <span class="keywordtype">size_t</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a320c4a01c0cfa6ba13600ca58121f1eb">width</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.size(); }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#a690bebc92bdf9fb316e1a25587359562">  143</a></span>  <span class="keywordtype">size_t</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a690bebc92bdf9fb316e1a25587359562">length</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.size() / <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.size(); }</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#a255832b560c3334e158ef915ea69235e">  144</a></span>  <span class="keyword">const</span> std::string&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a255832b560c3334e158ef915ea69235e">val</a>(<span class="keywordtype">size_t</span> row, <span class="keywordtype">size_t</span> col)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>[row * <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.size() + col];</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>  }</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span> </div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#ad39dd5d56b0b30cf441017325c35b0d2">  148</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#ad39dd5d56b0b30cf441017325c35b0d2">clear</a>() { <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.clear(); <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.clear(); }</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#ab234864dc26868ee7fc2026e2e306f8a">  150</a></span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#ab234864dc26868ee7fc2026e2e306f8a">add_row</a>(T new_values, <span class="keywordtype">int</span> pos=-1) {</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <span class="keywordflow">if</span> (new_values.size() != <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.size())</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>      <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;add_row(): wrong row length.&quot;</span>);</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <span class="keyword">auto</span> it = <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.end();</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <span class="keywordflow">if</span> (pos &gt;= 0 &amp;&amp; pos * <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a320c4a01c0cfa6ba13600ca58121f1eb">width</a>() &lt; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.size())</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>      it = <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.begin() + pos * <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.size();</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.insert(it, new_values.begin(), new_values.end());</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>  }</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#af6fe1b04e0b46b244a80fef1008545be">  158</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#af6fe1b04e0b46b244a80fef1008545be">add_row</a>(std::initializer_list&lt;std::string&gt; new_values, <span class="keywordtype">int</span> pos=-1) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    add_row&lt;std::initializer_list&lt;std::string&gt;&gt;(new_values, pos);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>  }</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>  <span class="comment">// comments are added relying on how cif writing works</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#a007f97a4dd16fd0b1580fc045cfdfe39">  162</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a007f97a4dd16fd0b1580fc045cfdfe39">add_comment_and_row</a>(std::initializer_list&lt;std::string&gt; ss) {</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <span class="keywordflow">if</span> (ss.size() != <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.size() + 1)</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>      <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;add_comment_and_row(): wrong row length.&quot;</span>);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    std::vector&lt;std::string&gt; vec(ss.begin() + 1, ss.end());</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    vec[0] = <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>(<span class="charliteral">&#39;#&#39;</span>, *ss.begin(), <span class="charliteral">&#39;\n&#39;</span>, vec[0]);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#ab234864dc26868ee7fc2026e2e306f8a">add_row</a>(vec);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>  }</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#aa80b90519ad9deefed29f05d648adf95">  169</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#aa80b90519ad9deefed29f05d648adf95">pop_row</a>() {</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.size() &lt; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.size())</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>      <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;pop_row() called on empty Loop&quot;</span>);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.resize(<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.size() - <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.size());</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  }</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>  <span class="comment">// the arguments must be valid row indices</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#ad0d680ae040fee59f3a8dc1729cebdf0">  176</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#ad0d680ae040fee59f3a8dc1729cebdf0">move_row</a>(<span class="keywordtype">int</span> old_pos, <span class="keywordtype">int</span> new_pos) {</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    <span class="keywordtype">size_t</span> w = <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a320c4a01c0cfa6ba13600ca58121f1eb">width</a>();</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    <span class="keyword">auto</span> src = <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.begin() + old_pos * w;</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="keyword">auto</span> dst = <a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.begin() + new_pos * w;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    <span class="keywordflow">if</span> (src &lt; dst)</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>      std::rotate(src, src+w, dst+w);</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>      std::rotate(dst, src, src+w);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  }</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#aa19b65450432dd3a798734d090ac2fee">set_all_values</a>(std::vector&lt;std::vector&lt;std::string&gt;&gt; columns);</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>};</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span><span class="keyword">struct </span>Item;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="keyword">struct </span>Block;</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span><span class="comment">// Accessor to a specific loop column, or to a single value from a Pair.</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html">  194</a></span><span class="keyword">class </span><a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> {</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#ac25b69671c519a00ccbfceca08335ead">  196</a></span>  <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ac25b69671c519a00ccbfceca08335ead">Column</a>() : item_(nullptr) {}</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a2b38f7f5217e8799644b34f8a9ba2ffe">  197</a></span>  <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a2b38f7f5217e8799644b34f8a9ba2ffe">Column</a>(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ae16c0ac37c0b6b54375bde2249e46b7c">item</a>, <span class="keywordtype">size_t</span> <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a27b8a6ea88c77c3597604c19325ad694">col</a>) : item_(<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ae16c0ac37c0b6b54375bde2249e46b7c">item</a>), col_(<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a27b8a6ea88c77c3597604c19325ad694">col</a>) {}</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a6b05a484cf527ed0386951f5713a8cf4">  198</a></span>  <span class="keyword">using</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a> = <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">StrideIter&lt;std::string&gt;</a>;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>  <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a> <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a60431c7b159b640e7294153acbd60b63">begin</a>();</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>  <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a> <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ae59985cfe8e6db593c3606cf97fb4997">end</a>();</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a2b029631ee39ac12d1cec9b12acafe9d">  201</a></span>  <span class="keyword">using</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">const_iterator</a> = <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">StrideIter&lt;const std::string&gt;</a>;</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#ad6693a2d928c9282415271bd2391bb30">  202</a></span>  <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">const_iterator</a> <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ad6693a2d928c9282415271bd2391bb30">begin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ad6693a2d928c9282415271bd2391bb30">begin</a>(); }</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a150b62943a926bd783dd07507ed5a005">  203</a></span>  <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">const_iterator</a> <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a150b62943a926bd783dd07507ed5a005">end</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a150b62943a926bd783dd07507ed5a005">end</a>(); }</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a26a9e809a24ed9aac50e975434682576">get_loop</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>  std::string* <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a01e7805e75d2ed401c12632dab7be578">get_tag</a>();</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#aa7923d7164159e8f580e1b7db94c7ee0">  207</a></span>  <span class="keyword">const</span> std::string* <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#aa7923d7164159e8f580e1b7db94c7ee0">get_tag</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a01e7805e75d2ed401c12632dab7be578">get_tag</a>();</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>  }</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a2fd07c8bcca95602e53102cf12ab0b37">  210</a></span>  <span class="keywordtype">int</span> <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a2fd07c8bcca95602e53102cf12ab0b37">length</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* loop = <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a26a9e809a24ed9aac50e975434682576">get_loop</a>())</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>      <span class="keywordflow">return</span> loop-&gt;length();</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    <span class="keywordflow">return</span> item_ ? 1 : 0;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a2eb8c7edac2336ffe26be9dbf58d7524">  215</a></span>  <span class="keyword">explicit</span> <span class="keyword">operator</span> bool()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> item_ != nullptr ; }</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>  std::string&amp; <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a11e9c97db07ced8d56b8d907548cf2ef">operator[]</a>(<span class="keywordtype">int</span> n);</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#ab6d70d578f15d019712d6ca50c80bbb1">  217</a></span>  std::string&amp; <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ab6d70d578f15d019712d6ca50c80bbb1">at</a>(<span class="keywordtype">int</span> n) {</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="keywordflow">if</span> (n &lt; 0)</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>      n += <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a2fd07c8bcca95602e53102cf12ab0b37">length</a>();</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <span class="keywordflow">if</span> (n &lt; 0 || n &gt;= <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a2fd07c8bcca95602e53102cf12ab0b37">length</a>())</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>      <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Cannot access element &quot;</span> + std::to_string(n) +</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>          <span class="stringliteral">&quot; in Column with length &quot;</span> + std::to_string(<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a2fd07c8bcca95602e53102cf12ab0b37">length</a>()));</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a11e9c97db07ced8d56b8d907548cf2ef">operator[]</a>(n);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  }</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a5738fb9ac76423d2253c6508de09d968">  225</a></span>  <span class="keyword">const</span> std::string&amp; <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a5738fb9ac76423d2253c6508de09d968">at</a>(<span class="keywordtype">int</span> n)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ab6d70d578f15d019712d6ca50c80bbb1">at</a>(n);</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>  }</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span> </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a45b5168fa394ef13cbf0880bd4ed36ad">  229</a></span>  std::string <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a45b5168fa394ef13cbf0880bd4ed36ad">str</a>(<span class="keywordtype">int</span> n)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a2fa5c5b0c76f1cbae07b880a978b8c5b">as_string</a>(<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ab6d70d578f15d019712d6ca50c80bbb1">at</a>(n)); }</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#ae16c0ac37c0b6b54375bde2249e46b7c">  230</a></span>  <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ae16c0ac37c0b6b54375bde2249e46b7c">item</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> item_; }</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a55c717dae97d9079d99de124621490ef">  231</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a55c717dae97d9079d99de124621490ef">item</a>() { <span class="keywordflow">return</span> item_; }</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a27b8a6ea88c77c3597604c19325ad694">  232</a></span>  <span class="keywordtype">size_t</span> <a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a27b8a6ea88c77c3597604c19325ad694">col</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> col_; }</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* item_;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  <span class="keywordtype">size_t</span> col_;  <span class="comment">// for loop this is a column index in item_-&gt;loop</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>};</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span><span class="comment">// Some values can be given either in loop or as tag-value pairs.</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span><span class="comment">// The latter case is equivalent to a loop with a single row.</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span><span class="comment">// We optimized for loops, and in case of tag-values we copy the values</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span><span class="comment">// into the `values` vector.</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html">  243</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> {</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a5cfd1449bcadbcd760c23bd17d3c00fb">  244</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a5cfd1449bcadbcd760c23bd17d3c00fb">loop_item</a>;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a9c1f54447ecfe3fa73fa37ef50a7e733">  245</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a9c1f54447ecfe3fa73fa37ef50a7e733">bloc</a>;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">  246</a></span>  std::vector&lt;int&gt; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a18be5ff8b0e2e75d72127dc971cbf6aa">  247</a></span>  <span class="keywordtype">size_t</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a18be5ff8b0e2e75d72127dc971cbf6aa">prefix_length</a>;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span> </div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html">  249</a></span>  <span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a> {</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">  250</a></span>    <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>&amp; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">tab</a>;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a00c6f4fb163e866091e4fa3b82575681">  251</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a00c6f4fb163e866091e4fa3b82575681">row_index</a>;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    std::string&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#af58e638c372765bb6c07523ad7e781b1">value_at_unsafe</a>(<span class="keywordtype">int</span> pos);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#aa21a19ebdece30c5f9391d5a134ceda0">  254</a></span>    std::string&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#aa21a19ebdece30c5f9391d5a134ceda0">value_at</a>(<span class="keywordtype">int</span> pos) {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>      <span class="keywordflow">if</span> (pos == -1)</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Cannot access missing optional tag.&quot;</span>);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#af58e638c372765bb6c07523ad7e781b1">value_at_unsafe</a>(pos);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    }</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#af67317045d8133fcd43716afc0abbf27">  259</a></span>    <span class="keyword">const</span> std::string&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#af67317045d8133fcd43716afc0abbf27">value_at</a>(<span class="keywordtype">int</span> pos)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>      <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#aa21a19ebdece30c5f9391d5a134ceda0">value_at</a>(pos);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a0597071bbebf317349ee8da64c27cd41">  263</a></span>    std::string&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a0597071bbebf317349ee8da64c27cd41">at</a>(<span class="keywordtype">int</span> n) {</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#aa21a19ebdece30c5f9391d5a134ceda0">value_at</a>(<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">tab</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.at(n &lt; 0 ? n + <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#abe0ad18773b53e1aeea9ee072f47147c">size</a>() : n));</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    }</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ae799a1786110c99b82d165ad4c2795ce">  266</a></span>    <span class="keyword">const</span> std::string&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ae799a1786110c99b82d165ad4c2795ce">at</a>(<span class="keywordtype">int</span> n)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ae799a1786110c99b82d165ad4c2795ce">at</a>(n); }</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    std::string&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a82da74897383323f445acbd0417d9853">operator[]</a>(<span class="keywordtype">size_t</span> n);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a113154637597fe029068bb30cb1d981c">  269</a></span>    <span class="keyword">const</span> std::string&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a113154637597fe029068bb30cb1d981c">operator[]</a>(<span class="keywordtype">size_t</span> n)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>      <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<span class="keyword">operator</span>[](n);</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    }</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a169533c1696ec1f97823aa100eaf7f39">  273</a></span>    std::string* <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a169533c1696ec1f97823aa100eaf7f39">ptr_at</a>(<span class="keywordtype">int</span> n) {</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      <span class="keywordtype">int</span> pos = <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">tab</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.at(n &lt; 0 ? n + <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#abe0ad18773b53e1aeea9ee072f47147c">size</a>() : n);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>      <span class="keywordflow">return</span> pos &gt;= 0 ? &amp;<a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#aa21a19ebdece30c5f9391d5a134ceda0">value_at</a>(pos) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    }</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a67d2d0475934eef7a77ee984cda11678">  277</a></span>    <span class="keyword">const</span> std::string* <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a67d2d0475934eef7a77ee984cda11678">ptr_at</a>(<span class="keywordtype">int</span> n)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>      <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a169533c1696ec1f97823aa100eaf7f39">ptr_at</a>(n);</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    }</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ae81c5be7f6e3fa5cfe036d40224d82e3">  281</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ae81c5be7f6e3fa5cfe036d40224d82e3">has</a>(<span class="keywordtype">size_t</span> n)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">tab</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.at(n) &gt;= 0; }</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a545b1140586fd5e54100a0910fbedd01">  282</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a545b1140586fd5e54100a0910fbedd01">has2</a>(<span class="keywordtype">size_t</span> n)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ae81c5be7f6e3fa5cfe036d40224d82e3">has</a>(n) &amp;&amp; !<a class="code hl_function" href="namespacegemmi_1_1cif.html#a4812498831f81a091de7c5248ae2d09a">cif::is_null</a>(<span class="keyword">operator</span>[](n)); }</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a51d7094a7ff29c01eff8cd334fe9b648">  284</a></span>    <span class="keyword">const</span> std::string&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a51d7094a7ff29c01eff8cd334fe9b648">one_of</a>(<span class="keywordtype">size_t</span> n1, <span class="keywordtype">size_t</span> n2)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>      <span class="keyword">static</span> <span class="keyword">const</span> std::string nul(1, <span class="charliteral">&#39;.&#39;</span>);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a545b1140586fd5e54100a0910fbedd01">has2</a>(n1))</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>       <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a82da74897383323f445acbd0417d9853">operator[]</a>(n1);</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ae81c5be7f6e3fa5cfe036d40224d82e3">has</a>(n2))</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>       <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a82da74897383323f445acbd0417d9853">operator[]</a>(n2);</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>      <span class="keywordflow">return</span> nul;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    }</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#abe0ad18773b53e1aeea9ee072f47147c">  293</a></span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#abe0ad18773b53e1aeea9ee072f47147c">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">tab</a>.<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a5c35d16ecfab5519064c577b402bb591">width</a>(); }</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span> </div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a1be26d0c808f1834a65a23bdca6222d1">  295</a></span>    std::string <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a1be26d0c808f1834a65a23bdca6222d1">str</a>(<span class="keywordtype">int</span> n)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a2fa5c5b0c76f1cbae07b880a978b8c5b">as_string</a>(<a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a0597071bbebf317349ee8da64c27cd41">at</a>(n)); }</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a62a376825fd737a07ccc6cea350b6457">  297</a></span>    <span class="keyword">using</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a> = <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">IndirectIter&lt;Row, std::string&gt;</a>;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a1a7055034001d9364cd4850711d05f1d">  298</a></span>    <span class="keyword">using</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">const_iterator</a> = <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">IndirectIter&lt;const Row, const std::string&gt;</a>;</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#aa083f5655e7b554879efa77a4520ba79">  299</a></span>    <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#aa083f5655e7b554879efa77a4520ba79">begin</a>() { <span class="keywordflow">return</span> <a class="code hl_typedef" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a62a376825fd737a07ccc6cea350b6457">iterator</a>({<span class="keyword">this</span>, <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">tab</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.begin()}); }</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a3511c0e10191f6eb5d14a91d78bd76db">  300</a></span>    <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a3511c0e10191f6eb5d14a91d78bd76db">end</a>() { <span class="keywordflow">return</span> <a class="code hl_typedef" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a62a376825fd737a07ccc6cea350b6457">iterator</a>({<span class="keyword">this</span>, <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">tab</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.end()}); }</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ac70b4e80f2faf68025af5e93770b8c9b">  301</a></span>    <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">const_iterator</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ac70b4e80f2faf68025af5e93770b8c9b">begin</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>      <span class="keywordflow">return</span> <a class="code hl_typedef" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a1a7055034001d9364cd4850711d05f1d">const_iterator</a>({<span class="keyword">this</span>, <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">tab</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.begin()});</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    }</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ab8e28ce4f77e44950e58345db368af1c">  304</a></span>    <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">const_iterator</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#ab8e28ce4f77e44950e58345db368af1c">end</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>      <span class="keywordflow">return</span> <a class="code hl_typedef" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a1a7055034001d9364cd4850711d05f1d">const_iterator</a>({<span class="keyword">this</span>, <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">tab</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.end()});</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    }</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>  };</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#ad836773214773ffb8490d62503985b13">get_loop</a>();</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a9229b310944fb1718b663413e927efb7">  310</a></span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a9229b310944fb1718b663413e927efb7">ok</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.empty(); }</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a5c35d16ecfab5519064c577b402bb591">  311</a></span>  <span class="keywordtype">size_t</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a5c35d16ecfab5519064c577b402bb591">width</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.size(); }</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  <span class="keywordtype">size_t</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">length</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a4571fd6a2f616cc0ff0db20ad92461df">  313</a></span>  <span class="keywordtype">size_t</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a4571fd6a2f616cc0ff0db20ad92461df">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">length</a>(); }</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a6d3aa12e65771350226ef43a2924eba7">  314</a></span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a6d3aa12e65771350226ef43a2924eba7">has_column</a>(<span class="keywordtype">int</span> n)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a9229b310944fb1718b663413e927efb7">ok</a>() &amp;&amp; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.at(n) &gt;= 0; }</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#aed8ba04cf6d05b191496f46277c7215a">  315</a></span>  <span class="keywordtype">int</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#aed8ba04cf6d05b191496f46277c7215a">first_of</a>(<span class="keywordtype">int</span> n1, <span class="keywordtype">int</span> n2)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.at(n1) &gt;= 0 ? n1 : n2; }</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a3807b76b940395794e72edd5bb9cf88d">  316</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a3807b76b940395794e72edd5bb9cf88d">tags</a>() { <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a>{*<span class="keyword">this</span>, -1}; }</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#ad1c24a3047902ae634a67f84f450ad43">  317</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#ad1c24a3047902ae634a67f84f450ad43">operator[]</a>(<span class="keywordtype">int</span> n) { <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a>{*<span class="keyword">this</span>, n}; }</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a16828ef9326093d84cef338aa60fae31">  319</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a16828ef9326093d84cef338aa60fae31">at_check</a>(<span class="keywordtype">int</span>&amp; n) {</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <span class="keywordflow">if</span> (n &lt; 0)</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>      n += <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">length</a>();</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="keywordflow">if</span> (n &lt; 0 || <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(n) &gt;= <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">length</a>())</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>      <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;No row with index &quot;</span> + std::to_string(n));</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>  }</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#ab4c9dc52fc64c0af8063962fddc77d32">  325</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#ab4c9dc52fc64c0af8063962fddc77d32">at</a>(<span class="keywordtype">int</span> n) {</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a16828ef9326093d84cef338aa60fae31">at_check</a>(n);</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <span class="keywordflow">return</span> (*<span class="keyword">this</span>)[n];</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  }</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a929aff40819b7188aed5f4a53fe3e781">  330</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a929aff40819b7188aed5f4a53fe3e781">one</a>() {</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">length</a>() != 1)</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>      <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;Expected one value, found &quot;</span> + std::to_string(<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">length</a>()));</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <span class="keywordflow">return</span> (*<span class="keyword">this</span>)[0];</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>  }</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a71a2553a76fc2115c800f7aa7bcdbd68">  336</a></span>  std::string <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a71a2553a76fc2115c800f7aa7bcdbd68">get_prefix</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pos : <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>)</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>      <span class="keywordflow">if</span> (pos &gt;= 0)</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a3807b76b940395794e72edd5bb9cf88d">tags</a>()</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>               .<a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#aa21a19ebdece30c5f9391d5a134ceda0">value_at</a>(pos).substr(0, <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a18be5ff8b0e2e75d72127dc971cbf6aa">prefix_length</a>);</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;The table has no columns.&quot;</span>);</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>  }</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>  Row <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a7d96586afcf1306c81355e8bfa244985">find_row</a>(<span class="keyword">const</span> std::string&amp; s);</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a485d31a03425797da1a84d4ea4ec5023">append_row</a>(T new_values);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#ac38b46623345a5298e1975e548d97fe9">  347</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#ac38b46623345a5298e1975e548d97fe9">append_row</a>(std::initializer_list&lt;std::string&gt; new_values) {</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    append_row&lt;std::initializer_list&lt;std::string&gt;&gt;(new_values);</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>  }</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#aca8f0bc9d096b8d6bffe9b9c9d77028e">  350</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#aca8f0bc9d096b8d6bffe9b9c9d77028e">remove_row</a>(<span class="keywordtype">int</span> row_index) { <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#aebfef31bd498ae340e1eea5b4ecc8fdf">remove_rows</a>(row_index, row_index+1); }</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#aebfef31bd498ae340e1eea5b4ecc8fdf">remove_rows</a>(<span class="keywordtype">int</span> start, <span class="keywordtype">int</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#aa49e4addc7f5b4edfc23fd228e6bbd2b">end</a>);</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>  <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#af4fb8f34e769249aa678d5b8f916d7b0">column_at_pos</a>(<span class="keywordtype">int</span> pos);</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#afe6726fb3b427da6bace581e358c6357">  353</a></span>  <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#afe6726fb3b427da6bace581e358c6357">column</a>(<span class="keywordtype">int</span> n) {</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    <span class="keywordtype">int</span> pos = <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.at(n);</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <span class="keywordflow">if</span> (pos == -1)</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>      <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;Cannot access absent column&quot;</span>);</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#af4fb8f34e769249aa678d5b8f916d7b0">column_at_pos</a>(pos);</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>  }</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a268bbd57839505ff43785ef48e2d87c7">  360</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a268bbd57839505ff43785ef48e2d87c7">move_row</a>(<span class="keywordtype">int</span> old_pos, <span class="keywordtype">int</span> new_pos) {</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>    <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a16828ef9326093d84cef338aa60fae31">at_check</a>(old_pos);</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>    <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a16828ef9326093d84cef338aa60fae31">at_check</a>(new_pos);</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* loop = <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#ad836773214773ffb8490d62503985b13">get_loop</a>())</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>      loop-&gt;move_row(old_pos, new_pos);</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>  }</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>  <span class="comment">// prefix is optional</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a7d8937b5ff9f061d1b31175825f69ee6">  368</a></span>  <span class="keywordtype">int</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a7d8937b5ff9f061d1b31175825f69ee6">find_column_position</a>(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    std::string lctag = <a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(tag);</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a> tag_row = <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a3807b76b940395794e72edd5bb9cf88d">tags</a>();</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pos : <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>) {</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>      <span class="keyword">const</span> std::string&amp; v = tag_row.<a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#af58e638c372765bb6c07523ad7e781b1">value_at_unsafe</a>(pos);</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>      <span class="keywordflow">if</span> (v.length() == lctag.length() ? <a class="code hl_function" href="namespacegemmi.html#aead2c8d05718c75005302bb96662d2ee">gemmi::iequal</a>(v, lctag)</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>                                       : <a class="code hl_function" href="namespacegemmi.html#a1808c5d66b441e4929a2b57ddc3de02f">gemmi::iequal_from</a>(v, <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a18be5ff8b0e2e75d72127dc971cbf6aa">prefix_length</a>, lctag))</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        <span class="keywordflow">return</span> pos;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    }</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;Column name not found: &quot;</span> + tag);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>  }</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span> </div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a9d3b5b27c6403defce0dd5b40bda950a">  380</a></span>  <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a9d3b5b27c6403defce0dd5b40bda950a">find_column</a>(<span class="keyword">const</span> std::string&amp; tag) {</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#af4fb8f34e769249aa678d5b8f916d7b0">column_at_pos</a>(<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a7d8937b5ff9f061d1b31175825f69ee6">find_column_position</a>(tag));</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>  }</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span> </div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a89767fc8f8c27b256f920e30cf483dfb">erase</a>();</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span> </div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#abf4bc7fad9eac00d90e2eac9251d935e">convert_pair_to_loop</a>();</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span> </div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>  <span class="comment">// It is not a proper input iterator, but just enough for using range-for.</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1iterator.html">  389</a></span>  <span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1iterator.html">iterator</a> {</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a4ac1f871a0e65f101e2f7d1df97a59ff">  390</a></span>    <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>&amp; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a4ac1f871a0e65f101e2f7d1df97a59ff">parent</a>;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a2517becaa21bffc9c5f8aeeb6e53ba28">  391</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a2517becaa21bffc9c5f8aeeb6e53ba28">index</a>;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#ab522475839d89dc82c2cb35e7110018a">  392</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#ab522475839d89dc82c2cb35e7110018a">operator++</a>() { <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a2517becaa21bffc9c5f8aeeb6e53ba28">index</a>++; }</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a089810ae18693059fa24183a22b9cc74">  393</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a089810ae18693059fa24183a22b9cc74">operator==</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1iterator.html">iterator</a>&amp; o)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a2517becaa21bffc9c5f8aeeb6e53ba28">index</a> == o.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a2517becaa21bffc9c5f8aeeb6e53ba28">index</a>; }</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a0142bda6e4d622350f407056dde86e74">  394</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a0142bda6e4d622350f407056dde86e74">operator!=</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1iterator.html">iterator</a>&amp; o)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a2517becaa21bffc9c5f8aeeb6e53ba28">index</a> != o.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a2517becaa21bffc9c5f8aeeb6e53ba28">index</a>; }</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#aaa443e38bf8a831c59262ca234566c2d">  395</a></span>    <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#aaa443e38bf8a831c59262ca234566c2d">operator*</a>() { <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a4ac1f871a0e65f101e2f7d1df97a59ff">parent</a>[<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a2517becaa21bffc9c5f8aeeb6e53ba28">index</a>]; }</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a4a0bf498f9fa64859af419c0a3abbbd9">  396</a></span>    <span class="keyword">const</span> std::string&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a4a0bf498f9fa64859af419c0a3abbbd9">get</a>(<span class="keywordtype">int</span> n)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a4ac1f871a0e65f101e2f7d1df97a59ff">parent</a>[<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a2517becaa21bffc9c5f8aeeb6e53ba28">index</a>].<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#ab4c9dc52fc64c0af8063962fddc77d32">at</a>(n); }</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>  };</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#aa83b537d20667c348cec5c3a5007cc26">  398</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1iterator.html">iterator</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#aa83b537d20667c348cec5c3a5007cc26">begin</a>() { <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1iterator.html">iterator</a>{*<span class="keyword">this</span>, 0}; }</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#aa49e4addc7f5b4edfc23fd228e6bbd2b">  399</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1iterator.html">iterator</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#aa49e4addc7f5b4edfc23fd228e6bbd2b">end</a>() { <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1iterator.html">iterator</a>{*<span class="keyword">this</span>, (int)<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">length</a>()}; }</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>};</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html">  403</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a> {</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">  404</a></span>  std::string <a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>;</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a5dd89492b42634c8ff853ce45c7c2636">  405</a></span>  std::vector&lt;Item&gt; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a5dd89492b42634c8ff853ce45c7c2636">items</a>;</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#af0c81d1f62a86d15ce320dbeca102080">  407</a></span>  <span class="keyword">explicit</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#af0c81d1f62a86d15ce320dbeca102080">Block</a>(<span class="keyword">const</span> std::string&amp; name_) : <a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>(name_) {}</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#af88afeff011d8dc9b1607179abf77d1f">  408</a></span>  <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#af88afeff011d8dc9b1607179abf77d1f">Block</a>() {}</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span> </div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a073b8b3cabfe6796faafca2f571fbf2d">  410</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a073b8b3cabfe6796faafca2f571fbf2d">swap</a>(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; o) { <a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>.swap(o.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>); <a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a5dd89492b42634c8ff853ce45c7c2636">items</a>.swap(o.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a5dd89492b42634c8ff853ce45c7c2636">items</a>); }</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>  <span class="comment">// access functions</span></div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>  <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a00333a24f6cb59f35f6ee3a9175589d1">find_pair_item</a>(<span class="keyword">const</span> std::string&amp; tag) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">Pair</a>* <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#adf68f9e8e202ace7c4abc28649bfd9f5">find_pair</a>(<span class="keyword">const</span> std::string&amp; tag) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#aafe8d4fdf5b92937e22b86627cf4dda7">  414</a></span>  <span class="keyword">const</span> std::string* <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#aafe8d4fdf5b92937e22b86627cf4dda7">find_value</a>(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">Pair</a>* pair = <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#adf68f9e8e202ace7c4abc28649bfd9f5">find_pair</a>(tag);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <span class="keywordflow">return</span> pair ? &amp;(*pair)[1] : <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>  }</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>  <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a396f695a8f7687e4455c721f0a370726">find_loop</a>(<span class="keyword">const</span> std::string&amp; tag);</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>  <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a13cf4a43729935f357aa46f2d9cf1f36">find_loop_item</a>(<span class="keyword">const</span> std::string&amp; tag) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>  <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a2ef7efc20e67043bcd9534c87352602a">find_values</a>(<span class="keyword">const</span> std::string&amp; tag);</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#ae7d72791d4196e42ee83d04414fe53b1">  421</a></span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#ae7d72791d4196e42ee83d04414fe53b1">has_tag</a>(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a2ef7efc20e67043bcd9534c87352602a">find_values</a>(tag).<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ae16c0ac37c0b6b54375bde2249e46b7c">item</a>() != <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>  }</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#aba108b1f87aae17a3ce1e8e291bc1768">  424</a></span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#aba108b1f87aae17a3ce1e8e291bc1768">has_any_value</a>(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> c = <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a2ef7efc20e67043bcd9534c87352602a">find_values</a>(tag);</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <span class="keywordflow">return</span> c.<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ae16c0ac37c0b6b54375bde2249e46b7c">item</a>() != <span class="keyword">nullptr</span> &amp;&amp; !std::all_of(c.<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a60431c7b159b640e7294153acbd60b63">begin</a>(), c.<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ae59985cfe8e6db593c3606cf97fb4997">end</a>(), <a class="code hl_function" href="namespacegemmi_1_1cif.html#a4812498831f81a091de7c5248ae2d09a">is_null</a>);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>  }</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a568dd4077997b7289c7df413c4d13ac4">find</a>(<span class="keyword">const</span> std::string&amp; prefix,</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>             <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; tags);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a1aaf2117ddfbe60c93d823300c17b18b">  430</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a1aaf2117ddfbe60c93d823300c17b18b">find</a>(<span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; tags) { <span class="keywordflow">return</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a1aaf2117ddfbe60c93d823300c17b18b">find</a>({}, tags); }</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a43d38511b5998211edc625205ab8d27b">find_any</a>(<span class="keyword">const</span> std::string&amp; prefix,</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>                 <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; tags);</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a4a8afb6ffc4cfabff41840c69ed4453c">  433</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a4a8afb6ffc4cfabff41840c69ed4453c">find_or_add</a>(<span class="keyword">const</span> std::string&amp; prefix, std::vector&lt;std::string&gt; tags) {</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> t = <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a568dd4077997b7289c7df413c4d13ac4">find</a>(prefix, tags);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    <span class="keywordflow">if</span> (!t.<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a9229b310944fb1718b663413e927efb7">ok</a>()) {</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != (int) tags.size(); ++i)</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>        t.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">positions</a>.push_back(i);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>      <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> tab = <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a43d38511b5998211edc625205ab8d27b">find_any</a>(prefix, tags);</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>      t.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Table.html#a5cfd1449bcadbcd760c23bd17d3c00fb">loop_item</a> = &amp;setup_loop_item(std::move(tab), prefix, std::move(tags));</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    }</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="keywordflow">return</span> t;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>  }</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>* <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a65ea956a3d20b8790018cb1ec127c680">find_frame</a>(std::string <a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>);</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#acafcb469122cac440c4acfd335453072">item_as_table</a>(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; item);</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span> </div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>  <span class="keywordtype">size_t</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#ae466d627a6d9593dd708f8d7243b2d6c">get_index</a>(<span class="keyword">const</span> std::string&amp; tag) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>  <span class="comment">// modifying functions</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a5edaccd6d044720bd2d12b6a7304f4a7">set_pair</a>(<span class="keyword">const</span> std::string&amp; tag, <span class="keyword">const</span> std::string&amp; value);</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span> </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a85a7388aca241a1447f570566536b0e5">  451</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a85a7388aca241a1447f570566536b0e5">init_loop</a>(<span class="keyword">const</span> std::string&amp; prefix, std::vector&lt;std::string&gt; tags) {</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> tab = <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a43d38511b5998211edc625205ab8d27b">find_any</a>(prefix, tags);</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <span class="keywordflow">return</span> setup_loop(std::move(tab), prefix, std::move(tags));</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>  }</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a0ee2d3958f895a0b810977da3945a07b">move_item</a>(<span class="keywordtype">int</span> old_pos, <span class="keywordtype">int</span> new_pos);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>  <span class="comment">// mmCIF specific functions</span></div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>  std::vector&lt;std::string&gt; <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#acddcb8202a4ce1f21c4b817a7b1793b7">get_mmcif_category_names</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a7e34a1e8f968f978c283c8fb0eaeea5b">find_mmcif_category</a>(std::string <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>);</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a964e6f522c277c41a49222386178252a">  462</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a964e6f522c277c41a49222386178252a">init_mmcif_loop</a>(std::string <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>, std::vector&lt;std::string&gt; tags) {</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <a class="code hl_function" href="namespacegemmi_1_1cif.html#ab9ea00e63acd9bb7aa9312029341427a">ensure_mmcif_category</a>(<a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>);  <span class="comment">// modifies cat</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    <span class="keywordflow">return</span> setup_loop(<a class="code hl_function" href="structgemmi_1_1cif_1_1Block.html#a7e34a1e8f968f978c283c8fb0eaeea5b">find_mmcif_category</a>(<a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>), <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>, std::move(tags));</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>  }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; setup_loop_item(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>&amp;&amp; tab, <span class="keyword">const</span> std::string&amp; prefix,</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>                        std::vector&lt;std::string&gt;&amp;&amp; tags);</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>&amp; setup_loop(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>&amp;&amp; tab, <span class="keyword">const</span> std::string&amp; prefix,</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>                   std::vector&lt;std::string&gt;&amp;&amp; tags);</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>};</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span> </div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span> </div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html">  475</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a> {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">  476</a></span>  <a class="code hl_enumeration" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02ae">ItemType</a> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a>;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a5fba7dae1f126f62f2505b998211529e">  477</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a5fba7dae1f126f62f2505b998211529e">line_number</a> = -1;</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>  <span class="keyword">union </span>{</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">  479</a></span>    <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">Pair</a> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">pair</a>;</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">  480</a></span>    <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#ad306c06efb04e5383c9b7862888dc8de">  481</a></span>    <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a> <a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad306c06efb04e5383c9b7862888dc8de">frame</a>;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>  };</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span> </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#adae21a4083f94c9cc1f63eb1ad569f53">  484</a></span>  <span class="keyword">explicit</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#adae21a4083f94c9cc1f63eb1ad569f53">Item</a>(<a class="code hl_struct" href="structgemmi_1_1cif_1_1LoopArg.html">LoopArg</a>)</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    : <a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a>{<a class="code hl_enumeration" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02ae">ItemType</a>::<a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>}, <a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>{} {}</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a478811da0256c8d2913379da6def380a">  486</a></span>  <span class="keyword">explicit</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a478811da0256c8d2913379da6def380a">Item</a>(std::string&amp;&amp; t)</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>    : <a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a>{<a class="code hl_enumeration" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02ae">ItemType</a>::<a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">Pair</a>}, <a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">pair</a>{{std::move(t), std::string()}} {}</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a4bb7e0946ecf54b95cc9b62fd183f85f">  488</a></span>  <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a4bb7e0946ecf54b95cc9b62fd183f85f">Item</a>(<span class="keyword">const</span> std::string&amp; t, <span class="keyword">const</span> std::string&amp; v)</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    : type{<a class="code hl_enumeration" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02ae">ItemType</a>::<a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">Pair</a>}, pair{{t, v}} {}</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a4847a2c06ef7af0324fea423f1850326">  490</a></span>  <span class="keyword">explicit</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a4847a2c06ef7af0324fea423f1850326">Item</a>(<a class="code hl_struct" href="structgemmi_1_1cif_1_1FrameArg.html">FrameArg</a>&amp;&amp; frame_arg)</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    : type{<a class="code hl_enumeration" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02ae">ItemType</a>::<a class="code hl_enumvalue" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aea3bb3e8c8a24891ba0f7608bcc96f8b0a">Frame</a>}, frame(frame_arg.str) {}</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a5201b99fe65c301b1e1cc2c68afb550f">  492</a></span>  <span class="keyword">explicit</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a5201b99fe65c301b1e1cc2c68afb550f">Item</a>(<a class="code hl_struct" href="structgemmi_1_1cif_1_1CommentArg.html">CommentArg</a>&amp;&amp; comment)</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    : type{<a class="code hl_enumeration" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02ae">ItemType</a>::<a class="code hl_enumvalue" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aea0be8406951cdfda82f00f79328cf4efc">Comment</a>}, pair{{std::string(), std::move(comment.str)}} {}</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a2dc8f28c95f2705471a34b12a40259a6">  495</a></span>  <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a2dc8f28c95f2705471a34b12a40259a6">Item</a>(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp;&amp; o) noexcept</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>      : type(o.type), line_number(o.line_number) {</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    move_value(std::move(o));</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>  }</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a05452ddacd1a1afc69982c73685d5f2d">  499</a></span>  <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a05452ddacd1a1afc69982c73685d5f2d">Item</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; o)</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>      : type(o.type), line_number(o.line_number) {</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>    copy_value(o);</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>  }</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#acb557e587b2db18e858e5a4e05178542">  504</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#acb557e587b2db18e858e5a4e05178542">operator=</a>(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a> o) { set_value(std::move(o)); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span> </div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a6e0a564a9ae9307d135733a7ab64bd72">  506</a></span>  <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a6e0a564a9ae9307d135733a7ab64bd72">~Item</a>() { destruct(); }</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span> </div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a6e27372e6c72890d0a9b8944ac12540a">  508</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a6e27372e6c72890d0a9b8944ac12540a">erase</a>() {</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    destruct();</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    type = ItemType::Erased;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>  }</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span> </div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>  <span class="comment">// case-insensitive, the prefix should be lower-case</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#aaf2ad346d5e89aa738d78b5c67b884e2">  514</a></span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#aaf2ad346d5e89aa738d78b5c67b884e2">has_prefix</a>(<span class="keyword">const</span> std::string&amp; prefix)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    <span class="keywordflow">return</span> (type == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a> &amp;&amp; <a class="code hl_function" href="namespacegemmi.html#a5391ca865c7447711216f37561fd46e0">gemmi::istarts_with</a>(pair[0], prefix)) ||</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>           (type == ItemType::Loop &amp;&amp; !loop.tags.empty() &amp;&amp;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>            <a class="code hl_function" href="namespacegemmi.html#a5391ca865c7447711216f37561fd46e0">gemmi::istarts_with</a>(loop.tags[0], prefix));</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>  }</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Item.html#a69fe3f2aa8d468d4b2db03efd078f40a">  520</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a69fe3f2aa8d468d4b2db03efd078f40a">set_value</a>(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp;&amp; o) {</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>    <span class="keywordflow">if</span> (type == o.type) {</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>        <span class="keywordflow">case</span> <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a>: pair = std::move(o.pair); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>        <span class="keywordflow">case</span> ItemType::Loop: loop = std::move(o.loop); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>        <span class="keywordflow">case</span> ItemType::Frame: frame = std::move(o.frame); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>        <span class="keywordflow">case</span> ItemType::Comment: pair = std::move(o.pair); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>        <span class="keywordflow">case</span> ItemType::Erased: <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>      }</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>      destruct();</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>      type = o.type;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>      move_value(std::move(o));</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    }</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>  }</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span> </div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>  <span class="keywordtype">void</span> destruct() {</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>    <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>      <span class="keywordflow">case</span> <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a>: pair.~Pair(); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>      <span class="keywordflow">case</span> ItemType::Loop: loop.~Loop(); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>      <span class="keywordflow">case</span> ItemType::Frame: frame.~Block(); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>      <span class="keywordflow">case</span> ItemType::Comment: pair.~Pair(); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>      <span class="keywordflow">case</span> ItemType::Erased: <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    }</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>  }</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>  <span class="keywordtype">void</span> copy_value(<span class="keyword">const</span> Item&amp; o) {</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    <span class="keywordflow">if</span> (o.type == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a> || o.type == ItemType::Comment)</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>      <span class="keyword">new</span> (&amp;pair) <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">Pair</a>(o.pair);</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o.type == ItemType::Loop)</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>      <span class="keyword">new</span> (&amp;loop) Loop(o.loop);</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o.type == ItemType::Frame)</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>      <span class="keyword">new</span> (&amp;frame) Block(o.frame);</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>  }</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span> </div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  <span class="keywordtype">void</span> move_value(Item&amp;&amp; o) {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    <span class="keywordflow">if</span> (o.type == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a> || o.type == ItemType::Comment)</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>      <span class="keyword">new</span> (&amp;pair) <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">Pair</a>(std::move(o.pair));</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o.type == ItemType::Loop)</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>      <span class="keyword">new</span> (&amp;loop) <a class="code hl_enumvalue" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aea89d7b10cb4238977d2b523dfd9ea7745">Loop</a>(std::move(o.loop));</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o.type == ItemType::Frame)</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>      <span class="keyword">new</span> (&amp;frame) Block(std::move(o.frame));</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>  }</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>};</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span> </div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span> </div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span><span class="comment">// ItemSpan is used to add tag-value pairs next to the same category tags.</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1ItemSpan.html">  568</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1ItemSpan.html">ItemSpan</a> {</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1ItemSpan.html#acae94f2cf9922eb288ca1c2450617083">  569</a></span>  <a class="code hl_function" href="structgemmi_1_1cif_1_1ItemSpan.html#acae94f2cf9922eb288ca1c2450617083">ItemSpan</a>(std::vector&lt;Item&gt;&amp; items)</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>      : items_(items), begin_(0), end_(items.size()) {}</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1ItemSpan.html#ab7e1d40183e23f3e1893a6de3e9979b1">  571</a></span>  <a class="code hl_function" href="structgemmi_1_1cif_1_1ItemSpan.html#ab7e1d40183e23f3e1893a6de3e9979b1">ItemSpan</a>(std::vector&lt;Item&gt;&amp; items, std::string prefix)</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>      : <a class="code hl_struct" href="structgemmi_1_1cif_1_1ItemSpan.html">ItemSpan</a>(items) {</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    <a class="code hl_function" href="namespacegemmi_1_1cif.html#a177ba38bf00d6a38d63bfaee0b2e3bcf">assert_tag</a>(prefix);</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    prefix = <a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(prefix);</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    <span class="keywordflow">while</span> (begin_ != end_ &amp;&amp; !items_[begin_].has_prefix(prefix))</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>      ++begin_;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    <span class="keywordflow">if</span> (begin_ != end_)</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>      <span class="keywordflow">while</span> (end_-1 != begin_ &amp;&amp; !items_[end_-1].has_prefix(prefix))</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        --end_;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>  }</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1ItemSpan.html#ade15a455596a9a60dfc8422cf0710c91">  581</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1ItemSpan.html#ade15a455596a9a60dfc8422cf0710c91">set_pair</a>(<span class="keyword">const</span> std::string&amp; tag, <span class="keyword">const</span> std::string&amp; value) {</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>    <a class="code hl_function" href="namespacegemmi_1_1cif.html#a177ba38bf00d6a38d63bfaee0b2e3bcf">assert_tag</a>(tag);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>    std::string lctag = <a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(tag);</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    <span class="keyword">auto</span> end = items_.begin() + end_;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = items_.begin() + begin_; i != end; ++i) {</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>      <span class="keywordflow">if</span> (i-&gt;type == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a> &amp;&amp; <a class="code hl_function" href="namespacegemmi.html#aead2c8d05718c75005302bb96662d2ee">gemmi::iequal</a>(i-&gt;pair[0], lctag)) {</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        i-&gt;pair[0] = tag;  <span class="comment">// if letter case differs, the tag changes</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        i-&gt;pair[1] = value;</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>      }</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>      <span class="keywordflow">if</span> (i-&gt;type == ItemType::Loop &amp;&amp; i-&gt;loop.find_tag_lc(lctag) != -1) {</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>        i-&gt;set_value(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>(tag, value));</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>      }</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    }</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    items_.emplace(end, tag, value);</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>    ++end_;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>  }</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>  std::vector&lt;Item&gt;&amp; items_;</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>  <span class="keywordtype">size_t</span> begin_, end_;  <span class="comment">// iterators would be invalidated by emplace()</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>};</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span> </div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span> </div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Loop.html#aa19b65450432dd3a798734d090ac2fee">  605</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> Loop::set_all_values(std::vector&lt;std::vector&lt;std::string&gt;&gt; columns){</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>  <span class="keywordtype">size_t</span> w = columns.size();</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>  <span class="keywordflow">if</span> (w != width())</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>(<span class="stringliteral">&quot;set_all_values(): expected &quot;</span>, width(), <span class="stringliteral">&quot; columns, got &quot;</span>, w));</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>  <span class="keywordflow">if</span> (w == 0)</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>  <span class="keywordtype">size_t</span> h = columns[0].size();</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; col : columns)</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>    <span class="keywordflow">if</span> (col.size() != h)</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>      <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;set_all_values(): all columns must have the same length&quot;</span>);</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>  values.resize(w * h);</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i != h; ++i)</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j != w; ++j)</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>      values[w * i + j] = std::move(columns[j][i]);</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>}</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span> </div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a01e7805e75d2ed401c12632dab7be578">  621</a></span><span class="keyword">inline</span> std::string* Column::get_tag() {</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>  <span class="keywordflow">if</span> (!item_)</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* loop = get_loop())</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>    <span class="keywordflow">return</span> &amp;loop-&gt;tags.at(col_);</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>  <span class="keywordflow">return</span> &amp;item_-&gt;pair[0];</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>}</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span> </div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a26a9e809a24ed9aac50e975434682576">  629</a></span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* Column::get_loop()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>  <span class="keywordflow">return</span> item_ &amp;&amp; item_-&gt;type == ItemType::Loop ? &amp;item_-&gt;loop : <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>}</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a60431c7b159b640e7294153acbd60b63">  632</a></span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">Column::iterator</a> Column::begin() {</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* loop = get_loop())</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a>({loop-&gt;values.data(), col_, (<span class="keywordtype">unsigned</span>) loop-&gt;width()});</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  <span class="keywordflow">if</span> (item_ &amp;&amp; item_-&gt;type == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a>)</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>    <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a>({&amp;item_-&gt;pair[1], 0, 1});</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>  <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a>();</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>}</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#ae59985cfe8e6db593c3606cf97fb4997">  640</a></span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">Column::iterator</a> Column::end() {</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* loop = get_loop())</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>    <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a>({loop-&gt;values.data() + loop-&gt;values.size(),</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>                    col_, (<span class="keywordtype">unsigned</span>) loop-&gt;width()});</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>  <span class="keywordflow">if</span> (item_ &amp;&amp; item_-&gt;type == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a>)</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a>({&amp;item_-&gt;pair[1] + 1, 0, 1});</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>  <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1BidirIterator.html">iterator</a>();</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>}</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span> </div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno"><a class="line" href="classgemmi_1_1cif_1_1Column.html#a11e9c97db07ced8d56b8d907548cf2ef">  649</a></span><span class="keyword">inline</span> std::string&amp; Column::operator[](<span class="keywordtype">int</span> n) {</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* loop = get_loop())</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>    <span class="keywordflow">return</span> loop-&gt;values[n * loop-&gt;width() + col_];</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>  <span class="keywordflow">return</span> item_-&gt;pair[1];</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>}</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a82da74897383323f445acbd0417d9853">  655</a></span><span class="keyword">inline</span> std::string&amp; Table::Row::operator[](<span class="keywordtype">size_t</span> n) {</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>  <span class="keywordtype">int</span> pos = tab.positions[n];</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* loop = tab.get_loop()) {</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>    <span class="keywordflow">if</span> (row_index == -1) <span class="comment">// tags</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>      <span class="keywordflow">return</span> loop-&gt;tags[pos];</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>    <span class="keywordflow">return</span> loop-&gt;values[loop-&gt;width() * row_index + pos];</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>  }</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>  <span class="keywordflow">return</span> tab.bloc.items[pos].pair[row_index == -1 ? 0 : 1];</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>}</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span> </div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table_1_1Row.html#af58e638c372765bb6c07523ad7e781b1">  665</a></span><span class="keyword">inline</span> std::string&amp; Table::Row::value_at_unsafe(<span class="keywordtype">int</span> pos) {</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* loop = tab.get_loop();</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>  <span class="keywordflow">if</span> (row_index == -1) { <span class="comment">// tags</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>    <span class="keywordflow">if</span> (loop)</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>      <span class="keywordflow">return</span> loop-&gt;<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.at(pos);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    <span class="keywordflow">return</span> tab.bloc.items[pos].pair[0];</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>  }</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>  <span class="keywordflow">if</span> (loop)</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    <span class="keywordflow">return</span> loop-&gt;<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.at(loop-&gt;<a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a320c4a01c0cfa6ba13600ca58121f1eb">width</a>() * row_index + pos);</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>  <span class="keywordflow">return</span> tab.bloc.items[pos].pair[1];</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>}</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> </div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#ad836773214773ffb8490d62503985b13">  677</a></span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* Table::get_loop() {</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>  <span class="keywordflow">return</span> loop_item ? &amp;loop_item-&gt;loop : <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>}</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">  681</a></span><span class="keyword">inline</span> <span class="keywordtype">size_t</span> Table::length()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>  <span class="keywordflow">return</span> loop_item ? loop_item-&gt;loop.<a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a690bebc92bdf9fb316e1a25587359562">length</a>() : (positions.empty() ? 0 : 1);</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>}</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a7d96586afcf1306c81355e8bfa244985">  685</a></span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Table::Row</a> Table::find_row(<span class="keyword">const</span> std::string&amp; s) {</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>  <span class="keywordtype">int</span> pos = positions.<a class="code hl_function" href="structgemmi_1_1cif_1_1Table_1_1Row.html#a0597071bbebf317349ee8da64c27cd41">at</a>(0);</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>* loop = get_loop()) {</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; loop-&gt;values.size(); i += loop-&gt;width())</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacegemmi_1_1cif.html#a741eb67cda0ba2b5a8110ce96718f69d">as_string</a>(loop-&gt;values[i + pos]) == s)</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a>{*<span class="keyword">this</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i / loop-&gt;width())};</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacegemmi_1_1cif.html#a741eb67cda0ba2b5a8110ce96718f69d">as_string</a>(bloc.items[pos].pair[1]) == s) {</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>    <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table_1_1Row.html">Row</a>{*<span class="keyword">this</span>, 0};</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>  }</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>  <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;Not found in &quot;</span> + *column_at_pos(pos).get_tag() + <span class="stringliteral">&quot;: &quot;</span> + s);</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>}</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a485d31a03425797da1a84d4ea4ec5023">  697</a></span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> Table::append_row(T new_values) {</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  <span class="keywordflow">if</span> (!ok())</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;append_row(): table not found&quot;</span>);</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  <span class="keywordflow">if</span> (new_values.size() != width())</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;append_row(): wrong row length&quot;</span>);</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>  <span class="keywordflow">if</span> (!loop_item)</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    convert_pair_to_loop();</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>&amp; loop = loop_item-&gt;loop;</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>  <span class="keywordtype">size_t</span> cur_size = loop.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.size();</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>  loop.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.resize(cur_size + loop.<a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a320c4a01c0cfa6ba13600ca58121f1eb">width</a>(), <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>  <span class="keywordtype">int</span> n = 0;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; value : new_values)</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>    loop.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>[cur_size + positions[n++]] = value;</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>}</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#aebfef31bd498ae340e1eea5b4ecc8fdf">  712</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> Table::remove_rows(<span class="keywordtype">int</span> start, <span class="keywordtype">int</span> end) {</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>  <span class="keywordflow">if</span> (!ok())</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    <span class="comment">// this function is used mostly through remove_row()</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;remove_row(): table not found&quot;</span>);</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>  <span class="keywordflow">if</span> (!loop_item)</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    convert_pair_to_loop();</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Loop.html">Loop</a>&amp; loop = loop_item-&gt;loop;</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>  <span class="keywordtype">size_t</span> start_pos = start * loop.<a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a320c4a01c0cfa6ba13600ca58121f1eb">width</a>();</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>  <span class="keywordtype">size_t</span> end_pos = end * loop.<a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a320c4a01c0cfa6ba13600ca58121f1eb">width</a>();</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>  <span class="keywordflow">if</span> (start_pos &gt;= end_pos || end_pos &gt; loop.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.size())</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;remove_row(): invalid index&quot;</span>);</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>  loop.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.erase(loop.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.begin() + start_pos,</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>                    loop.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">values</a>.begin() + end_pos);</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>}</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span> </div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#af4fb8f34e769249aa678d5b8f916d7b0">  727</a></span><span class="keyword">inline</span> <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> Table::column_at_pos(<span class="keywordtype">int</span> pos) {</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>  <span class="keywordflow">if</span> (loop_item)</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a>(loop_item, pos);</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a>(&amp;bloc.items[pos], 0);</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>}</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span> </div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#a89767fc8f8c27b256f920e30cf483dfb">  733</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> Table::erase() {</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>  <span class="keywordflow">if</span> (loop_item) {</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    loop_item-&gt;erase();</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    loop_item = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pos : positions)</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>      <span class="keywordflow">if</span> (pos &gt;= 0)</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>        bloc.items[pos].erase();</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>  }</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>  positions.clear();</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>}</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span> </div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Table.html#abf4bc7fad9eac00d90e2eac9251d935e">  745</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> Table::convert_pair_to_loop() {</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>  assert(loop_item == <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a> new_item(<a class="code hl_struct" href="structgemmi_1_1cif_1_1LoopArg.html">LoopArg</a>{});</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>  new_item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.resize(positions.size());</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>  new_item.loop.values.resize(positions.size());</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i != positions.size(); ++i) {</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>    <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; item = bloc.items[positions[i]];</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>    new_item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>[i].swap(item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">pair</a>[0]);</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>    new_item.loop.values[i].swap(item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">pair</a>[1]);</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>    item.<a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a6e27372e6c72890d0a9b8944ac12540a">erase</a>();</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>  }</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>  loop_item = &amp;bloc.items.at(positions[0]);</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>  loop_item-&gt;set_value(std::move(new_item));</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>}</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span> </div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a00333a24f6cb59f35f6ee3a9175589d1">  760</a></span><span class="keyword">inline</span> <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* Block::find_pair_item(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>  std::string lctag = <a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(tag);</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; i : items)</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    <span class="keywordflow">if</span> (i.type == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a> &amp;&amp; <a class="code hl_function" href="namespacegemmi.html#aead2c8d05718c75005302bb96662d2ee">gemmi::iequal</a>(i.pair[0], lctag))</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>      <span class="keywordflow">return</span> &amp;i;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>}</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#adf68f9e8e202ace7c4abc28649bfd9f5">  768</a></span><span class="keyword">inline</span> <span class="keyword">const</span> <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">Pair</a>* Block::find_pair(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>  <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* item = find_pair_item(tag);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>  <span class="keywordflow">return</span> item ? &amp;item-&gt;<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">pair</a> : <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>}</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span> </div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a396f695a8f7687e4455c721f0a370726">  773</a></span><span class="keyword">inline</span> <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> Block::find_loop(<span class="keyword">const</span> std::string&amp; tag) {</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>  <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> c = find_values(tag);</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>  <span class="keywordflow">return</span> c.<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ae16c0ac37c0b6b54375bde2249e46b7c">item</a>() &amp;&amp; c.<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ae16c0ac37c0b6b54375bde2249e46b7c">item</a>()-&gt;<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a> == ItemType::Loop ? c : <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a>();</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>}</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a13cf4a43729935f357aa46f2d9cf1f36">  778</a></span><span class="keyword">inline</span> <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* Block::find_loop_item(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>  std::string lctag = <a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(tag);</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; i : items)</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>    <span class="keywordflow">if</span> (i.type == ItemType::Loop &amp;&amp; i.loop.find_tag_lc(tag) != -1)</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>      <span class="keywordflow">return</span> &amp;i;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>}</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span> </div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a2ef7efc20e67043bcd9534c87352602a">  786</a></span><span class="keyword">inline</span> <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> Block::find_values(<span class="keyword">const</span> std::string&amp; tag) {</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>  std::string lctag = <a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(tag);</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>  <span class="keywordflow">for</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; i : items)</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>    <span class="keywordflow">if</span> (i.type == ItemType::Loop) {</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>      <span class="keywordtype">int</span> pos = i.loop.find_tag_lc(lctag);</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>      <span class="keywordflow">if</span> (pos != -1)</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a>{&amp;i, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(pos)};</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i.type == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a>) {</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacegemmi.html#aead2c8d05718c75005302bb96662d2ee">gemmi::iequal</a>(i.pair[0], lctag))</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a>{&amp;i, 0};</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>    }</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a>{<span class="keyword">nullptr</span>, 0};</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>}</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span> </div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a65ea956a3d20b8790018cb1ec127c680">  800</a></span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>* Block::find_frame(std::string frame_name) {</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>  frame_name = <a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(frame_name);</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>  <span class="keywordflow">for</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; i : items)</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>    <span class="keywordflow">if</span> (i.type == ItemType::Frame &amp;&amp; <a class="code hl_function" href="namespacegemmi.html#aead2c8d05718c75005302bb96662d2ee">gemmi::iequal</a>(i.frame.name, frame_name))</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>      <span class="keywordflow">return</span> &amp;i.frame;</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>}</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span> </div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#acafcb469122cac440c4acfd335453072">  808</a></span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> Block::item_as_table(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; item) {</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>  <span class="keywordflow">if</span> (item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a> != ItemType::Loop)</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;item_as_table: item is not Loop&quot;</span>);</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>  std::vector&lt;int&gt; indices(item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>.size());</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j != indices.size(); ++j)</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>    indices[j] = (<span class="keywordtype">int</span>) j;</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>  <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>{&amp;item, *<span class="keyword">this</span>, indices, 0};</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>}</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span> </div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#ae466d627a6d9593dd708f8d7243b2d6c">  817</a></span><span class="keyword">inline</span> <span class="keywordtype">size_t</span> Block::get_index(<span class="keyword">const</span> std::string&amp; tag)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>  std::string lctag = <a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(tag);</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i != items.size(); ++i) {</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; item = items[i];</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>    <span class="keywordflow">if</span> ((item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a> == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a> &amp;&amp; <a class="code hl_function" href="namespacegemmi.html#aead2c8d05718c75005302bb96662d2ee">gemmi::iequal</a>(item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">pair</a>[0], lctag)) ||</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>        (item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a> == ItemType::Loop &amp;&amp; item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>.<a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#ae939de430a2e2e4bfe10c716e4fe6496">find_tag_lc</a>(lctag) != -1))</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>      <span class="keywordflow">return</span> i;</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>  }</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>  <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(tag + <span class="stringliteral">&quot; not found in block&quot;</span>);</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>}</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span> </div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a5edaccd6d044720bd2d12b6a7304f4a7">  828</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> Block::set_pair(<span class="keyword">const</span> std::string&amp; tag, <span class="keyword">const</span> std::string&amp; value) {</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1ItemSpan.html">ItemSpan</a>(items).<a class="code hl_function" href="structgemmi_1_1cif_1_1ItemSpan.html#ade15a455596a9a60dfc8422cf0710c91">set_pair</a>(tag, value);</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>}</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span> </div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a0ee2d3958f895a0b810977da3945a07b">  832</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> Block::move_item(<span class="keywordtype">int</span> old_pos, <span class="keywordtype">int</span> new_pos) {</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>  <span class="keywordflow">if</span> (old_pos &lt; 0)</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>    old_pos += items.size();</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>  <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>) old_pos &gt;= items.size())</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;move_item: old_pos out of range&quot;</span>);</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>  <span class="keywordflow">if</span> (new_pos &lt; 0)</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>    new_pos += items.size();</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>  <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>) new_pos &gt;= items.size())</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;move_item: new_pos out of range&quot;</span>);</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>  <span class="keyword">auto</span> src = items.begin() + old_pos;</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>  <span class="keyword">auto</span> dst = items.begin() + new_pos;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>  <span class="keywordflow">if</span> (src &lt; dst)</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>    std::rotate(src, src+1, dst+1);</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>    std::rotate(dst, src, src+1);</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>}</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span> </div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#acddcb8202a4ce1f21c4b817a7b1793b7">  849</a></span><span class="keyword">inline</span> std::vector&lt;std::string&gt; Block::get_mmcif_category_names()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>  std::vector&lt;std::string&gt; cats;</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; item : items) {</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>    <span class="keyword">const</span> std::string* tag = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>    <span class="keywordflow">if</span> (item.type == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a>)</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>      tag = &amp;item.pair[0];</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (item.type == ItemType::Loop &amp;&amp; !item.loop.tags.empty())</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>      tag = &amp;item.loop.tags[0];</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>    <span class="keywordflow">if</span> (tag)</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> j = cats.rbegin(); j != cats.rend(); ++j)</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacegemmi.html#ac4b9324deb8e7200a8140399b6e40776">gemmi::starts_with</a>(*tag, *j)) {</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>          tag = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>        }</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>    <span class="keywordflow">if</span> (tag) {</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>      <span class="keywordtype">size_t</span> dot = tag-&gt;find(<span class="charliteral">&#39;.&#39;</span>);</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>      <span class="keywordflow">if</span> (dot != std::string::npos)</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>        cats.emplace_back(*tag, 0, dot + 1);</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>    }</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>  }</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>  <span class="keywordflow">return</span> cats;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>}</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span> </div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; Block::setup_loop_item(<a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>&amp;&amp; tab, <span class="keyword">const</span> std::string&amp; prefix,</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>                                    std::vector&lt;std::string&gt;&amp;&amp; tags) {</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a> *item;</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>  <span class="keywordflow">if</span> (tab.loop_item) {</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>    item = tab.loop_item;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>    item-&gt;<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>.<a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#ad39dd5d56b0b30cf441017325c35b0d2">clear</a>();</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tab.ok()) {</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>    item = &amp;tab.bloc.items.at(tab.positions[0]);</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>    tab.<a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a6e27372e6c72890d0a9b8944ac12540a">erase</a>();</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>    item-&gt;<a class="code hl_function" href="structgemmi_1_1cif_1_1Item.html#a69fe3f2aa8d468d4b2db03efd078f40a">set_value</a>(Item(LoopArg{}));</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>    items.emplace_back(LoopArg{});</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>    item = &amp;items.back();</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>  }</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>  <span class="keywordflow">for</span> (std::string&amp; tag : tags) {</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>    tag.insert(0, prefix);</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>    <a class="code hl_function" href="namespacegemmi_1_1cif.html#a177ba38bf00d6a38d63bfaee0b2e3bcf">assert_tag</a>(tag);</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>  }</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>  item-&gt;<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a> = std::move(tags);</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>  <span class="keywordflow">return</span> *item;</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>}</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span> </div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span><span class="keyword">inline</span> <a class="code hl_enumvalue" href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aea89d7b10cb4238977d2b523dfd9ea7745">Loop</a>&amp; Block::setup_loop(Table&amp;&amp; tab, <span class="keyword">const</span> std::string&amp; prefix,</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>                               std::vector&lt;std::string&gt;&amp;&amp; tags) {</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>  <span class="keywordflow">return</span> setup_loop_item(std::move(tab), prefix, std::move(tags)).loop;</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>}</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span> </div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a568dd4077997b7289c7df413c4d13ac4">  899</a></span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> Block::find(<span class="keyword">const</span> std::string&amp; prefix,</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>                         <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; tags) {</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* loop_item = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>  <span class="keywordflow">if</span> (!tags.empty()) {</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>    <span class="keywordflow">if</span> (tags[0][0] == <span class="charliteral">&#39;?&#39;</span>)</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>      <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;The first tag in find() cannot be ?optional.&quot;</span>);</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    loop_item = find_loop(prefix + tags[0]).item();</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>  }</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span> </div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>  std::vector&lt;int&gt; indices;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>  indices.reserve(tags.size());</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>  <span class="keywordflow">if</span> (loop_item) {</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> std::string&amp; tag : tags) {</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>      std::string full_tag = prefix + (tag[0] != <span class="charliteral">&#39;?&#39;</span> ? tag : tag.substr(1));</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>      <span class="keywordtype">int</span> idx = loop_item-&gt;<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>.<a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a3341176041c4a0459215d5af990c2858">find_tag</a>(full_tag);</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>      <span class="keywordflow">if</span> (idx == -1 &amp;&amp; tag[0] != <span class="charliteral">&#39;?&#39;</span>) {</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>        loop_item = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        indices.clear();</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>      }</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>      indices.push_back(idx);</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>    }</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> std::string&amp; tag : tags) {</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>      std::string full_tag = prefix + (tag[0] != <span class="charliteral">&#39;?&#39;</span> ? tag : tag.substr(1));</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>      <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* p = find_pair_item(full_tag)) {</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>        indices.push_back(p - items.data());</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag[0] == <span class="charliteral">&#39;?&#39;</span>) {</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>        indices.push_back(-1);</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>        indices.clear();</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>      }</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>    }</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>  }</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>  <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>{loop_item, *<span class="keyword">this</span>, indices, prefix.length()};</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>}</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span> </div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a43d38511b5998211edc625205ab8d27b">  937</a></span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> Block::find_any(<span class="keyword">const</span> std::string&amp; prefix,</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>                             <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; tags) {</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>  std::vector&lt;int&gt; indices;</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> tag = tags.begin(); tag != tags.end(); ++tag) {</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>    <a class="code hl_class" href="classgemmi_1_1cif_1_1Column.html">Column</a> column = find_values(prefix + *tag);</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* item = column.<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#ae16c0ac37c0b6b54375bde2249e46b7c">item</a>()) {</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>      <span class="keywordflow">if</span> (item-&gt;<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a> == ItemType::Loop) {</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>        indices.push_back(column.<a class="code hl_function" href="classgemmi_1_1cif_1_1Column.html#a27b8a6ea88c77c3597604c19325ad694">col</a>());</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>        <span class="keywordflow">while</span> (++tag != tags.end()) {</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>          <span class="keywordtype">int</span> idx = item-&gt;<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>.<a class="code hl_function" href="structgemmi_1_1cif_1_1Loop.html#a3341176041c4a0459215d5af990c2858">find_tag</a>(prefix + *tag);</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>          <span class="keywordflow">if</span> (idx != -1)</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>            indices.push_back(idx);</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>        }</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>        <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>{item, *<span class="keyword">this</span>, indices, prefix.length()};</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        indices.push_back(item - items.data());</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>        <span class="keywordflow">while</span> (++tag != tags.end())</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>          <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>* p = find_pair_item(prefix + *tag))</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>            indices.push_back(p - items.data());</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>{<span class="keyword">nullptr</span>, *<span class="keyword">this</span>, indices, prefix.<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">length</a>()};</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>      }</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>    }</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>  }</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>  <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>{<span class="keyword">nullptr</span>, *<span class="keyword">this</span>, indices, prefix.<a class="code hl_function" href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">length</a>()};</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>}</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Block.html#a7e34a1e8f968f978c283c8fb0eaeea5b">  963</a></span><span class="keyword">inline</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a> Block::find_mmcif_category(std::string <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>) {</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>  <a class="code hl_function" href="namespacegemmi_1_1cif.html#ab9ea00e63acd9bb7aa9312029341427a">ensure_mmcif_category</a>(<a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>);</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>  <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a> = <a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(<a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>);</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>  std::vector&lt;int&gt; indices;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>  <span class="keywordflow">for</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; i : items)</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>    <span class="keywordflow">if</span> (i.has_prefix(<a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>)) {</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>      <span class="keywordflow">if</span> (i.type == ItemType::Loop) {</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>        indices.resize(i.loop.tags.size());</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j != indices.size(); ++j) {</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>          indices[j] = j;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>          <span class="keyword">const</span> std::string&amp; tag = i.loop.tags[j];</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>          <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespacegemmi.html#a5391ca865c7447711216f37561fd46e0">istarts_with</a>(tag, <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>))</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>            <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;Tag &quot;</span>, tag, <span class="stringliteral">&quot; in loop with &quot;</span>, <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>);</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>        }</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>        <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>{&amp;i, *<span class="keyword">this</span>, indices, <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>.length()};</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>        indices.push_back(&amp;i - items.data());</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>      }</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>    }</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>  <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Table.html">Table</a>{<span class="keyword">nullptr</span>, *<span class="keyword">this</span>, indices, <a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>.length()};</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>}</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span> </div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> </div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Document.html">  986</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Document.html">Document</a> {</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Document.html#a6fdeabea98719143c0923028e447c4af">  987</a></span>  std::string <a class="code hl_variable" href="structgemmi_1_1cif_1_1Document.html#a6fdeabea98719143c0923028e447c4af">source</a>;</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Document.html#a74fa720d77402fc5b9db729a15a239d5">  988</a></span>  std::vector&lt;Block&gt; <a class="code hl_variable" href="structgemmi_1_1cif_1_1Document.html#a74fa720d77402fc5b9db729a15a239d5">blocks</a>;</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span> </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>  <span class="comment">// implementation detail: items of the currently parsed block or frame</span></div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>  std::vector&lt;Item&gt;* items_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span> </div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Document.html#a3ef2027e79d9753fb1b59c73e7750884">  993</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Document.html#a3ef2027e79d9753fb1b59c73e7750884">add_new_block</a>(<span class="keyword">const</span> std::string&amp; name, <span class="keywordtype">int</span> pos=-1) {</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    <span class="keywordflow">if</span> (find_block(name))</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>      <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;Block with such name already exists: &quot;</span> + name);</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>    <span class="keywordflow">if</span> (pos &gt; 0 &amp;&amp; <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(pos) &gt; blocks.size())</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>      <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;add_new_block(): invalid position&quot;</span>);</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>    <span class="keywordflow">return</span> *blocks.emplace(pos &lt; 0 ? blocks.end() : blocks.begin() + pos, name);</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>  }</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span> </div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Document.html#a116368c81dc33b94683517b4ad5657ee"> 1001</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1cif_1_1Document.html#a116368c81dc33b94683517b4ad5657ee">clear</a>() noexcept {</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>    source.clear();</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>    blocks.clear();</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>    items_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>  }</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span> </div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>  <span class="comment">// returns blocks[0] if the document has exactly one block (like mmCIF)</span></div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Document.html#ae692ce3e2fab46ab0ec58b271017e82b"> 1008</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Document.html#ae692ce3e2fab46ab0ec58b271017e82b">sole_block</a>() {</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>    <span class="keywordflow">if</span> (blocks.size() &gt; 1)</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>      <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;single data block expected, got &quot;</span> + std::to_string(blocks.size()));</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>    <span class="keywordflow">return</span> blocks.at(0);</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>  }</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Document.html#a2a020dab4b2eb8b5ad07330010bffcab"> 1013</a></span>  <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; <a class="code hl_function" href="structgemmi_1_1cif_1_1Document.html#a2a020dab4b2eb8b5ad07330010bffcab">sole_block</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>    <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Document.html">Document</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;sole_block();</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>  }</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span> </div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Document.html#ae0bee779cb8d22515bb534545e07ed29"> 1017</a></span>  <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>* <a class="code hl_function" href="structgemmi_1_1cif_1_1Document.html#ae0bee779cb8d22515bb534545e07ed29">find_block</a>(<span class="keyword">const</span> std::string&amp; name) {</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>    <span class="keywordflow">for</span> (<a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; b : blocks)</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>      <span class="keywordflow">if</span> (b.name == name)</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>        <span class="keywordflow">return</span> &amp;b;</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>  }</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"><a class="line" href="structgemmi_1_1cif_1_1Document.html#a3dc57b468e9c0b3f7f626d6a8a31baf6"> 1023</a></span>  <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>* <a class="code hl_function" href="structgemmi_1_1cif_1_1Document.html#a3dc57b468e9c0b3f7f626d6a8a31baf6">find_block</a>(<span class="keyword">const</span> std::string&amp; name)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>    <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structgemmi_1_1cif_1_1Document.html">Document</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;find_block(name);</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>  }</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>};</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span> </div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span> </div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>[[noreturn]]</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#ac3757d24a9e40b15ead6550a579161da"> 1030</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#ac3757d24a9e40b15ead6550a579161da">cif_fail</a>(<span class="keyword">const</span> std::string&amp; source, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; b,</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>                     <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; item, <span class="keyword">const</span> std::string&amp; s) {</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>  <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<a class="code hl_function" href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">cat</a>(source, <span class="charliteral">&#39;:&#39;</span>, item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a5fba7dae1f126f62f2505b998211529e">line_number</a>, <span class="stringliteral">&quot; in data_&quot;</span>, b.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>, <span class="stringliteral">&quot;: &quot;</span>, s));</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>}</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span> </div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a3eede62357cb085275d5101d8716afb1"> 1035</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a3eede62357cb085275d5101d8716afb1">check_for_missing_values_in_block</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; block,</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>                                              <span class="keyword">const</span> std::string&amp; source) {</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; item : block.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a5dd89492b42634c8ff853ce45c7c2636">items</a>) {</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    <span class="keywordflow">if</span> (item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a> == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a>) {</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>      <span class="keywordflow">if</span> (item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">pair</a>[1].empty())</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>        <a class="code hl_function" href="namespacegemmi_1_1cif.html#ac3757d24a9e40b15ead6550a579161da">cif_fail</a>(source, block, item, item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">pair</a>[0] + <span class="stringliteral">&quot; has no value&quot;</span>);</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a> == ItemType::Frame) {</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>      <a class="code hl_function" href="namespacegemmi_1_1cif.html#a3eede62357cb085275d5101d8716afb1">check_for_missing_values_in_block</a>(item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad306c06efb04e5383c9b7862888dc8de">frame</a>, source);</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>    }</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>  }</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>}</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span> </div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span><span class="comment">// Throw an error if any item (pair) value is missing</span></div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a0c4b9a2b379489c8830e07efdc7d363e"> 1048</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a0c4b9a2b379489c8830e07efdc7d363e">check_for_missing_values</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Document.html">Document</a>&amp; d) {</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; block : d.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Document.html#a74fa720d77402fc5b9db729a15a239d5">blocks</a>)</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>    <a class="code hl_function" href="namespacegemmi_1_1cif.html#a3eede62357cb085275d5101d8716afb1">check_for_missing_values_in_block</a>(block, d.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Document.html#a6fdeabea98719143c0923028e447c4af">source</a>);</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>}</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span> </div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span><span class="comment">// Throw an error if any block name, frame name or tag is duplicated.</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#aa5c8835bd5a1ecc5f50c87b072d9e17f"> 1054</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#aa5c8835bd5a1ecc5f50c87b072d9e17f">check_for_duplicates</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Document.html">Document</a>&amp; d) {</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>  <span class="comment">// check for duplicate block names (except empty &quot;&quot; which is global_)</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>  std::unordered_set&lt;std::string&gt; names;</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; block : d.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Document.html#a74fa720d77402fc5b9db729a15a239d5">blocks</a>) {</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>    <span class="keywordtype">bool</span> ok = names.insert(<a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(block.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>)).second;</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>    <span class="keywordflow">if</span> (!ok &amp;&amp; !block.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>.empty())</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>      <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(d.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Document.html#a6fdeabea98719143c0923028e447c4af">source</a> + <span class="stringliteral">&quot;: duplicate block name: &quot;</span>, block.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>);</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>  }</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>  <span class="comment">// check for dups inside each block</span></div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>  std::unordered_set&lt;std::string&gt; frame_names;</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Block.html">Block</a>&amp; block : d.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Document.html#a74fa720d77402fc5b9db729a15a239d5">blocks</a>) {</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>    names.clear();</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>    frame_names.clear();</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1cif_1_1Item.html">Item</a>&amp; item : block.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a5dd89492b42634c8ff853ce45c7c2636">items</a>) {</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>      <span class="keywordflow">if</span> (item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a> == <a class="code hl_typedef" href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">ItemType::Pair</a>) {</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>        <span class="keywordtype">bool</span> ok = names.insert(<a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">pair</a>[0])).second;</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>        <span class="keywordflow">if</span> (!ok)</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>          <a class="code hl_function" href="namespacegemmi_1_1cif.html#ac3757d24a9e40b15ead6550a579161da">cif_fail</a>(d.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Document.html#a6fdeabea98719143c0923028e447c4af">source</a>, block, item, <span class="stringliteral">&quot;duplicate tag &quot;</span> + item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">pair</a>[0]);</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a> == ItemType::Loop) {</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> std::string&amp; t : item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">loop</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">tags</a>) {</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>          <span class="keywordtype">bool</span> ok = names.insert(<a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(t)).second;</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>          <span class="keywordflow">if</span> (!ok)</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>            <a class="code hl_function" href="namespacegemmi_1_1cif.html#ac3757d24a9e40b15ead6550a579161da">cif_fail</a>(d.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Document.html#a6fdeabea98719143c0923028e447c4af">source</a>, block, item, <span class="stringliteral">&quot;duplicate tag &quot;</span> + t);</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>        }</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">type</a> == ItemType::Frame) {</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>        <span class="keywordtype">bool</span> ok = frame_names.insert(<a class="code hl_function" href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a>(item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad306c06efb04e5383c9b7862888dc8de">frame</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>)).second;</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>        <span class="keywordflow">if</span> (!ok)</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>          <a class="code hl_function" href="namespacegemmi_1_1cif.html#ac3757d24a9e40b15ead6550a579161da">cif_fail</a>(d.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Document.html#a6fdeabea98719143c0923028e447c4af">source</a>, block, item, <span class="stringliteral">&quot;duplicate save_&quot;</span> + item.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Item.html#ad306c06efb04e5383c9b7862888dc8de">frame</a>.<a class="code hl_variable" href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">name</a>);</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>      }</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>    }</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>  }</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>}</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span> </div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a5de50d7771e86f9f320aa48274b1c7da"> 1087</a></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="namespacegemmi_1_1cif.html#a5de50d7771e86f9f320aa48274b1c7da">is_text_field</a>(<span class="keyword">const</span> std::string&amp; val) {</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>  <span class="keywordtype">size_t</span> len = val.size();</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>  <span class="keywordflow">return</span> len &gt; 2 &amp;&amp; val[0] == <span class="charliteral">&#39;;&#39;</span> &amp;&amp; (val[len-2] == <span class="charliteral">&#39;\n&#39;</span> || val[len-2] == <span class="charliteral">&#39;\r&#39;</span>);</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>}</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span> </div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"><a class="line" href="namespacegemmi_1_1cif.html#a49ff21e9d31f14246867656307117677"> 1092</a></span><span class="keyword">inline</span> std::string <a class="code hl_function" href="namespacegemmi_1_1cif.html#a49ff21e9d31f14246867656307117677">quote</a>(std::string v) {</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>  <span class="keywordflow">if</span> (std::all_of(v.begin(), v.end(), [](<span class="keywordtype">char</span> c) { return char_table(c) == 1; })</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>      &amp;&amp; !v.empty() &amp;&amp; !<a class="code hl_function" href="namespacegemmi_1_1cif.html#a4812498831f81a091de7c5248ae2d09a">is_null</a>(v))</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>    <span class="keywordflow">return</span> v;</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>  <span class="keywordtype">char</span> q = <span class="charliteral">&#39;;&#39;</span>;</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>  <span class="keywordflow">if</span> (std::memchr(v.c_str(), <span class="charliteral">&#39;\n&#39;</span>, v.size()) == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>    <span class="keywordflow">if</span> (std::memchr(v.c_str(), <span class="charliteral">&#39;\&#39;&#39;</span>, v.size()) == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>      q = <span class="charliteral">&#39;\&#39;&#39;</span>;</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::memchr(v.c_str(), <span class="charliteral">&#39;&quot;&#39;</span>, v.size()) == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>      q = <span class="charliteral">&#39;&quot;&#39;</span>;</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>  }</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>  v.insert(v.begin(), q);</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>  <span class="keywordflow">if</span> (q == <span class="charliteral">&#39;;&#39;</span>)</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>    v += <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>  v += q;</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>  <span class="keywordflow">return</span> v;</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>}</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span> </div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span><span class="preprocessor">#if defined(_MSC_VER)</span></div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span><span class="preprocessor">#pragma warning(pop)</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span> </div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>} <span class="comment">// namespace cif</span></div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>} <span class="comment">// namespace gemmi</span></div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aatox_8hpp_html"><div class="ttname"><a href="atox_8hpp.html">atox.hpp</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html">gemmi::cif::Column</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00194">cifdoc.hpp:194</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a01e7805e75d2ed401c12632dab7be578"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a01e7805e75d2ed401c12632dab7be578">gemmi::cif::Column::get_tag</a></div><div class="ttdeci">std::string * get_tag()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00621">cifdoc.hpp:621</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a11e9c97db07ced8d56b8d907548cf2ef"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a11e9c97db07ced8d56b8d907548cf2ef">gemmi::cif::Column::operator[]</a></div><div class="ttdeci">std::string &amp; operator[](int n)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00649">cifdoc.hpp:649</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a150b62943a926bd783dd07507ed5a005"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a150b62943a926bd783dd07507ed5a005">gemmi::cif::Column::end</a></div><div class="ttdeci">const_iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00203">cifdoc.hpp:203</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a26a9e809a24ed9aac50e975434682576"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a26a9e809a24ed9aac50e975434682576">gemmi::cif::Column::get_loop</a></div><div class="ttdeci">Loop * get_loop() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00629">cifdoc.hpp:629</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a27b8a6ea88c77c3597604c19325ad694"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a27b8a6ea88c77c3597604c19325ad694">gemmi::cif::Column::col</a></div><div class="ttdeci">size_t col() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00232">cifdoc.hpp:232</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a2b38f7f5217e8799644b34f8a9ba2ffe"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a2b38f7f5217e8799644b34f8a9ba2ffe">gemmi::cif::Column::Column</a></div><div class="ttdeci">Column(Item *item, size_t col)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00197">cifdoc.hpp:197</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a2fd07c8bcca95602e53102cf12ab0b37"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a2fd07c8bcca95602e53102cf12ab0b37">gemmi::cif::Column::length</a></div><div class="ttdeci">int length() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00210">cifdoc.hpp:210</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a45b5168fa394ef13cbf0880bd4ed36ad"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a45b5168fa394ef13cbf0880bd4ed36ad">gemmi::cif::Column::str</a></div><div class="ttdeci">std::string str(int n) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00229">cifdoc.hpp:229</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a55c717dae97d9079d99de124621490ef"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a55c717dae97d9079d99de124621490ef">gemmi::cif::Column::item</a></div><div class="ttdeci">Item * item()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00231">cifdoc.hpp:231</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a5738fb9ac76423d2253c6508de09d968"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a5738fb9ac76423d2253c6508de09d968">gemmi::cif::Column::at</a></div><div class="ttdeci">const std::string &amp; at(int n) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00225">cifdoc.hpp:225</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_a60431c7b159b640e7294153acbd60b63"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#a60431c7b159b640e7294153acbd60b63">gemmi::cif::Column::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00632">cifdoc.hpp:632</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_aa7923d7164159e8f580e1b7db94c7ee0"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#aa7923d7164159e8f580e1b7db94c7ee0">gemmi::cif::Column::get_tag</a></div><div class="ttdeci">const std::string * get_tag() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00207">cifdoc.hpp:207</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_ab6d70d578f15d019712d6ca50c80bbb1"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#ab6d70d578f15d019712d6ca50c80bbb1">gemmi::cif::Column::at</a></div><div class="ttdeci">std::string &amp; at(int n)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00217">cifdoc.hpp:217</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_ac25b69671c519a00ccbfceca08335ead"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#ac25b69671c519a00ccbfceca08335ead">gemmi::cif::Column::Column</a></div><div class="ttdeci">Column()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00196">cifdoc.hpp:196</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_ad6693a2d928c9282415271bd2391bb30"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#ad6693a2d928c9282415271bd2391bb30">gemmi::cif::Column::begin</a></div><div class="ttdeci">const_iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00202">cifdoc.hpp:202</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_ae16c0ac37c0b6b54375bde2249e46b7c"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#ae16c0ac37c0b6b54375bde2249e46b7c">gemmi::cif::Column::item</a></div><div class="ttdeci">const Item * item() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00230">cifdoc.hpp:230</a></div></div>
<div class="ttc" id="aclassgemmi_1_1cif_1_1Column_html_ae59985cfe8e6db593c3606cf97fb4997"><div class="ttname"><a href="classgemmi_1_1cif_1_1Column.html#ae59985cfe8e6db593c3606cf97fb4997">gemmi::cif::Column::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00640">cifdoc.hpp:640</a></div></div>
<div class="ttc" id="afail_8hpp_html"><div class="ttname"><a href="fail_8hpp.html">fail.hpp</a></div></div>
<div class="ttc" id="aiterator_8hpp_html"><div class="ttname"><a href="iterator_8hpp.html">iterator.hpp</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a06ac2450f93acc24f653e50f2635f499"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a06ac2450f93acc24f653e50f2635f499">gemmi::cif::as_char</a></div><div class="ttdeci">char as_char(const std::string &amp;value, char null)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00097">cifdoc.hpp:97</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a0c4b9a2b379489c8830e07efdc7d363e"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a0c4b9a2b379489c8830e07efdc7d363e">gemmi::cif::check_for_missing_values</a></div><div class="ttdeci">void check_for_missing_values(const Document &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01048">cifdoc.hpp:1048</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a177ba38bf00d6a38d63bfaee0b2e3bcf"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a177ba38bf00d6a38d63bfaee0b2e3bcf">gemmi::cif::assert_tag</a></div><div class="ttdeci">void assert_tag(const std::string &amp;tag)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00065">cifdoc.hpp:65</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a20b5c32fa619ae2bc2a351a9c06e5ed1"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a20b5c32fa619ae2bc2a351a9c06e5ed1">gemmi::cif::as_any</a></div><div class="ttdeci">int as_any(const std::string &amp;s, int null)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00117">cifdoc.hpp:117</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a2fa5c5b0c76f1cbae07b880a978b8c5b"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a2fa5c5b0c76f1cbae07b880a978b8c5b">gemmi::cif::as_string</a></div><div class="ttdeci">std::string as_string(const std::string &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00081">cifdoc.hpp:81</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a3eede62357cb085275d5101d8716afb1"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a3eede62357cb085275d5101d8716afb1">gemmi::cif::check_for_missing_values_in_block</a></div><div class="ttdeci">void check_for_missing_values_in_block(const Block &amp;block, const std::string &amp;source)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01035">cifdoc.hpp:1035</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a435adb6ead791b887f122c8b1ee98687"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a435adb6ead791b887f122c8b1ee98687">gemmi::cif::Pair</a></div><div class="ttdeci">std::array&lt; std::string, 2 &gt; Pair</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00121">cifdoc.hpp:121</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a4812498831f81a091de7c5248ae2d09a"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a4812498831f81a091de7c5248ae2d09a">gemmi::cif::is_null</a></div><div class="ttdeci">bool is_null(const std::string &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00077">cifdoc.hpp:77</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a49ff21e9d31f14246867656307117677"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a49ff21e9d31f14246867656307117677">gemmi::cif::quote</a></div><div class="ttdeci">std::string quote(std::string v)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01092">cifdoc.hpp:1092</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a5de50d7771e86f9f320aa48274b1c7da"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a5de50d7771e86f9f320aa48274b1c7da">gemmi::cif::is_text_field</a></div><div class="ttdeci">bool is_text_field(const std::string &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01087">cifdoc.hpp:1087</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_a741eb67cda0ba2b5a8110ce96718f69d"><div class="ttname"><a href="namespacegemmi_1_1cif.html#a741eb67cda0ba2b5a8110ce96718f69d">gemmi::cif::as_string</a></div><div class="ttdeci">std::string as_string(const std::string *value)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00093">cifdoc.hpp:93</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_aa5c8835bd5a1ecc5f50c87b072d9e17f"><div class="ttname"><a href="namespacegemmi_1_1cif.html#aa5c8835bd5a1ecc5f50c87b072d9e17f">gemmi::cif::check_for_duplicates</a></div><div class="ttdeci">void check_for_duplicates(const Document &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01054">cifdoc.hpp:1054</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_ab9ea00e63acd9bb7aa9312029341427a"><div class="ttname"><a href="namespacegemmi_1_1cif.html#ab9ea00e63acd9bb7aa9312029341427a">gemmi::cif::ensure_mmcif_category</a></div><div class="ttdeci">void ensure_mmcif_category(std::string &amp;cat)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00070">cifdoc.hpp:70</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_ac3757d24a9e40b15ead6550a579161da"><div class="ttname"><a href="namespacegemmi_1_1cif.html#ac3757d24a9e40b15ead6550a579161da">gemmi::cif::cif_fail</a></div><div class="ttdeci">void cif_fail(const std::string &amp;source, const Block &amp;b, const Item &amp;item, const std::string &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01030">cifdoc.hpp:1030</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_ae351c8cc0971a7ce253a4ff6a93432eb"><div class="ttname"><a href="namespacegemmi_1_1cif.html#ae351c8cc0971a7ce253a4ff6a93432eb">gemmi::cif::as_int</a></div><div class="ttdeci">int as_int(const std::string &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00108">cifdoc.hpp:108</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_ae94de270f749561556b3dfc7bae29a07"><div class="ttname"><a href="namespacegemmi_1_1cif.html#ae94de270f749561556b3dfc7bae29a07">gemmi::cif::char_table</a></div><div class="ttdeci">uint8_t char_table(char c)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00045">cifdoc.hpp:45</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_ae9563ed3b93cf5eef563eef894fc02ae"><div class="ttname"><a href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02ae">gemmi::cif::ItemType</a></div><div class="ttdeci">ItemType</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00037">cifdoc.hpp:37</a></div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_ae9563ed3b93cf5eef563eef894fc02aea0be8406951cdfda82f00f79328cf4efc"><div class="ttname"><a href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aea0be8406951cdfda82f00f79328cf4efc">gemmi::cif::ItemType::Comment</a></div><div class="ttdeci">@ Comment</div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_ae9563ed3b93cf5eef563eef894fc02aea3bb3e8c8a24891ba0f7608bcc96f8b0a"><div class="ttname"><a href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aea3bb3e8c8a24891ba0f7608bcc96f8b0a">gemmi::cif::ItemType::Frame</a></div><div class="ttdeci">@ Frame</div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_ae9563ed3b93cf5eef563eef894fc02aea89d7b10cb4238977d2b523dfd9ea7745"><div class="ttname"><a href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aea89d7b10cb4238977d2b523dfd9ea7745">gemmi::cif::ItemType::Loop</a></div><div class="ttdeci">@ Loop</div></div>
<div class="ttc" id="anamespacegemmi_1_1cif_html_ae9563ed3b93cf5eef563eef894fc02aeabf0adaf97ee2347ae783cc6d56f88d67"><div class="ttname"><a href="namespacegemmi_1_1cif.html#ae9563ed3b93cf5eef563eef894fc02aeabf0adaf97ee2347ae783cc6d56f88d67">gemmi::cif::ItemType::Erased</a></div><div class="ttdeci">@ Erased</div></div>
<div class="ttc" id="anamespacegemmi_html"><div class="ttname"><a href="namespacegemmi.html">gemmi</a></div><div class="ttdef"><b>Definition:</b> <a href="addends_8hpp_source.html#l00012">addends.hpp:12</a></div></div>
<div class="ttc" id="anamespacegemmi_html_a01c2cc6980a0a0de892990673670bbdc"><div class="ttname"><a href="namespacegemmi.html#a01c2cc6980a0a0de892990673670bbdc">gemmi::string_to_int</a></div><div class="ttdeci">int string_to_int(const char *p, bool checked, size_t length=0)</div><div class="ttdef"><b>Definition:</b> <a href="atox_8hpp_source.html#l00072">atox.hpp:72</a></div></div>
<div class="ttc" id="anamespacegemmi_html_a1808c5d66b441e4929a2b57ddc3de02f"><div class="ttname"><a href="namespacegemmi.html#a1808c5d66b441e4929a2b57ddc3de02f">gemmi::iequal_from</a></div><div class="ttdeci">bool iequal_from(const std::string &amp;str, size_t offset, const std::string &amp;low)</div><div class="ttdef"><b>Definition:</b> <a href="util_8hpp_source.html#l00083">util.hpp:83</a></div></div>
<div class="ttc" id="anamespacegemmi_html_a5391ca865c7447711216f37561fd46e0"><div class="ttname"><a href="namespacegemmi.html#a5391ca865c7447711216f37561fd46e0">gemmi::istarts_with</a></div><div class="ttdeci">bool istarts_with(const std::string &amp;str, const std::string &amp;prefix)</div><div class="ttdef"><b>Definition:</b> <a href="util_8hpp_source.html#l00089">util.hpp:89</a></div></div>
<div class="ttc" id="anamespacegemmi_html_a9a5a74956bcedb3ec9c30d42c56a2a9a"><div class="ttname"><a href="namespacegemmi.html#a9a5a74956bcedb3ec9c30d42c56a2a9a">gemmi::to_lower</a></div><div class="ttdeci">std::string to_lower(std::string str)</div><div class="ttdef"><b>Definition:</b> <a href="util_8hpp_source.html#l00061">util.hpp:61</a></div></div>
<div class="ttc" id="anamespacegemmi_html_aaf807db034551a77193cfb2ae2946e3a"><div class="ttname"><a href="namespacegemmi.html#aaf807db034551a77193cfb2ae2946e3a">gemmi::cat</a></div><div class="ttdeci">std::string cat(Args const &amp;... args)</div><div class="ttdef"><b>Definition:</b> <a href="util_8hpp_source.html#l00031">util.hpp:31</a></div></div>
<div class="ttc" id="anamespacegemmi_html_ac4b9324deb8e7200a8140399b6e40776"><div class="ttname"><a href="namespacegemmi.html#ac4b9324deb8e7200a8140399b6e40776">gemmi::starts_with</a></div><div class="ttdeci">bool starts_with(const std::string &amp;str, const std::string &amp;prefix)</div><div class="ttdef"><b>Definition:</b> <a href="util_8hpp_source.html#l00037">util.hpp:37</a></div></div>
<div class="ttc" id="anamespacegemmi_html_ace5bd65601f8e51653de63a7afa7f380"><div class="ttname"><a href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">gemmi::fail</a></div><div class="ttdeci">void fail(const std::string &amp;msg)</div><div class="ttdef"><b>Definition:</b> <a href="fail_8hpp_source.html#l00034">fail.hpp:34</a></div></div>
<div class="ttc" id="anamespacegemmi_html_aead2c8d05718c75005302bb96662d2ee"><div class="ttname"><a href="namespacegemmi.html#aead2c8d05718c75005302bb96662d2ee">gemmi::iequal</a></div><div class="ttdeci">bool iequal(const std::string &amp;str, const std::string &amp;low)</div><div class="ttdef"><b>Definition:</b> <a href="util_8hpp_source.html#l00077">util.hpp:77</a></div></div>
<div class="ttc" id="astructgemmi_1_1BidirIterator_html"><div class="ttname"><a href="structgemmi_1_1BidirIterator.html">gemmi::BidirIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="iterator_8hpp_source.html#l00023">iterator.hpp:23</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html">gemmi::cif::Block</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00403">cifdoc.hpp:403</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a00333a24f6cb59f35f6ee3a9175589d1"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a00333a24f6cb59f35f6ee3a9175589d1">gemmi::cif::Block::find_pair_item</a></div><div class="ttdeci">const Item * find_pair_item(const std::string &amp;tag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00760">cifdoc.hpp:760</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a073b8b3cabfe6796faafca2f571fbf2d"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a073b8b3cabfe6796faafca2f571fbf2d">gemmi::cif::Block::swap</a></div><div class="ttdeci">void swap(Block &amp;o)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00410">cifdoc.hpp:410</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a0ee2d3958f895a0b810977da3945a07b"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a0ee2d3958f895a0b810977da3945a07b">gemmi::cif::Block::move_item</a></div><div class="ttdeci">void move_item(int old_pos, int new_pos)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00832">cifdoc.hpp:832</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a13cf4a43729935f357aa46f2d9cf1f36"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a13cf4a43729935f357aa46f2d9cf1f36">gemmi::cif::Block::find_loop_item</a></div><div class="ttdeci">const Item * find_loop_item(const std::string &amp;tag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00778">cifdoc.hpp:778</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a1aaf2117ddfbe60c93d823300c17b18b"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a1aaf2117ddfbe60c93d823300c17b18b">gemmi::cif::Block::find</a></div><div class="ttdeci">Table find(const std::vector&lt; std::string &gt; &amp;tags)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00430">cifdoc.hpp:430</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a2ef7efc20e67043bcd9534c87352602a"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a2ef7efc20e67043bcd9534c87352602a">gemmi::cif::Block::find_values</a></div><div class="ttdeci">Column find_values(const std::string &amp;tag)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00786">cifdoc.hpp:786</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a396f695a8f7687e4455c721f0a370726"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a396f695a8f7687e4455c721f0a370726">gemmi::cif::Block::find_loop</a></div><div class="ttdeci">Column find_loop(const std::string &amp;tag)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00773">cifdoc.hpp:773</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a43d38511b5998211edc625205ab8d27b"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a43d38511b5998211edc625205ab8d27b">gemmi::cif::Block::find_any</a></div><div class="ttdeci">Table find_any(const std::string &amp;prefix, const std::vector&lt; std::string &gt; &amp;tags)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00937">cifdoc.hpp:937</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a4a8afb6ffc4cfabff41840c69ed4453c"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a4a8afb6ffc4cfabff41840c69ed4453c">gemmi::cif::Block::find_or_add</a></div><div class="ttdeci">Table find_or_add(const std::string &amp;prefix, std::vector&lt; std::string &gt; tags)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00433">cifdoc.hpp:433</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a568dd4077997b7289c7df413c4d13ac4"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a568dd4077997b7289c7df413c4d13ac4">gemmi::cif::Block::find</a></div><div class="ttdeci">Table find(const std::string &amp;prefix, const std::vector&lt; std::string &gt; &amp;tags)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00899">cifdoc.hpp:899</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a5dd89492b42634c8ff853ce45c7c2636"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a5dd89492b42634c8ff853ce45c7c2636">gemmi::cif::Block::items</a></div><div class="ttdeci">std::vector&lt; Item &gt; items</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00405">cifdoc.hpp:405</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a5edaccd6d044720bd2d12b6a7304f4a7"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a5edaccd6d044720bd2d12b6a7304f4a7">gemmi::cif::Block::set_pair</a></div><div class="ttdeci">void set_pair(const std::string &amp;tag, const std::string &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00828">cifdoc.hpp:828</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a65ea956a3d20b8790018cb1ec127c680"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a65ea956a3d20b8790018cb1ec127c680">gemmi::cif::Block::find_frame</a></div><div class="ttdeci">Block * find_frame(std::string name)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00800">cifdoc.hpp:800</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a7e34a1e8f968f978c283c8fb0eaeea5b"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a7e34a1e8f968f978c283c8fb0eaeea5b">gemmi::cif::Block::find_mmcif_category</a></div><div class="ttdeci">Table find_mmcif_category(std::string cat)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00963">cifdoc.hpp:963</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a85a7388aca241a1447f570566536b0e5"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a85a7388aca241a1447f570566536b0e5">gemmi::cif::Block::init_loop</a></div><div class="ttdeci">Loop &amp; init_loop(const std::string &amp;prefix, std::vector&lt; std::string &gt; tags)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00451">cifdoc.hpp:451</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a93d1353e0c4062cfbc6978eb0cf6568c"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a93d1353e0c4062cfbc6978eb0cf6568c">gemmi::cif::Block::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00404">cifdoc.hpp:404</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_a964e6f522c277c41a49222386178252a"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#a964e6f522c277c41a49222386178252a">gemmi::cif::Block::init_mmcif_loop</a></div><div class="ttdeci">Loop &amp; init_mmcif_loop(std::string cat, std::vector&lt; std::string &gt; tags)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00462">cifdoc.hpp:462</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_aafe8d4fdf5b92937e22b86627cf4dda7"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#aafe8d4fdf5b92937e22b86627cf4dda7">gemmi::cif::Block::find_value</a></div><div class="ttdeci">const std::string * find_value(const std::string &amp;tag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00414">cifdoc.hpp:414</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_aba108b1f87aae17a3ce1e8e291bc1768"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#aba108b1f87aae17a3ce1e8e291bc1768">gemmi::cif::Block::has_any_value</a></div><div class="ttdeci">bool has_any_value(const std::string &amp;tag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00424">cifdoc.hpp:424</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_acafcb469122cac440c4acfd335453072"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#acafcb469122cac440c4acfd335453072">gemmi::cif::Block::item_as_table</a></div><div class="ttdeci">Table item_as_table(Item &amp;item)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00808">cifdoc.hpp:808</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_acddcb8202a4ce1f21c4b817a7b1793b7"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#acddcb8202a4ce1f21c4b817a7b1793b7">gemmi::cif::Block::get_mmcif_category_names</a></div><div class="ttdeci">std::vector&lt; std::string &gt; get_mmcif_category_names() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00849">cifdoc.hpp:849</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_adf68f9e8e202ace7c4abc28649bfd9f5"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#adf68f9e8e202ace7c4abc28649bfd9f5">gemmi::cif::Block::find_pair</a></div><div class="ttdeci">const Pair * find_pair(const std::string &amp;tag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00768">cifdoc.hpp:768</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_ae466d627a6d9593dd708f8d7243b2d6c"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#ae466d627a6d9593dd708f8d7243b2d6c">gemmi::cif::Block::get_index</a></div><div class="ttdeci">size_t get_index(const std::string &amp;tag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00817">cifdoc.hpp:817</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_ae7d72791d4196e42ee83d04414fe53b1"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#ae7d72791d4196e42ee83d04414fe53b1">gemmi::cif::Block::has_tag</a></div><div class="ttdeci">bool has_tag(const std::string &amp;tag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00421">cifdoc.hpp:421</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_af0c81d1f62a86d15ce320dbeca102080"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#af0c81d1f62a86d15ce320dbeca102080">gemmi::cif::Block::Block</a></div><div class="ttdeci">Block(const std::string &amp;name_)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00407">cifdoc.hpp:407</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Block_html_af88afeff011d8dc9b1607179abf77d1f"><div class="ttname"><a href="structgemmi_1_1cif_1_1Block.html#af88afeff011d8dc9b1607179abf77d1f">gemmi::cif::Block::Block</a></div><div class="ttdeci">Block()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00408">cifdoc.hpp:408</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1CommentArg_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1CommentArg.html">gemmi::cif::CommentArg</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00126">cifdoc.hpp:126</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1CommentArg_html_a0393eceea9a8dc6eac2280930c1a7223"><div class="ttname"><a href="structgemmi_1_1cif_1_1CommentArg.html#a0393eceea9a8dc6eac2280930c1a7223">gemmi::cif::CommentArg::str</a></div><div class="ttdeci">std::string str</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00126">cifdoc.hpp:126</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Document_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1Document.html">gemmi::cif::Document</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00986">cifdoc.hpp:986</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Document_html_a116368c81dc33b94683517b4ad5657ee"><div class="ttname"><a href="structgemmi_1_1cif_1_1Document.html#a116368c81dc33b94683517b4ad5657ee">gemmi::cif::Document::clear</a></div><div class="ttdeci">void clear() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01001">cifdoc.hpp:1001</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Document_html_a2a020dab4b2eb8b5ad07330010bffcab"><div class="ttname"><a href="structgemmi_1_1cif_1_1Document.html#a2a020dab4b2eb8b5ad07330010bffcab">gemmi::cif::Document::sole_block</a></div><div class="ttdeci">const Block &amp; sole_block() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01013">cifdoc.hpp:1013</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Document_html_a3dc57b468e9c0b3f7f626d6a8a31baf6"><div class="ttname"><a href="structgemmi_1_1cif_1_1Document.html#a3dc57b468e9c0b3f7f626d6a8a31baf6">gemmi::cif::Document::find_block</a></div><div class="ttdeci">const Block * find_block(const std::string &amp;name) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01023">cifdoc.hpp:1023</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Document_html_a3ef2027e79d9753fb1b59c73e7750884"><div class="ttname"><a href="structgemmi_1_1cif_1_1Document.html#a3ef2027e79d9753fb1b59c73e7750884">gemmi::cif::Document::add_new_block</a></div><div class="ttdeci">Block &amp; add_new_block(const std::string &amp;name, int pos=-1)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00993">cifdoc.hpp:993</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Document_html_a6fdeabea98719143c0923028e447c4af"><div class="ttname"><a href="structgemmi_1_1cif_1_1Document.html#a6fdeabea98719143c0923028e447c4af">gemmi::cif::Document::source</a></div><div class="ttdeci">std::string source</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00987">cifdoc.hpp:987</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Document_html_a74fa720d77402fc5b9db729a15a239d5"><div class="ttname"><a href="structgemmi_1_1cif_1_1Document.html#a74fa720d77402fc5b9db729a15a239d5">gemmi::cif::Document::blocks</a></div><div class="ttdeci">std::vector&lt; Block &gt; blocks</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00988">cifdoc.hpp:988</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Document_html_ae0bee779cb8d22515bb534545e07ed29"><div class="ttname"><a href="structgemmi_1_1cif_1_1Document.html#ae0bee779cb8d22515bb534545e07ed29">gemmi::cif::Document::find_block</a></div><div class="ttdeci">Block * find_block(const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01017">cifdoc.hpp:1017</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Document_html_ae692ce3e2fab46ab0ec58b271017e82b"><div class="ttname"><a href="structgemmi_1_1cif_1_1Document.html#ae692ce3e2fab46ab0ec58b271017e82b">gemmi::cif::Document::sole_block</a></div><div class="ttdeci">Block &amp; sole_block()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l01008">cifdoc.hpp:1008</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1FrameArg_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1FrameArg.html">gemmi::cif::FrameArg</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00125">cifdoc.hpp:125</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1FrameArg_html_a180cb658aafa5d07e877f8c056f09600"><div class="ttname"><a href="structgemmi_1_1cif_1_1FrameArg.html#a180cb658aafa5d07e877f8c056f09600">gemmi::cif::FrameArg::str</a></div><div class="ttdeci">std::string str</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00125">cifdoc.hpp:125</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1ItemSpan_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1ItemSpan.html">gemmi::cif::ItemSpan</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00568">cifdoc.hpp:568</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1ItemSpan_html_ab7e1d40183e23f3e1893a6de3e9979b1"><div class="ttname"><a href="structgemmi_1_1cif_1_1ItemSpan.html#ab7e1d40183e23f3e1893a6de3e9979b1">gemmi::cif::ItemSpan::ItemSpan</a></div><div class="ttdeci">ItemSpan(std::vector&lt; Item &gt; &amp;items, std::string prefix)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00571">cifdoc.hpp:571</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1ItemSpan_html_acae94f2cf9922eb288ca1c2450617083"><div class="ttname"><a href="structgemmi_1_1cif_1_1ItemSpan.html#acae94f2cf9922eb288ca1c2450617083">gemmi::cif::ItemSpan::ItemSpan</a></div><div class="ttdeci">ItemSpan(std::vector&lt; Item &gt; &amp;items)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00569">cifdoc.hpp:569</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1ItemSpan_html_ade15a455596a9a60dfc8422cf0710c91"><div class="ttname"><a href="structgemmi_1_1cif_1_1ItemSpan.html#ade15a455596a9a60dfc8422cf0710c91">gemmi::cif::ItemSpan::set_pair</a></div><div class="ttdeci">void set_pair(const std::string &amp;tag, const std::string &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00581">cifdoc.hpp:581</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html">gemmi::cif::Item</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00475">cifdoc.hpp:475</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a05452ddacd1a1afc69982c73685d5f2d"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a05452ddacd1a1afc69982c73685d5f2d">gemmi::cif::Item::Item</a></div><div class="ttdeci">Item(const Item &amp;o)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00499">cifdoc.hpp:499</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a2dc8f28c95f2705471a34b12a40259a6"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a2dc8f28c95f2705471a34b12a40259a6">gemmi::cif::Item::Item</a></div><div class="ttdeci">Item(Item &amp;&amp;o) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00495">cifdoc.hpp:495</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a478811da0256c8d2913379da6def380a"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a478811da0256c8d2913379da6def380a">gemmi::cif::Item::Item</a></div><div class="ttdeci">Item(std::string &amp;&amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00486">cifdoc.hpp:486</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a4847a2c06ef7af0324fea423f1850326"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a4847a2c06ef7af0324fea423f1850326">gemmi::cif::Item::Item</a></div><div class="ttdeci">Item(FrameArg &amp;&amp;frame_arg)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00490">cifdoc.hpp:490</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a4bb7e0946ecf54b95cc9b62fd183f85f"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a4bb7e0946ecf54b95cc9b62fd183f85f">gemmi::cif::Item::Item</a></div><div class="ttdeci">Item(const std::string &amp;t, const std::string &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00488">cifdoc.hpp:488</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a5201b99fe65c301b1e1cc2c68afb550f"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a5201b99fe65c301b1e1cc2c68afb550f">gemmi::cif::Item::Item</a></div><div class="ttdeci">Item(CommentArg &amp;&amp;comment)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00492">cifdoc.hpp:492</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a5fba7dae1f126f62f2505b998211529e"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a5fba7dae1f126f62f2505b998211529e">gemmi::cif::Item::line_number</a></div><div class="ttdeci">int line_number</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00477">cifdoc.hpp:477</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a69fe3f2aa8d468d4b2db03efd078f40a"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a69fe3f2aa8d468d4b2db03efd078f40a">gemmi::cif::Item::set_value</a></div><div class="ttdeci">void set_value(Item &amp;&amp;o)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00520">cifdoc.hpp:520</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a6e0a564a9ae9307d135733a7ab64bd72"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a6e0a564a9ae9307d135733a7ab64bd72">gemmi::cif::Item::~Item</a></div><div class="ttdeci">~Item()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00506">cifdoc.hpp:506</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a6e27372e6c72890d0a9b8944ac12540a"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a6e27372e6c72890d0a9b8944ac12540a">gemmi::cif::Item::erase</a></div><div class="ttdeci">void erase()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00508">cifdoc.hpp:508</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a76e89fedc040cd87d174be78f3bf56c4"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a76e89fedc040cd87d174be78f3bf56c4">gemmi::cif::Item::loop</a></div><div class="ttdeci">Loop loop</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00480">cifdoc.hpp:480</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_a8dcc3181ca9606833092a54e07cdf770"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#a8dcc3181ca9606833092a54e07cdf770">gemmi::cif::Item::type</a></div><div class="ttdeci">ItemType type</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00476">cifdoc.hpp:476</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_aaf2ad346d5e89aa738d78b5c67b884e2"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#aaf2ad346d5e89aa738d78b5c67b884e2">gemmi::cif::Item::has_prefix</a></div><div class="ttdeci">bool has_prefix(const std::string &amp;prefix) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00514">cifdoc.hpp:514</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_acb557e587b2db18e858e5a4e05178542"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#acb557e587b2db18e858e5a4e05178542">gemmi::cif::Item::operator=</a></div><div class="ttdeci">Item &amp; operator=(Item o)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00504">cifdoc.hpp:504</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_ad06a3ea3906f75ab5eba19fab3a0a491"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#ad06a3ea3906f75ab5eba19fab3a0a491">gemmi::cif::Item::pair</a></div><div class="ttdeci">Pair pair</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00479">cifdoc.hpp:479</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_ad306c06efb04e5383c9b7862888dc8de"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#ad306c06efb04e5383c9b7862888dc8de">gemmi::cif::Item::frame</a></div><div class="ttdeci">Block frame</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00481">cifdoc.hpp:481</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Item_html_adae21a4083f94c9cc1f63eb1ad569f53"><div class="ttname"><a href="structgemmi_1_1cif_1_1Item.html#adae21a4083f94c9cc1f63eb1ad569f53">gemmi::cif::Item::Item</a></div><div class="ttdeci">Item(LoopArg)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00484">cifdoc.hpp:484</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1LoopArg_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1LoopArg.html">gemmi::cif::LoopArg</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00124">cifdoc.hpp:124</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html">gemmi::cif::Loop</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00128">cifdoc.hpp:128</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_a007f97a4dd16fd0b1580fc045cfdfe39"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#a007f97a4dd16fd0b1580fc045cfdfe39">gemmi::cif::Loop::add_comment_and_row</a></div><div class="ttdeci">void add_comment_and_row(std::initializer_list&lt; std::string &gt; ss)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00162">cifdoc.hpp:162</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_a255832b560c3334e158ef915ea69235e"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#a255832b560c3334e158ef915ea69235e">gemmi::cif::Loop::val</a></div><div class="ttdeci">const std::string &amp; val(size_t row, size_t col) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00144">cifdoc.hpp:144</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_a320c4a01c0cfa6ba13600ca58121f1eb"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#a320c4a01c0cfa6ba13600ca58121f1eb">gemmi::cif::Loop::width</a></div><div class="ttdeci">size_t width() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00142">cifdoc.hpp:142</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_a3341176041c4a0459215d5af990c2858"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#a3341176041c4a0459215d5af990c2858">gemmi::cif::Loop::find_tag</a></div><div class="ttdeci">int find_tag(const std::string &amp;tag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00138">cifdoc.hpp:138</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_a372e7164f0a9e8031d39ad36b2bc4255"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#a372e7164f0a9e8031d39ad36b2bc4255">gemmi::cif::Loop::tags</a></div><div class="ttdeci">std::vector&lt; std::string &gt; tags</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00129">cifdoc.hpp:129</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_a39aee24bac3ede0b0ed4effa998269ce"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#a39aee24bac3ede0b0ed4effa998269ce">gemmi::cif::Loop::values</a></div><div class="ttdeci">std::vector&lt; std::string &gt; values</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00130">cifdoc.hpp:130</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_a690bebc92bdf9fb316e1a25587359562"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#a690bebc92bdf9fb316e1a25587359562">gemmi::cif::Loop::length</a></div><div class="ttdeci">size_t length() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00143">cifdoc.hpp:143</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_aa19b65450432dd3a798734d090ac2fee"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#aa19b65450432dd3a798734d090ac2fee">gemmi::cif::Loop::set_all_values</a></div><div class="ttdeci">void set_all_values(std::vector&lt; std::vector&lt; std::string &gt; &gt; columns)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00605">cifdoc.hpp:605</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_aa80b90519ad9deefed29f05d648adf95"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#aa80b90519ad9deefed29f05d648adf95">gemmi::cif::Loop::pop_row</a></div><div class="ttdeci">void pop_row()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00169">cifdoc.hpp:169</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_ab234864dc26868ee7fc2026e2e306f8a"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#ab234864dc26868ee7fc2026e2e306f8a">gemmi::cif::Loop::add_row</a></div><div class="ttdeci">void add_row(T new_values, int pos=-1)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00150">cifdoc.hpp:150</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_ad0d680ae040fee59f3a8dc1729cebdf0"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#ad0d680ae040fee59f3a8dc1729cebdf0">gemmi::cif::Loop::move_row</a></div><div class="ttdeci">void move_row(int old_pos, int new_pos)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00176">cifdoc.hpp:176</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_ad39dd5d56b0b30cf441017325c35b0d2"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#ad39dd5d56b0b30cf441017325c35b0d2">gemmi::cif::Loop::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00148">cifdoc.hpp:148</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_ae7e666a463479aafb622cbe93477451d"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#ae7e666a463479aafb622cbe93477451d">gemmi::cif::Loop::has_tag</a></div><div class="ttdeci">bool has_tag(const std::string &amp;tag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00141">cifdoc.hpp:141</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_ae939de430a2e2e4bfe10c716e4fe6496"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#ae939de430a2e2e4bfe10c716e4fe6496">gemmi::cif::Loop::find_tag_lc</a></div><div class="ttdeci">int find_tag_lc(const std::string &amp;lctag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00133">cifdoc.hpp:133</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Loop_html_af6fe1b04e0b46b244a80fef1008545be"><div class="ttname"><a href="structgemmi_1_1cif_1_1Loop.html#af6fe1b04e0b46b244a80fef1008545be">gemmi::cif::Loop::add_row</a></div><div class="ttdeci">void add_row(std::initializer_list&lt; std::string &gt; new_values, int pos=-1)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00158">cifdoc.hpp:158</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html">gemmi::cif::Table::Row</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00249">cifdoc.hpp:249</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a00c6f4fb163e866091e4fa3b82575681"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a00c6f4fb163e866091e4fa3b82575681">gemmi::cif::Table::Row::row_index</a></div><div class="ttdeci">int row_index</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00251">cifdoc.hpp:251</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a0597071bbebf317349ee8da64c27cd41"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a0597071bbebf317349ee8da64c27cd41">gemmi::cif::Table::Row::at</a></div><div class="ttdeci">std::string &amp; at(int n)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00263">cifdoc.hpp:263</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a113154637597fe029068bb30cb1d981c"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a113154637597fe029068bb30cb1d981c">gemmi::cif::Table::Row::operator[]</a></div><div class="ttdeci">const std::string &amp; operator[](size_t n) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00269">cifdoc.hpp:269</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a169533c1696ec1f97823aa100eaf7f39"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a169533c1696ec1f97823aa100eaf7f39">gemmi::cif::Table::Row::ptr_at</a></div><div class="ttdeci">std::string * ptr_at(int n)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00273">cifdoc.hpp:273</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a1a7055034001d9364cd4850711d05f1d"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a1a7055034001d9364cd4850711d05f1d">gemmi::cif::Table::Row::const_iterator</a></div><div class="ttdeci">IndirectIter&lt; const Row, const std::string &gt; const_iterator</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00298">cifdoc.hpp:298</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a1be26d0c808f1834a65a23bdca6222d1"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a1be26d0c808f1834a65a23bdca6222d1">gemmi::cif::Table::Row::str</a></div><div class="ttdeci">std::string str(int n) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00295">cifdoc.hpp:295</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a3511c0e10191f6eb5d14a91d78bd76db"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a3511c0e10191f6eb5d14a91d78bd76db">gemmi::cif::Table::Row::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00300">cifdoc.hpp:300</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a395f60c3f73a231d566b80af555b3a95"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a395f60c3f73a231d566b80af555b3a95">gemmi::cif::Table::Row::tab</a></div><div class="ttdeci">Table &amp; tab</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00250">cifdoc.hpp:250</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a51d7094a7ff29c01eff8cd334fe9b648"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a51d7094a7ff29c01eff8cd334fe9b648">gemmi::cif::Table::Row::one_of</a></div><div class="ttdeci">const std::string &amp; one_of(size_t n1, size_t n2) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00284">cifdoc.hpp:284</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a545b1140586fd5e54100a0910fbedd01"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a545b1140586fd5e54100a0910fbedd01">gemmi::cif::Table::Row::has2</a></div><div class="ttdeci">bool has2(size_t n) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00282">cifdoc.hpp:282</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a62a376825fd737a07ccc6cea350b6457"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a62a376825fd737a07ccc6cea350b6457">gemmi::cif::Table::Row::iterator</a></div><div class="ttdeci">IndirectIter&lt; Row, std::string &gt; iterator</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00297">cifdoc.hpp:297</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a67d2d0475934eef7a77ee984cda11678"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a67d2d0475934eef7a77ee984cda11678">gemmi::cif::Table::Row::ptr_at</a></div><div class="ttdeci">const std::string * ptr_at(int n) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00277">cifdoc.hpp:277</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_a82da74897383323f445acbd0417d9853"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#a82da74897383323f445acbd0417d9853">gemmi::cif::Table::Row::operator[]</a></div><div class="ttdeci">std::string &amp; operator[](size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00655">cifdoc.hpp:655</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_aa083f5655e7b554879efa77a4520ba79"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#aa083f5655e7b554879efa77a4520ba79">gemmi::cif::Table::Row::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00299">cifdoc.hpp:299</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_aa21a19ebdece30c5f9391d5a134ceda0"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#aa21a19ebdece30c5f9391d5a134ceda0">gemmi::cif::Table::Row::value_at</a></div><div class="ttdeci">std::string &amp; value_at(int pos)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00254">cifdoc.hpp:254</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_ab8e28ce4f77e44950e58345db368af1c"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#ab8e28ce4f77e44950e58345db368af1c">gemmi::cif::Table::Row::end</a></div><div class="ttdeci">const_iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00304">cifdoc.hpp:304</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_abe0ad18773b53e1aeea9ee072f47147c"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#abe0ad18773b53e1aeea9ee072f47147c">gemmi::cif::Table::Row::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00293">cifdoc.hpp:293</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_ac70b4e80f2faf68025af5e93770b8c9b"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#ac70b4e80f2faf68025af5e93770b8c9b">gemmi::cif::Table::Row::begin</a></div><div class="ttdeci">const_iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00301">cifdoc.hpp:301</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_ae799a1786110c99b82d165ad4c2795ce"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#ae799a1786110c99b82d165ad4c2795ce">gemmi::cif::Table::Row::at</a></div><div class="ttdeci">const std::string &amp; at(int n) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00266">cifdoc.hpp:266</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_ae81c5be7f6e3fa5cfe036d40224d82e3"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#ae81c5be7f6e3fa5cfe036d40224d82e3">gemmi::cif::Table::Row::has</a></div><div class="ttdeci">bool has(size_t n) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00281">cifdoc.hpp:281</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_af58e638c372765bb6c07523ad7e781b1"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#af58e638c372765bb6c07523ad7e781b1">gemmi::cif::Table::Row::value_at_unsafe</a></div><div class="ttdeci">std::string &amp; value_at_unsafe(int pos)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00665">cifdoc.hpp:665</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1Row_html_af67317045d8133fcd43716afc0abbf27"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1Row.html#af67317045d8133fcd43716afc0abbf27">gemmi::cif::Table::Row::value_at</a></div><div class="ttdeci">const std::string &amp; value_at(int pos) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00259">cifdoc.hpp:259</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1iterator_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1iterator.html">gemmi::cif::Table::iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00389">cifdoc.hpp:389</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1iterator_html_a0142bda6e4d622350f407056dde86e74"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a0142bda6e4d622350f407056dde86e74">gemmi::cif::Table::iterator::operator!=</a></div><div class="ttdeci">bool operator!=(const iterator &amp;o) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00394">cifdoc.hpp:394</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1iterator_html_a089810ae18693059fa24183a22b9cc74"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a089810ae18693059fa24183a22b9cc74">gemmi::cif::Table::iterator::operator==</a></div><div class="ttdeci">bool operator==(const iterator &amp;o) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00393">cifdoc.hpp:393</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1iterator_html_a2517becaa21bffc9c5f8aeeb6e53ba28"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a2517becaa21bffc9c5f8aeeb6e53ba28">gemmi::cif::Table::iterator::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00391">cifdoc.hpp:391</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1iterator_html_a4a0bf498f9fa64859af419c0a3abbbd9"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a4a0bf498f9fa64859af419c0a3abbbd9">gemmi::cif::Table::iterator::get</a></div><div class="ttdeci">const std::string &amp; get(int n) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00396">cifdoc.hpp:396</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1iterator_html_a4ac1f871a0e65f101e2f7d1df97a59ff"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1iterator.html#a4ac1f871a0e65f101e2f7d1df97a59ff">gemmi::cif::Table::iterator::parent</a></div><div class="ttdeci">Table &amp; parent</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00390">cifdoc.hpp:390</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1iterator_html_aaa443e38bf8a831c59262ca234566c2d"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1iterator.html#aaa443e38bf8a831c59262ca234566c2d">gemmi::cif::Table::iterator::operator*</a></div><div class="ttdeci">Row operator*()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00395">cifdoc.hpp:395</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_1_1iterator_html_ab522475839d89dc82c2cb35e7110018a"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table_1_1iterator.html#ab522475839d89dc82c2cb35e7110018a">gemmi::cif::Table::iterator::operator++</a></div><div class="ttdeci">void operator++()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00392">cifdoc.hpp:392</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html">gemmi::cif::Table</a></div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00243">cifdoc.hpp:243</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a16828ef9326093d84cef338aa60fae31"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a16828ef9326093d84cef338aa60fae31">gemmi::cif::Table::at_check</a></div><div class="ttdeci">void at_check(int &amp;n)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00319">cifdoc.hpp:319</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a18be5ff8b0e2e75d72127dc971cbf6aa"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a18be5ff8b0e2e75d72127dc971cbf6aa">gemmi::cif::Table::prefix_length</a></div><div class="ttdeci">size_t prefix_length</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00247">cifdoc.hpp:247</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a268bbd57839505ff43785ef48e2d87c7"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a268bbd57839505ff43785ef48e2d87c7">gemmi::cif::Table::move_row</a></div><div class="ttdeci">void move_row(int old_pos, int new_pos)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00360">cifdoc.hpp:360</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a3807b76b940395794e72edd5bb9cf88d"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a3807b76b940395794e72edd5bb9cf88d">gemmi::cif::Table::tags</a></div><div class="ttdeci">Row tags()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00316">cifdoc.hpp:316</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a4571fd6a2f616cc0ff0db20ad92461df"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a4571fd6a2f616cc0ff0db20ad92461df">gemmi::cif::Table::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00313">cifdoc.hpp:313</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a47b611927fa1bbbee834eb575f8e1dcc"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a47b611927fa1bbbee834eb575f8e1dcc">gemmi::cif::Table::positions</a></div><div class="ttdeci">std::vector&lt; int &gt; positions</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00246">cifdoc.hpp:246</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a485d31a03425797da1a84d4ea4ec5023"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a485d31a03425797da1a84d4ea4ec5023">gemmi::cif::Table::append_row</a></div><div class="ttdeci">void append_row(T new_values)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00697">cifdoc.hpp:697</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a5c35d16ecfab5519064c577b402bb591"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a5c35d16ecfab5519064c577b402bb591">gemmi::cif::Table::width</a></div><div class="ttdeci">size_t width() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00311">cifdoc.hpp:311</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a5cfd1449bcadbcd760c23bd17d3c00fb"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a5cfd1449bcadbcd760c23bd17d3c00fb">gemmi::cif::Table::loop_item</a></div><div class="ttdeci">Item * loop_item</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00244">cifdoc.hpp:244</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a6d3aa12e65771350226ef43a2924eba7"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a6d3aa12e65771350226ef43a2924eba7">gemmi::cif::Table::has_column</a></div><div class="ttdeci">bool has_column(int n) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00314">cifdoc.hpp:314</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a71a2553a76fc2115c800f7aa7bcdbd68"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a71a2553a76fc2115c800f7aa7bcdbd68">gemmi::cif::Table::get_prefix</a></div><div class="ttdeci">std::string get_prefix() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00336">cifdoc.hpp:336</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a7d8937b5ff9f061d1b31175825f69ee6"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a7d8937b5ff9f061d1b31175825f69ee6">gemmi::cif::Table::find_column_position</a></div><div class="ttdeci">int find_column_position(const std::string &amp;tag) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00368">cifdoc.hpp:368</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a7d96586afcf1306c81355e8bfa244985"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a7d96586afcf1306c81355e8bfa244985">gemmi::cif::Table::find_row</a></div><div class="ttdeci">Row find_row(const std::string &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00685">cifdoc.hpp:685</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a80a82015ca4b36dd9b0d21b4228343e9"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a80a82015ca4b36dd9b0d21b4228343e9">gemmi::cif::Table::length</a></div><div class="ttdeci">size_t length() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00681">cifdoc.hpp:681</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a89767fc8f8c27b256f920e30cf483dfb"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a89767fc8f8c27b256f920e30cf483dfb">gemmi::cif::Table::erase</a></div><div class="ttdeci">void erase()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00733">cifdoc.hpp:733</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a9229b310944fb1718b663413e927efb7"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a9229b310944fb1718b663413e927efb7">gemmi::cif::Table::ok</a></div><div class="ttdeci">bool ok() const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00310">cifdoc.hpp:310</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a929aff40819b7188aed5f4a53fe3e781"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a929aff40819b7188aed5f4a53fe3e781">gemmi::cif::Table::one</a></div><div class="ttdeci">Row one()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00330">cifdoc.hpp:330</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a9c1f54447ecfe3fa73fa37ef50a7e733"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a9c1f54447ecfe3fa73fa37ef50a7e733">gemmi::cif::Table::bloc</a></div><div class="ttdeci">Block &amp; bloc</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00245">cifdoc.hpp:245</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_a9d3b5b27c6403defce0dd5b40bda950a"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#a9d3b5b27c6403defce0dd5b40bda950a">gemmi::cif::Table::find_column</a></div><div class="ttdeci">Column find_column(const std::string &amp;tag)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00380">cifdoc.hpp:380</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_aa49e4addc7f5b4edfc23fd228e6bbd2b"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#aa49e4addc7f5b4edfc23fd228e6bbd2b">gemmi::cif::Table::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00399">cifdoc.hpp:399</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_aa83b537d20667c348cec5c3a5007cc26"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#aa83b537d20667c348cec5c3a5007cc26">gemmi::cif::Table::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00398">cifdoc.hpp:398</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_ab4c9dc52fc64c0af8063962fddc77d32"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#ab4c9dc52fc64c0af8063962fddc77d32">gemmi::cif::Table::at</a></div><div class="ttdeci">Row at(int n)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00325">cifdoc.hpp:325</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_abf4bc7fad9eac00d90e2eac9251d935e"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#abf4bc7fad9eac00d90e2eac9251d935e">gemmi::cif::Table::convert_pair_to_loop</a></div><div class="ttdeci">void convert_pair_to_loop()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00745">cifdoc.hpp:745</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_ac38b46623345a5298e1975e548d97fe9"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#ac38b46623345a5298e1975e548d97fe9">gemmi::cif::Table::append_row</a></div><div class="ttdeci">void append_row(std::initializer_list&lt; std::string &gt; new_values)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00347">cifdoc.hpp:347</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_aca8f0bc9d096b8d6bffe9b9c9d77028e"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#aca8f0bc9d096b8d6bffe9b9c9d77028e">gemmi::cif::Table::remove_row</a></div><div class="ttdeci">void remove_row(int row_index)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00350">cifdoc.hpp:350</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_ad1c24a3047902ae634a67f84f450ad43"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#ad1c24a3047902ae634a67f84f450ad43">gemmi::cif::Table::operator[]</a></div><div class="ttdeci">Row operator[](int n)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00317">cifdoc.hpp:317</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_ad836773214773ffb8490d62503985b13"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#ad836773214773ffb8490d62503985b13">gemmi::cif::Table::get_loop</a></div><div class="ttdeci">Loop * get_loop()</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00677">cifdoc.hpp:677</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_aebfef31bd498ae340e1eea5b4ecc8fdf"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#aebfef31bd498ae340e1eea5b4ecc8fdf">gemmi::cif::Table::remove_rows</a></div><div class="ttdeci">void remove_rows(int start, int end)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00712">cifdoc.hpp:712</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_aed8ba04cf6d05b191496f46277c7215a"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#aed8ba04cf6d05b191496f46277c7215a">gemmi::cif::Table::first_of</a></div><div class="ttdeci">int first_of(int n1, int n2) const</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00315">cifdoc.hpp:315</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_af4fb8f34e769249aa678d5b8f916d7b0"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#af4fb8f34e769249aa678d5b8f916d7b0">gemmi::cif::Table::column_at_pos</a></div><div class="ttdeci">Column column_at_pos(int pos)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00727">cifdoc.hpp:727</a></div></div>
<div class="ttc" id="astructgemmi_1_1cif_1_1Table_html_afe6726fb3b427da6bace581e358c6357"><div class="ttname"><a href="structgemmi_1_1cif_1_1Table.html#afe6726fb3b427da6bace581e358c6357">gemmi::cif::Table::column</a></div><div class="ttdeci">Column column(int n)</div><div class="ttdef"><b>Definition:</b> <a href="cifdoc_8hpp_source.html#l00353">cifdoc.hpp:353</a></div></div>
<div class="ttc" id="autil_8hpp_html"><div class="ttname"><a href="util_8hpp.html">util.hpp</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
