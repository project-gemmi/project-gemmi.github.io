<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gemmi C++ API: include/gemmi/solmask.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Gemmi C++ API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_97b7d6895b0e578738d3a33b6e429156.html">gemmi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">solmask.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="solmask_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Copyright 2021 Global Phasing Ltd.</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// Flat bulk solvent mask. With helper tools that modify data on grid.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#ifndef GEMMI_SOLMASK_HPP_</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#define GEMMI_SOLMASK_HPP_</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &quot;<a class="code" href="grid_8hpp.html">grid.hpp</a>&quot;</span>      <span class="comment">// for Grid</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &quot;<a class="code" href="floodfill_8hpp.html">floodfill.hpp</a>&quot;</span> <span class="comment">// for FloodFill</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &quot;<a class="code" href="model_8hpp.html">model.hpp</a>&quot;</span>     <span class="comment">// for Model, Atom, ...</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacegemmi.html">gemmi</a> {</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno"><a class="line" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700">   14</a></span><span class="keyword">enum class</span> <a class="code hl_enumeration" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700">AtomicRadiiSet</a> { <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700ac046eb74b3a7039a3814e202f3de33ed">VanDerWaals</a>, <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700a2ddc9e3f17539ab413109c3a54b9e4cc">Cctbx</a>, <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700a1867bb6edc5eaf2b28b4553b28307e9e">Refmac</a>, <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700acb17869fe51048b5a5c4c6106551a255">Constant</a> };</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">// data from cctbx/eltbx/van_der_waals_radii.py used to generate identical mask</span></div>
<div class="foldopen" id="foldopen00017" data-start="{" data-end="}">
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno"><a class="line" href="namespacegemmi.html#a7b4551085e2416e8e93fe486333990ab">   17</a></span><span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="namespacegemmi.html#a7b4551085e2416e8e93fe486333990ab">cctbx_vdw_radius</a>(<a class="code hl_enumeration" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5">El</a> el) {</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> radii[] = {</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    <span class="comment">/*X*/</span>  1.00f,</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    <span class="comment">/*H*/</span>  1.20f, <span class="comment">/*He*/</span> 1.40f,</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>    <span class="comment">/*Li*/</span> 1.82f, <span class="comment">/*Be*/</span> 0.63f, <span class="comment">/*B*/</span>  1.75f, <span class="comment">/*C*/</span> 1.775f, <span class="comment">/*N*/</span> 1.50f,</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    <span class="comment">/*O*/</span>  1.45f, <span class="comment">/*F*/</span>  1.47f, <span class="comment">/*Ne*/</span> 1.54f,</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    <span class="comment">/*Na*/</span> 2.27f, <span class="comment">/*Mg*/</span> 1.73f, <span class="comment">/*Al*/</span> 1.50f, <span class="comment">/*Si*/</span> 2.10f, <span class="comment">/*P*/</span> 1.90f,</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    <span class="comment">/*S*/</span>  1.80f, <span class="comment">/*Cl*/</span> 1.75f, <span class="comment">/*Ar*/</span> 1.88f,</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    <span class="comment">/*K*/</span>  2.75f, <span class="comment">/*Ca*/</span> 1.95f, <span class="comment">/*Sc*/</span> 1.32f, <span class="comment">/*Ti*/</span> 1.95f, <span class="comment">/*V*/</span>  1.06f,</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    <span class="comment">/*Cr*/</span> 1.13f, <span class="comment">/*Mn*/</span> 1.19f, <span class="comment">/*Fe*/</span> 1.26f, <span class="comment">/*Co*/</span> 1.13f, <span class="comment">/*Ni*/</span> 1.63f,</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    <span class="comment">/*Cu*/</span> 1.40f, <span class="comment">/*Zn*/</span> 1.39f, <span class="comment">/*Ga*/</span> 1.87f, <span class="comment">/*Ge*/</span> 1.48f, <span class="comment">/*As*/</span> 0.83f,</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    <span class="comment">/*Se*/</span> 1.90f, <span class="comment">/*Br*/</span> 1.85f, <span class="comment">/*Kr*/</span> 2.02f,</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    <span class="comment">/*Rb*/</span> 2.65f, <span class="comment">/*Sr*/</span> 2.02f, <span class="comment">/*Y*/</span>  1.61f, <span class="comment">/*Zr*/</span> 1.42f, <span class="comment">/*Nb*/</span> 1.33f,</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    <span class="comment">/*Mo*/</span> 1.75f, <span class="comment">/*Tc*/</span> 2.00f, <span class="comment">/*Ru*/</span> 1.20f, <span class="comment">/*Rh*/</span> 1.22f, <span class="comment">/*Pd*/</span> 1.63f,</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    <span class="comment">/*Ag*/</span> 1.72f, <span class="comment">/*Cd*/</span> 1.58f, <span class="comment">/*In*/</span> 1.93f, <span class="comment">/*Sn*/</span> 2.17f, <span class="comment">/*Sb*/</span> 1.12f,</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>    <span class="comment">/*Te*/</span> 1.26f, <span class="comment">/*I*/</span>  1.98f, <span class="comment">/*Xe*/</span> 2.16f,</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    <span class="comment">/*Cs*/</span> 3.01f, <span class="comment">/*Ba*/</span> 2.41f, <span class="comment">/*La*/</span> 1.83f, <span class="comment">/*Ce*/</span> 1.86f, <span class="comment">/*Pr*/</span> 1.62f,</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    <span class="comment">/*Nd*/</span> 1.79f, <span class="comment">/*Pm*/</span> 1.76f, <span class="comment">/*Sm*/</span> 1.74f, <span class="comment">/*Eu*/</span> 1.96f, <span class="comment">/*Gd*/</span> 1.69f,</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    <span class="comment">/*Tb*/</span> 1.66f, <span class="comment">/*Dy*/</span> 1.63f, <span class="comment">/*Ho*/</span> 1.61f, <span class="comment">/*Er*/</span> 1.59f, <span class="comment">/*Tm*/</span> 1.57f,</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    <span class="comment">/*Yb*/</span> 1.54f, <span class="comment">/*Lu*/</span> 1.53f, <span class="comment">/*Hf*/</span> 1.40f, <span class="comment">/*Ta*/</span> 1.22f, <span class="comment">/*W*/</span>  1.26f,</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>    <span class="comment">/*Re*/</span> 1.30f, <span class="comment">/*Os*/</span> 1.58f, <span class="comment">/*Ir*/</span> 1.22f, <span class="comment">/*Pt*/</span> 1.72f, <span class="comment">/*Au*/</span> 1.66f,</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    <span class="comment">/*Hg*/</span> 1.55f, <span class="comment">/*Tl*/</span> 1.96f, <span class="comment">/*Pb*/</span> 2.02f, <span class="comment">/*Bi*/</span> 1.73f, <span class="comment">/*Po*/</span> 1.21f,</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    <span class="comment">/*At*/</span> 1.12f, <span class="comment">/*Rn*/</span> 2.30f,</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    <span class="comment">/*Fr*/</span> 3.24f, <span class="comment">/*Ra*/</span> 2.57f, <span class="comment">/*Ac*/</span> 2.12f, <span class="comment">/*Th*/</span> 1.84f, <span class="comment">/*Pa*/</span> 1.60f,</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    <span class="comment">/*U*/</span>  1.75f, <span class="comment">/*Np*/</span> 1.71f, <span class="comment">/*Pu*/</span> 1.67f, <span class="comment">/*Am*/</span> 1.66f, <span class="comment">/*Cm*/</span> 1.65f,</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    <span class="comment">/*Bk*/</span> 1.64f, <span class="comment">/*Cf*/</span> 1.63f, <span class="comment">/*Es*/</span> 1.62f, <span class="comment">/*Fm*/</span> 1.61f, <span class="comment">/*Md*/</span> 1.60f,</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="comment">/*No*/</span> 1.59f, <span class="comment">/*Lr*/</span> 1.58f, <span class="comment">/*Rf*/</span> 1.00f, <span class="comment">/*Db*/</span> 1.00f, <span class="comment">/*Sg*/</span> 1.00f,</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    <span class="comment">/*Bh*/</span> 1.00f, <span class="comment">/*Hs*/</span> 1.00f, <span class="comment">/*Mt*/</span> 1.00f, <span class="comment">/*Ds*/</span> 1.00f, <span class="comment">/*Rg*/</span> 1.00f,</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    <span class="comment">/*Cn*/</span> 1.00f, <span class="comment">/*Nh*/</span> 1.00f, <span class="comment">/*Fl*/</span> 1.00f, <span class="comment">/*Mc*/</span> 1.00f, <span class="comment">/*Lv*/</span> 1.00f,</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    <span class="comment">/*Ts*/</span> 1.00f, <span class="comment">/*Og*/</span> 1.00f,</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="comment">/*D*/</span>  1.20f, <span class="comment">/*END*/</span>0.f</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>  };</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>  <span class="keyword">static_assert</span>(<a class="code hl_function" href="namespacegemmi.html#a3f62254153177c2dc47654c00525006a">ce_almost_eq</a>(radii[<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5af623e75af30e62bbd73d6df5b50bb7b5">El::D</a>)], 1.2f), <span class="stringliteral">&quot;Hmm&quot;</span>);</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  <span class="keyword">static_assert</span>(<span class="keyword">sizeof</span>(radii) / <span class="keyword">sizeof</span>(radii[0]) ==</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5ab1a326c06d88bf042f73d70f50197905">El::END</a>) + 1, <span class="stringliteral">&quot;Hmm&quot;</span>);</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>  <span class="keywordflow">return</span> radii[<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(el)];</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>}</div>
</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span> </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="comment">// Data from Refmac&#39;s ener_lib.cif: ionic radius - 0.2A or vdW radius + 0.2A.</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="comment">// For full compatibility use r_probe=1.0A and r_shrink=0.8A.</span></div>
<div class="foldopen" id="foldopen00057" data-start="{" data-end="}">
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="namespacegemmi.html#ae01d979f5f2e15e9d9926359729f8487">   57</a></span><span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="namespacegemmi.html#ae01d979f5f2e15e9d9926359729f8487">refmac_radius_for_bulk_solvent</a>(<a class="code hl_enumeration" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5">El</a> el) {</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#if 0</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> radii[] = {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="comment">/*X*/</span>  1.00f,</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="comment">/*H*/</span>  1.40f, <span class="comment">/*He*/</span> 1.60f,</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="comment">/*Li*/</span> 0.53f, <span class="comment">/*Be*/</span> 0.21f, <span class="comment">/*B*/</span>  0.05f, <span class="comment">/*C*/</span>  1.90f, <span class="comment">/*N*/</span>  1.12f,</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="comment">/*O*/</span>  1.08f, <span class="comment">/*F*/</span>  0.99f, <span class="comment">/*Ne*/</span> 0.92f,</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    <span class="comment">/*Na*/</span> 0.93f, <span class="comment">/*Mg*/</span> 0.51f, <span class="comment">/*Al*/</span> 0.33f, <span class="comment">/*Si*/</span> 0.20f, <span class="comment">/*P*/</span>  0.39f,</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="comment">/*S*/</span>  0.20f, <span class="comment">/*Cl*/</span> 1.47f, <span class="comment">/*Ar*/</span> 1.34f,</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="comment">/*K*/</span>  1.31f, <span class="comment">/*Ca*/</span> 0.94f, <span class="comment">/*Sc*/</span> 0.69f, <span class="comment">/*Ti*/</span> 0.36f, <span class="comment">/*V*/</span>  0.48f,</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="comment">/*Cr*/</span> 0.33f, <span class="comment">/*Mn*/</span> 0.26f, <span class="comment">/*Fe*/</span> 0.48f, <span class="comment">/*Co*/</span> 0.34f, <span class="comment">/*Ni*/</span> 0.43f,</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="comment">/*Cu*/</span> 0.51f, <span class="comment">/*Zn*/</span> 0.54f, <span class="comment">/*Ga*/</span> 0.41f, <span class="comment">/*Ge*/</span> 0.20f, <span class="comment">/*As*/</span> 0.28f,</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <span class="comment">/*Se*/</span> 0.22f, <span class="comment">/*Br*/</span> 0.53f, <span class="comment">/*Kr*/</span> 1.49f,</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <span class="comment">/*Rb*/</span> 1.28f, <span class="comment">/*Sr*/</span> 1.12f, <span class="comment">/*Y*/</span>  0.84f, <span class="comment">/*Zr*/</span> 0.53f, <span class="comment">/*Nb*/</span> 0.42f,</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    <span class="comment">/*Mo*/</span> 0.35f, <span class="comment">/*Tc*/</span> 0.31f, <span class="comment">/*Ru*/</span> 0.32f, <span class="comment">/*Rh*/</span> 0.49f, <span class="comment">/*Pd*/</span> 0.58f,</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    <span class="comment">/*Ag*/</span> 0.61f, <span class="comment">/*Cd*/</span> 0.72f, <span class="comment">/*In*/</span> 0.56f, <span class="comment">/*Sn*/</span> 0.49f, <span class="comment">/*Sb*/</span> 0.70f,</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="comment">/*Te*/</span> 0.37f, <span class="comment">/*I*/</span>  0.36f, <span class="comment">/*Xe*/</span> 1.70f,</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <span class="comment">/*Cs*/</span> 1.61f, <span class="comment">/*Ba*/</span> 1.29f, <span class="comment">/*La*/</span> 0.97f, <span class="comment">/*Ce*/</span> 0.81f, <span class="comment">/*Pr*/</span> 0.79f,</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    <span class="comment">/*Nd*/</span> 0.92f, <span class="comment">/*Pm*/</span> 0.91f, <span class="comment">/*Sm*/</span> 0.90f, <span class="comment">/*Eu*/</span> 0.89f, <span class="comment">/*Gd*/</span> 0.88f,</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <span class="comment">/*Tb*/</span> 0.70f, <span class="comment">/*Dy*/</span> 0.85f, <span class="comment">/*Ho*/</span> 0.84f, <span class="comment">/*Er*/</span> 0.83f, <span class="comment">/*Tm*/</span> 0.82f,</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    <span class="comment">/*Yb*/</span> 0.81f, <span class="comment">/*Lu*/</span> 0.80f, <span class="comment">/*Hf*/</span> 0.52f, <span class="comment">/*Ta*/</span> 0.58f, <span class="comment">/*W*/</span>  0.36f,</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    <span class="comment">/*Re*/</span> 0.32f, <span class="comment">/*Os*/</span> 0.33f, <span class="comment">/*Ir*/</span> 0.51f, <span class="comment">/*Pt*/</span> 0.51f, <span class="comment">/*Au*/</span> 0.51f,</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    <span class="comment">/*Hg*/</span> 0.90f, <span class="comment">/*Tl*/</span> 0.69f, <span class="comment">/*Pb*/</span> 0.59f, <span class="comment">/*Bi*/</span> 0.70f, <span class="comment">/*Po*/</span> 0.61f,</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="comment">/*At*/</span> 0.56f, <span class="comment">/*Rn*/</span> 1.80f,</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="comment">/*Fr*/</span> 1.74f, <span class="comment">/*Ra*/</span> 1.42f, <span class="comment">/*Ac*/</span> 1.06f, <span class="comment">/*Th*/</span> 0.88f, <span class="comment">/*Pa*/</span> 0.72f,</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="comment">/*U*/</span>  0.46f, <span class="comment">/*Np*/</span> 0.65f, <span class="comment">/*Pu*/</span> 0.65f, <span class="comment">/*Am*/</span> 0.79f, <span class="comment">/*Cm*/</span> 0.79f,</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <span class="comment">/*Bk*/</span> 0.77f, <span class="comment">/*Cf*/</span> 0.76f, <span class="comment">/*Es*/</span> 1.00f, <span class="comment">/*Fm*/</span> 1.00f, <span class="comment">/*Md*/</span> 1.00f,</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="comment">/*No*/</span> 1.00f, <span class="comment">/*Lr*/</span> 1.00f, <span class="comment">/*Rf*/</span> 1.00f, <span class="comment">/*Db*/</span> 1.00f, <span class="comment">/*Sg*/</span> 1.00f,</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="comment">/*Bh*/</span> 1.00f, <span class="comment">/*Hs*/</span> 1.00f, <span class="comment">/*Mt*/</span> 1.00f, <span class="comment">/*Ds*/</span> 1.00f, <span class="comment">/*Rg*/</span> 1.00f,</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="comment">/*Cn*/</span> 1.00f, <span class="comment">/*Nh*/</span> 1.00f, <span class="comment">/*Fl*/</span> 1.00f, <span class="comment">/*Mc*/</span> 1.00f, <span class="comment">/*Lv*/</span> 1.00f,</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <span class="comment">/*Ts*/</span> 1.00f, <span class="comment">/*Og*/</span> 1.00f,</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <span class="comment">/*D*/</span>  1.40f, <span class="comment">/*END*/</span>0.f</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  };</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>  <span class="keyword">static_assert</span>(<a class="code hl_function" href="namespacegemmi.html#a3f62254153177c2dc47654c00525006a">ce_almost_eq</a>(radii[<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5af623e75af30e62bbd73d6df5b50bb7b5">El::D</a>)], 1.40f), <span class="stringliteral">&quot;Hmm&quot;</span>);</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>  <span class="keywordflow">return</span> radii[<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(el)];</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>  <span class="comment">// temporary solution used in Refmac</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>  <span class="keywordflow">switch</span> (el) {</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5ac1d9f50f86825a1a2302ec2449c17196">El::H</a>: <span class="keywordflow">return</span> 1.4f;</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5af623e75af30e62bbd73d6df5b50bb7b5">El::D</a>: <span class="keywordflow">return</span> 1.4f;</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5af186217753c37b9b9f958d906208506e">El::O</a>: <span class="keywordflow">return</span> 1.08f;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5a0d61f8370cad1d412f80b84d143e1257">El::C</a>: <span class="keywordflow">return</span> 2.0f;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5a8d9c307cb7f3c4a32822a51922d1ceaa">El::N</a>: <span class="keywordflow">return</span> 1.12f;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 1.6f;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>  };</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>}</div>
</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="comment">// mask utilities</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00107" data-start="{" data-end="}">
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="namespacegemmi.html#aea36cdb9bdf855f1c40a3fa79bdf8ac9">  107</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi.html#aea36cdb9bdf855f1c40a3fa79bdf8ac9">mask_points_in_constant_radius</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; mask, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Model.html">Model</a>&amp; model,</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                                    <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a>, <a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a> value,</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>                                    <span class="keywordtype">bool</span> ignore_hydrogen,</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                                    <span class="keywordtype">bool</span> ignore_zero_occupancy_atoms) {</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Chain.html">Chain</a>&amp; chain : model.<a class="code hl_variable" href="structgemmi_1_1Model.html#a8f2da0146c6e491d3a6de7d77f807c82">chains</a>)</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Residue.html">Residue</a>&amp; res : chain.residues)</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Atom.html">Atom</a>&amp; atom : res.atoms) {</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        <span class="keywordflow">if</span> ((ignore_hydrogen &amp;&amp; atom.is_hydrogen()) ||</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            (ignore_zero_occupancy_atoms &amp;&amp; atom.occ &lt;= 0))</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        mask.set_points_around(atom.pos, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a>, value);</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>      }</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>}</div>
</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00122" data-start="{" data-end="}">
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="namespacegemmi.html#a859416e005051e6c1fc41671ed345644">  122</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi.html#a859416e005051e6c1fc41671ed345644">mask_points_in_varied_radius</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; mask, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Model.html">Model</a>&amp; model,</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>                                  <a class="code hl_enumeration" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700">AtomicRadiiSet</a> atomic_radii_set,</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>                                  <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r_probe</a>, <a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a> value,</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>                                  <span class="keywordtype">bool</span> ignore_hydrogen,</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                                  <span class="keywordtype">bool</span> ignore_zero_occupancy_atoms) {</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Chain.html">Chain</a>&amp; chain : model.<a class="code hl_variable" href="structgemmi_1_1Model.html#a8f2da0146c6e491d3a6de7d77f807c82">chains</a>)</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Residue.html">Residue</a>&amp; res : chain.residues)</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Atom.html">Atom</a>&amp; atom : res.atoms) {</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>        <span class="keywordflow">if</span> ((ignore_hydrogen &amp;&amp; atom.is_hydrogen()) ||</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>            (ignore_zero_occupancy_atoms &amp;&amp; atom.occ &lt;= 0))</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>        <a class="code hl_enumeration" href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5">El</a> elem = atom.element.elem;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>        <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a> = 0;</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        <span class="keywordflow">switch</span> (atomic_radii_set) {</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>          <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700ac046eb74b3a7039a3814e202f3de33ed">AtomicRadiiSet::VanDerWaals</a>: <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a> = <a class="code hl_function" href="namespacegemmi.html#a59eea58889ac2773d366635bcb820747">vdw_radius</a>(elem); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>          <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700a2ddc9e3f17539ab413109c3a54b9e4cc">AtomicRadiiSet::Cctbx</a>: <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a> = <a class="code hl_function" href="namespacegemmi.html#a7b4551085e2416e8e93fe486333990ab">cctbx_vdw_radius</a>(elem); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>          <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700a1867bb6edc5eaf2b28b4553b28307e9e">AtomicRadiiSet::Refmac</a>: <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a> = <a class="code hl_function" href="namespacegemmi.html#ae01d979f5f2e15e9d9926359729f8487">refmac_radius_for_bulk_solvent</a>(elem); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>          <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700acb17869fe51048b5a5c4c6106551a255">AtomicRadiiSet::Constant</a>: <a class="code hl_struct" href="structgemmi_1_1HklValue.html">assert</a>(0); <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        }</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        mask.set_points_around(atom.pos, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a> + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r_probe</a>, value);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>      }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>}</div>
</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span><span class="comment">// All points != value in a distance &lt; r from value are set to margin_value</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00147" data-start="{" data-end="}">
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno"><a class="line" href="namespacegemmi.html#ac765776aa3d0f876305aaff37b2f9911">  147</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi.html#ac765776aa3d0f876305aaff37b2f9911">set_margin_around</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; mask, <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a>, <a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a> value, <a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">margin_value</a>) {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>  <span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">du</a> = (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">int</a>) std::floor(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a> / mask.spacing[0]);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  <span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dv</a> = (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">int</a>) std::floor(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a> / mask.spacing[1]);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>  <span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dw</a> = (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">int</a>) std::floor(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a> / mask.spacing[2]);</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>  <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">max_spacing2</a> = <a class="code hl_function" href="namespacegemmi.html#a9fbc626485e7d96b417dd660dcfa045c">sq</a>(std::max(std::max(mask.unit_cell.a / mask.nu,</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>                                             mask.unit_cell.b / mask.nv),</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>                                             mask.unit_cell.c / mask.nw)) + 1<a class="code hl_struct" href="structgemmi_1_1HklValue.html">e</a>-6;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>  <span class="keywordflow">if</span> (2 * <a class="code hl_struct" href="structgemmi_1_1HklValue.html">du</a> &gt;= mask.nu || 2 * <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dv</a> &gt;= mask.nv || 2 * <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dw</a> &gt;= mask.nw)</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    <a class="code hl_function" href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">fail</a>(<span class="stringliteral">&quot;grid operation failed: radius bigger than half the unit cell?&quot;</span>);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>  std::vector&lt;std::array&lt;int,3&gt;&gt; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">stencil1</a>;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>  std::vector&lt;std::array&lt;int,3&gt;&gt; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">stencil2</a>;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w = -<a class="code hl_struct" href="structgemmi_1_1HklValue.html">dw</a>; w &lt;= <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dw</a>; ++w)</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = -<a class="code hl_struct" href="structgemmi_1_1HklValue.html">dv</a>; v &lt;= <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dv</a>; ++v)</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> u = -<a class="code hl_struct" href="structgemmi_1_1HklValue.html">du</a>; u &lt;= <a class="code hl_struct" href="structgemmi_1_1HklValue.html">du</a>; ++u) {</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>        <a class="code hl_struct" href="structgemmi_1_1Fractional.html">Fractional</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">fdelta</a> = mask.get_fractional(u, v, w);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r2</a> = mask.unit_cell.orthogonalize_difference(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">fdelta</a>).length_sq();</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">r2</a> &lt;= <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a> * <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a> &amp;&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r2</a> != 0.) {</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>          std::array&lt;int,3&gt; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>{{w &lt;= 0 ? w : w - mask.nw,</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>                                 v &lt;= 0 ? v : v - mask.nv,</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>                                 u &lt;= 0 ? u : u - mask.nu}};</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>          <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">r2</a> &lt; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">max_spacing2</a>)</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            <a class="code hl_struct" href="structgemmi_1_1HklValue.html">stencil1</a>.push_back(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>);</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>            <a class="code hl_struct" href="structgemmi_1_1HklValue.html">stencil2</a>.push_back(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        }</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>      }</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">stencil2</a>.empty()) {</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    <span class="keywordflow">for</span> (<span class="keyword">typename</span> <a class="code hl_typedef" href="structgemmi_1_1Grid.html#a51f70fce4a1ec49d8119e69d74461c16">Grid&lt;T&gt;::Point</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a> : mask)</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>      <span class="keywordflow">if</span> (*<a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.<a class="code hl_variable" href="structgemmi_1_1HklValue.html#ad520912318e857a7c4ea826fd757780b">value</a> != value) {</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a> : <a class="code hl_struct" href="structgemmi_1_1HklValue.html">stencil1</a>) {</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>          <span class="keywordtype">size_t</span> idx = mask.index_near_zero(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.u + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>[2], <a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.v + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>[1], <a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.w + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>[0]);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>          <span class="keywordflow">if</span> (mask.data[idx] == value) {</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>            *<a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.<a class="code hl_variable" href="structgemmi_1_1HklValue.html#ad520912318e857a7c4ea826fd757780b">value</a> = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">margin_value</a>;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>          }</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>        }</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>      }</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="keywordflow">for</span> (<span class="keyword">typename</span> <a class="code hl_typedef" href="structgemmi_1_1Grid.html#a51f70fce4a1ec49d8119e69d74461c16">Grid&lt;T&gt;::Point</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a> : mask) {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>      <span class="keywordflow">if</span> (*<a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.<a class="code hl_variable" href="structgemmi_1_1HklValue.html#ad520912318e857a7c4ea826fd757780b">value</a> == value) {</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a> : <a class="code hl_struct" href="structgemmi_1_1HklValue.html">stencil1</a>) {</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>          <span class="keywordtype">size_t</span> idx = mask.index_near_zero(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.u + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>[2], <a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.v + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>[1], <a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.w + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>[0]);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>          <span class="keywordflow">if</span> (mask.data[idx] != value) {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>            mask.data[idx] = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">margin_value</a>;</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>            found = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>          }</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        }</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        <span class="keywordflow">if</span> (found)</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a> : <a class="code hl_struct" href="structgemmi_1_1HklValue.html">stencil2</a>) {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>            <span class="keywordtype">size_t</span> idx = mask.index_near_zero(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.u + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>[2], <a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.v + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>[1], <a class="code hl_struct" href="structgemmi_1_1HklValue.html">p</a>.w + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wvu</a>[0]);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>            <span class="keywordflow">if</span> (mask.data[idx] != value)</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>              mask.data[idx] = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">margin_value</a>;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>          }</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>      }</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    }</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>  }</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>  <span class="comment">//printf(&quot;stencil sizes: %zu\n&quot;, stencil1.size(), stencil2.size());</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>  <span class="comment">//printf(&quot;margin: %zu\n&quot;, std::count(mask.data.begin(), mask.data.end(), margin_value));</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>}</div>
</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span> </div>
<div class="foldopen" id="foldopen00208" data-start="{" data-end="};">
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html">  208</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1SolventMasker.html">SolventMasker</a> {</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#aafe4a3852c6b68bf1047ad27e0f2a6f1">  209</a></span>  <a class="code hl_enumeration" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700">AtomicRadiiSet</a> <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#aafe4a3852c6b68bf1047ad27e0f2a6f1">atomic_radii_set</a>;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#aa9f001ab2532c847529a6999a49f901b">  210</a></span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#aa9f001ab2532c847529a6999a49f901b">ignore_hydrogen</a>;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#ad59b73bda12a1d8d840ad4710dafe25f">  211</a></span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#ad59b73bda12a1d8d840ad4710dafe25f">ignore_zero_occupancy_atoms</a>;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#abe72f0c761adc3d5b9262307827a0e66">  212</a></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#abe72f0c761adc3d5b9262307827a0e66">rprobe</a>;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#af8cf404e5a1cba354b0798c4c19be088">  213</a></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#af8cf404e5a1cba354b0798c4c19be088">rshrink</a>;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#a75c8cd56b6e08aafa61fbf0a2550322d">  214</a></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#a75c8cd56b6e08aafa61fbf0a2550322d">island_min_volume</a>;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#afe073ddb7f524282e151523bd3c28851">  215</a></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#afe073ddb7f524282e151523bd3c28851">constant_r</a>;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#aedf42a476097be69f3f1dbb8769b2a91">  216</a></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#aedf42a476097be69f3f1dbb8769b2a91">requested_spacing</a> = 0.;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="foldopen" id="foldopen00218" data-start="{" data-end="}">
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#a3d430b33a52925901ca86d7ecf646402">  218</a></span>  <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#a3d430b33a52925901ca86d7ecf646402">SolventMasker</a>(<a class="code hl_enumeration" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700">AtomicRadiiSet</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">choice</a>, <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">constant_r_</a>=0.) {</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#acbeadd15ed0763713268dd67a41a8a52">set_radii</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">choice</a>, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">constant_r_</a>);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>  }</div>
</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>  <span class="comment">// currently this function sets also parameters other than radii</span></div>
<div class="foldopen" id="foldopen00223" data-start="{" data-end="}">
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#acbeadd15ed0763713268dd67a41a8a52">  223</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#acbeadd15ed0763713268dd67a41a8a52">set_radii</a>(<a class="code hl_enumeration" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700">AtomicRadiiSet</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">choice</a>, <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">constant_r_</a>=0.) {</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#aafe4a3852c6b68bf1047ad27e0f2a6f1">atomic_radii_set</a> = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">choice</a>;</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#afe073ddb7f524282e151523bd3c28851">constant_r</a> = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">constant_r_</a>;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#aa9f001ab2532c847529a6999a49f901b">ignore_hydrogen</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#ad59b73bda12a1d8d840ad4710dafe25f">ignore_zero_occupancy_atoms</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <span class="keywordflow">switch</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">choice</a>) {</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700ac046eb74b3a7039a3814e202f3de33ed">AtomicRadiiSet::VanDerWaals</a>:</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#abe72f0c761adc3d5b9262307827a0e66">rprobe</a> = 1.0;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#af8cf404e5a1cba354b0798c4c19be088">rshrink</a> = 1.1;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#a75c8cd56b6e08aafa61fbf0a2550322d">island_min_volume</a> = 0.;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700a2ddc9e3f17539ab413109c3a54b9e4cc">AtomicRadiiSet::Cctbx</a>:</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#abe72f0c761adc3d5b9262307827a0e66">rprobe</a> = 1.1;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#af8cf404e5a1cba354b0798c4c19be088">rshrink</a> = 0.9;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#a75c8cd56b6e08aafa61fbf0a2550322d">island_min_volume</a> = 0.;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700a1867bb6edc5eaf2b28b4553b28307e9e">AtomicRadiiSet::Refmac</a>:</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#abe72f0c761adc3d5b9262307827a0e66">rprobe</a> = 1.0;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#af8cf404e5a1cba354b0798c4c19be088">rshrink</a> = 0.8;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#a75c8cd56b6e08aafa61fbf0a2550322d">island_min_volume</a> = 50;  <span class="comment">// the exact value used in Refmac is yet to be found</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700acb17869fe51048b5a5c4c6106551a255">AtomicRadiiSet::Constant</a>:</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#abe72f0c761adc3d5b9262307827a0e66">rprobe</a> = 0;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#af8cf404e5a1cba354b0798c4c19be088">rshrink</a> = 0;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#a75c8cd56b6e08aafa61fbf0a2550322d">island_min_volume</a> = 0.;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    }</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>  }</div>
</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#ae2294311734255ae09ef757166b36798">  252</a></span>  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#ae2294311734255ae09ef757166b36798">clear</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; grid)<span class="keyword"> const </span>{ grid.fill((<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)1); }</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="foldopen" id="foldopen00254" data-start="{" data-end="}">
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#aec347c08f01cd6c5658a661cf5996ca2">  254</a></span>  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#aec347c08f01cd6c5658a661cf5996ca2">mask_points</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; grid, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Model.html">Model</a>&amp; model)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#aafe4a3852c6b68bf1047ad27e0f2a6f1">atomic_radii_set</a> == <a class="code hl_enumvalue" href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700acb17869fe51048b5a5c4c6106551a255">AtomicRadiiSet::Constant</a>)</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>      <a class="code hl_function" href="namespacegemmi.html#aea36cdb9bdf855f1c40a3fa79bdf8ac9">mask_points_in_constant_radius</a>(grid, model, <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#afe073ddb7f524282e151523bd3c28851">constant_r</a> + <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#abe72f0c761adc3d5b9262307827a0e66">rprobe</a>, (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)0,</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>                                     <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#aa9f001ab2532c847529a6999a49f901b">ignore_hydrogen</a>, <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#ad59b73bda12a1d8d840ad4710dafe25f">ignore_zero_occupancy_atoms</a>);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      <a class="code hl_function" href="namespacegemmi.html#a859416e005051e6c1fc41671ed345644">mask_points_in_varied_radius</a>(grid, model, <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#aafe4a3852c6b68bf1047ad27e0f2a6f1">atomic_radii_set</a>, <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#abe72f0c761adc3d5b9262307827a0e66">rprobe</a>, (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)0,</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>                                   <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#aa9f001ab2532c847529a6999a49f901b">ignore_hydrogen</a>, <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#ad59b73bda12a1d8d840ad4710dafe25f">ignore_zero_occupancy_atoms</a>);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>  }</div>
</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="foldopen" id="foldopen00263" data-start="{" data-end="}">
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#ad29644fdd7a12d002208ae116bccfc26">  263</a></span>  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#ad29644fdd7a12d002208ae116bccfc26">symmetrize</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; grid)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    grid.symmetrize([&amp;](<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a> a, <a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a> b) { <span class="keywordflow">return</span> a == (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)0 || b == (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)0 ? (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)0 : (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)1; });</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>  }</div>
</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="foldopen" id="foldopen00267" data-start="{" data-end="}">
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#a60358ef7b47341240fe3d44ff7401888">  267</a></span>  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#a60358ef7b47341240fe3d44ff7401888">shrink</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; grid)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#af8cf404e5a1cba354b0798c4c19be088">rshrink</a> &gt; 0) {</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>      <a class="code hl_function" href="namespacegemmi.html#ac765776aa3d0f876305aaff37b2f9911">set_margin_around</a>(grid, <a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#af8cf404e5a1cba354b0798c4c19be088">rshrink</a>, (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)1, (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)-1);</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>      grid.change_values((<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)-1, (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)1);</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    }</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>  }</div>
</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span> </div>
<div class="foldopen" id="foldopen00274" data-start="{" data-end="}">
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#a031007e032c981ce0caf4a60f572ef7e">  274</a></span>  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#a031007e032c981ce0caf4a60f572ef7e">invert</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; grid)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; v : grid.data)</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      v = (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)1 - v;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>  }</div>
</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span> </div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>  <span class="comment">// Removes small islands of Land=1 in the sea of 0. Uses flood fill.</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>  <span class="comment">// cf. find_blobs_by_flood_fill()</span></div>
<div class="foldopen" id="foldopen00282" data-start="{" data-end="}">
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#a451f51fc443e3a7c576f852b502053f9">  282</a></span>  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">int</span> <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#a451f51fc443e3a7c576f852b502053f9">remove_islands</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; grid)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#a75c8cd56b6e08aafa61fbf0a2550322d">island_min_volume</a> &lt;= 0)</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    <span class="keywordtype">size_t</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">limit</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="structgemmi_1_1SolventMasker.html#a75c8cd56b6e08aafa61fbf0a2550322d">island_min_volume</a> * grid.point_count()</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>                                       / grid.unit_cell.volume);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    <span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">counter</a> = 0;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    <a class="code hl_struct" href="structgemmi_1_1HklValue.html">FloodFill&lt;T,1&gt;</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">flood_fill</a>{grid};</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>    <a class="code hl_struct" href="structgemmi_1_1HklValue.html">flood_fill</a>.for_each_islands([&amp;](<span class="keyword">typename</span> <a class="code hl_struct" href="structgemmi_1_1FloodFill_1_1Result.html">FloodFill&lt;T,1&gt;::Result</a>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a>) {</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <span class="comment">//printf(&quot;island %d: %zu in %zu (limit: %zu)\n&quot;,</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        <span class="comment">//       counter, r.point_count(), lines.size(), limit);</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a>.point_count() &lt;= <a class="code hl_struct" href="structgemmi_1_1HklValue.html">limit</a>) {</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>          ++<a class="code hl_struct" href="structgemmi_1_1HklValue.html">counter</a>;</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>          <a class="code hl_struct" href="structgemmi_1_1HklValue.html">flood_fill</a>.set_volume_values(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">r</a>, (<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>)0);</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        }</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    });</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    <span class="keywordflow">return</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">counter</a>;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  }</div>
</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="foldopen" id="foldopen00300" data-start="{" data-end="}">
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#a7b22453f65f25f386b4e651c8bec6512">  300</a></span>  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#a7b22453f65f25f386b4e651c8bec6512">put_mask_on_grid</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; grid, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Model.html">Model</a>&amp; model)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#ae2294311734255ae09ef757166b36798">clear</a>(grid);</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    <a class="code hl_struct" href="structgemmi_1_1HklValue.html">assert</a>(!grid.data.empty());</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#aec347c08f01cd6c5658a661cf5996ca2">mask_points</a>(grid, model);</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#ad29644fdd7a12d002208ae116bccfc26">symmetrize</a>(grid);</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#a451f51fc443e3a7c576f852b502053f9">remove_islands</a>(grid);</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#a60358ef7b47341240fe3d44ff7401888">shrink</a>(grid);</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>  }</div>
</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="foldopen" id="foldopen00309" data-start="{" data-end="}">
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno"><a class="line" href="structgemmi_1_1SolventMasker.html#a6a9a772220cb4b07fa404bf9834451b7">  309</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#a6a9a772220cb4b07fa404bf9834451b7">set_to_zero</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;float&gt;</a>&amp; grid, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Model.html">Model</a>&amp; model)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#aec347c08f01cd6c5658a661cf5996ca2">mask_points</a>(grid, model);</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    grid.symmetrize([&amp;](<span class="keywordtype">float</span> a, <span class="keywordtype">float</span> b) { <span class="keywordflow">return</span> b == 0.f ? 0.f : a; });</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  }</div>
</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><span class="preprocessor">#if 0</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#a7b22453f65f25f386b4e651c8bec6512">put_mask_on_grid</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; grid, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Model.html">Model</a>&amp; model) {</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    <span class="comment">// use twice finer grid for solvent mask</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    <a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;std::int8_t&gt;</a> mask;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    mask.copy_metadata_from(grid);</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    mask.set_size(2*grid.nu, 2*grid.nv, 2*grid.nw);</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    mask.data.resize(8 * grid.data.size(), 1);</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <a class="code hl_function" href="structgemmi_1_1SolventMasker.html#a7b22453f65f25f386b4e651c8bec6512">put_mask_on_grid</a>(mask, model);</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w = 0, idx = 0; w &lt; grid.nw; ++w)</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; grid.nv; ++v)</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> u = 0; u &lt; grid.nu; ++u, ++idx) {</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>          grid.data[idx] = 0;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wa</a> = 0; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wa</a> &lt; 2; ++<a class="code hl_struct" href="structgemmi_1_1HklValue.html">wa</a>)</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">va</a> = 0; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">va</a> &lt; 2; ++<a class="code hl_struct" href="structgemmi_1_1HklValue.html">va</a>)</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">ua</a> = 0; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">ua</a> &lt; 2; ++<a class="code hl_struct" href="structgemmi_1_1HklValue.html">ua</a>)</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>                grid.data[idx] += mask.get_value_q(2*u + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">ua</a>, 2*v + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">va</a>, 2*w + <a class="code hl_struct" href="structgemmi_1_1HklValue.html">wa</a>);</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>          grid.data[idx] *= 1. / 8;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>        }</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>};</div>
</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="foldopen" id="foldopen00335" data-start="{" data-end="};">
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno"><a class="line" href="structgemmi_1_1NodeInfo.html">  335</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structgemmi_1_1NodeInfo.html">NodeInfo</a> {</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno"><a class="line" href="structgemmi_1_1NodeInfo.html#ab5e8a45e0ddda45b5cd9a64242927581">  336</a></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="structgemmi_1_1NodeInfo.html#ab5e8a45e0ddda45b5cd9a64242927581">dist_sq</a>;  <span class="comment">// distance from the nearest atom</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno"><a class="line" href="structgemmi_1_1NodeInfo.html#ae9eefad30d61c361cdef94ce8071fcae">  337</a></span>  <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;  <span class="comment">// the mask flag</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>  <span class="comment">//Element elem = El::X;</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno"><a class="line" href="structgemmi_1_1NodeInfo.html#af74744e07fec0351c084bbb2e01f02eb">  339</a></span>  <span class="keywordtype">int</span> u = 0, v = 0, w = 0;  <span class="comment">// not normalized near-model grid coordinates</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>};</div>
</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="foldopen" id="foldopen00343" data-start="{" data-end="}">
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno"><a class="line" href="namespacegemmi.html#ae7462dc2fe0a8510289ae9ef5c90c74b">  343</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi.html#ae7462dc2fe0a8510289ae9ef5c90c74b">mask_with_node_info</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;NodeInfo&gt;</a>&amp; mask, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Model.html">Model</a>&amp; model, <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a>) {</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>  <a class="code hl_struct" href="structgemmi_1_1NodeInfo.html">NodeInfo</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">default_ni</a>;</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>  <a class="code hl_struct" href="structgemmi_1_1HklValue.html">default_ni</a>.dist_sq = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a> * <a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a>;</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>  mask.fill(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">default_ni</a>);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>  <span class="comment">// cf. use_points_around()</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>  <span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">du</a> = (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">int</a>) std::ceil(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a> / mask.spacing[0]);</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>  <span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dv</a> = (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">int</a>) std::ceil(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a> / mask.spacing[1]);</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>  <span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dw</a> = (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">int</a>) std::ceil(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a> / mask.spacing[2]);</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>  mask.template <a class="code hl_struct" href="structgemmi_1_1HklValue.html">check_size_for_points_in_box&lt;true&gt;</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">du</a>, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dv</a>, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dw</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Chain.html">Chain</a>&amp; chain : model.<a class="code hl_variable" href="structgemmi_1_1Model.html#a8f2da0146c6e491d3a6de7d77f807c82">chains</a>)</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Residue.html">Residue</a>&amp; res : chain.residues)</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Atom.html">Atom</a>&amp; atom : res.atoms) {</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>        <a class="code hl_struct" href="structgemmi_1_1Fractional.html">Fractional</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">frac0</a> = mask.unit_cell.fractionalize(atom.pos);</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        mask.template <a class="code hl_struct" href="structgemmi_1_1HklValue.html">do_use_points_in_box&lt;true&gt;</a>(</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>            <a class="code hl_struct" href="structgemmi_1_1HklValue.html">frac0</a>, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">du</a>, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dv</a>, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dw</a>,</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>            [&amp;](<a class="code hl_struct" href="structgemmi_1_1NodeInfo.html">NodeInfo</a>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">ni</a>, <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">d2</a>, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Position.html">Position</a>&amp;, <span class="keywordtype">int</span> u, <span class="keywordtype">int</span> v, <span class="keywordtype">int</span> w) {</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>              <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">d2</a> &lt; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">ni</a>.dist_sq) {</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>                ni.dist_sq = d2;</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>                ni.found = true;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>                <span class="comment">//ni.elem = atom.element;</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>                ni.u = u;</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>                ni.v = v;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>                ni.w = w;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>              }</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>            },</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>            <a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a>);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>      }</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>}</div>
</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="foldopen" id="foldopen00376" data-start="{" data-end="}">
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno"><a class="line" href="namespacegemmi.html#aaa6f51bdfc4c1bef1ad5eb77f5a0fe2b">  376</a></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi.html#aaa6f51bdfc4c1bef1ad5eb77f5a0fe2b">unmask_symmetry_mates</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;NodeInfo&gt;</a>&amp; mask) {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>  std::vector&lt;GridOp&gt; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">symmetry_ops</a> = mask.get_scaled_ops_except_id();</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>  <span class="keywordtype">size_t</span> idx = 0;</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w = 0; w != mask.nw; ++w)</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v != mask.nv; ++v)</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> u = 0; u != mask.nu; ++u, ++idx) {</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        <a class="code hl_struct" href="structgemmi_1_1NodeInfo.html">NodeInfo</a>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">ni</a> = mask.data[idx];</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">ni</a>.found)</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>          <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1GridOp.html">GridOp</a>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">grid_op</a> : <a class="code hl_struct" href="structgemmi_1_1HklValue.html">symmetry_ops</a>) {</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>            std::array&lt;int,3&gt; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">t</a> = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">grid_op</a>.apply(u, v, w);</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>            <a class="code hl_struct" href="structgemmi_1_1NodeInfo.html">NodeInfo</a>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">im_ni</a> = mask.data[mask.index_n(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">t</a>[0], <a class="code hl_struct" href="structgemmi_1_1HklValue.html">t</a>[1], <a class="code hl_struct" href="structgemmi_1_1HklValue.html">t</a>[2])];</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>            <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">im_ni</a>.found &amp;&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">im_ni</a>.dist_sq &gt; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">ni</a>.dist_sq)</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>              <a class="code hl_struct" href="structgemmi_1_1HklValue.html">im_ni</a>.found = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>          }</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>      }</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>}</div>
</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span><span class="comment">// TODO: rename this function to interpolate_grid_around_model()</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span><span class="comment">//       would it be better to use src_model rather than dest_model?</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00396" data-start="{" data-end="}">
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno"><a class="line" href="namespacegemmi.html#adaea98457481d12c8ae29888b46325b2">  396</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi.html#adaea98457481d12c8ae29888b46325b2">interpolate_grid_of_aligned_model2</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dest</a>, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">src</a>,</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>                                        <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Transform.html">Transform</a>&amp; tr,</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>                                        <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Model.html">Model</a>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dest_model</a>, <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a>,</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>                                        <span class="keywordtype">int</span> order=1) {</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>  <a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;NodeInfo&gt;</a> mask;</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>  mask.copy_metadata_from(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">dest</a>);</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>  <a class="code hl_function" href="namespacegemmi.html#ae7462dc2fe0a8510289ae9ef5c90c74b">mask_with_node_info</a>(mask, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dest_model</a>, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">radius</a>);</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>  <a class="code hl_function" href="namespacegemmi.html#aaa6f51bdfc4c1bef1ad5eb77f5a0fe2b">unmask_symmetry_mates</a>(mask);</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>  <span class="comment">// Interpolate values for selected nodes.</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>  <a class="code hl_struct" href="structgemmi_1_1FTransform.html">FTransform</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">frac_tr</a> = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">src</a>.unit_cell.frac.combine(tr.<a class="code hl_function" href="structgemmi_1_1Transform.html#a30d4d1b7976f47b187d78d2c99f0e3d4">combine</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">dest</a>.unit_cell.orth));</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx = 0; idx != mask.data.size(); ++idx) {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1NodeInfo.html">NodeInfo</a>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">ni</a> = mask.data[idx];</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">ni</a>.found) {</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>      <a class="code hl_struct" href="structgemmi_1_1Fractional.html">Fractional</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dest_fr</a> = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dest</a>.get_fractional(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">ni</a>.u, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">ni</a>.v, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">ni</a>.w);</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>      <a class="code hl_struct" href="structgemmi_1_1Fractional.html">Fractional</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">src_fr</a> = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">frac_tr</a>.apply(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">dest_fr</a>);</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>      <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dest</a>.data[idx] = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">src</a>.interpolate_value(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">src_fr</a>, order);</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    }</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>  }</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>}</div>
</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span> </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span><span class="comment">// add soft edge to 1/0 mask using raised cosine function</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="foldopen" id="foldopen00419" data-start="{" data-end="}">
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno"><a class="line" href="namespacegemmi.html#ada7e288c35005235f4856f3a7f63b61e">  419</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespacegemmi.html#ada7e288c35005235f4856f3a7f63b61e">add_soft_edge_to_mask</a>(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">Grid&lt;T&gt;</a>&amp; grid, <span class="keywordtype">double</span> width) {</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">width2</a> = width * width;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">du</a> = (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">int</a>) std::ceil(width / grid.spacing[0]);</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dv</a> = (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">int</a>) std::ceil(width / grid.spacing[1]);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dw</a> = (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">int</a>) std::ceil(width / grid.spacing[2]);</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w = 0; w &lt; grid.nw; ++w)</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; grid.nv; ++v)</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> u = 0; u &lt; grid.nu; ++u) {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        <span class="keywordtype">size_t</span> idx = grid.index_q(u, v, w);</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>        <span class="keywordflow">if</span> (grid.data[idx] &gt;= 1<a class="code hl_struct" href="structgemmi_1_1HklValue.html">e</a>-3) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>        <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">min_d2</a> = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">width2</a> + 1;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        <a class="code hl_struct" href="structgemmi_1_1Fractional.html">Fractional</a> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">fctr</a> = grid.get_fractional(u, v, w);</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>        grid.template <a class="code hl_struct" href="structgemmi_1_1HklValue.html">use_points_in_box&lt;true&gt;</a>(</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>            <a class="code hl_struct" href="structgemmi_1_1HklValue.html">fctr</a>, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">du</a>, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dv</a>, <a class="code hl_struct" href="structgemmi_1_1HklValue.html">dw</a>,</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>            [&amp;](<a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>&amp; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">point</a>, <span class="keywordtype">double</span> <a class="code hl_struct" href="structgemmi_1_1HklValue.html">d2</a>, <span class="keyword">const</span> <a class="code hl_struct" href="structgemmi_1_1Position.html">Position</a>&amp;, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>) {</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>              <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">point</a> &gt; 0.999) {</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>                <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">d2</a> &lt; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">min_d2</a>)</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>                <a class="code hl_struct" href="structgemmi_1_1HklValue.html">min_d2</a> = <a class="code hl_struct" href="structgemmi_1_1HklValue.html">d2</a>;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>              }</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>            });</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="structgemmi_1_1HklValue.html">min_d2</a> &lt; <a class="code hl_struct" href="structgemmi_1_1HklValue.html">width2</a>)</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>          grid.data[idx] = <a class="code hl_enumvalue" href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">T</a>(0.5 + 0.5 * std::cos(<a class="code hl_function" href="namespacegemmi.html#ab2d80567b4e13921e484733ae47c757d">pi</a>() * std::sqrt(<a class="code hl_struct" href="structgemmi_1_1HklValue.html">min_d2</a>) / width));</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>      }</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>}</div>
</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span> </div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>} <span class="comment">// namespace gemmi</span></div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="afloodfill_8hpp_html"><div class="ttname"><a href="floodfill_8hpp.html">floodfill.hpp</a></div><div class="ttdoc">The flood fill (scanline fill) algorithm for Grid. Assumes periodic boundary conditions in the grid a...</div></div>
<div class="ttc" id="agrid_8hpp_html"><div class="ttname"><a href="grid_8hpp.html">grid.hpp</a></div><div class="ttdoc">3d grids used by CCP4 maps, cell-method search and hkl data.</div></div>
<div class="ttc" id="amodel_8hpp_html"><div class="ttname"><a href="model_8hpp.html">model.hpp</a></div><div class="ttdoc">Data structures to store macromolecular structure models.</div></div>
<div class="ttc" id="anamespacegemmi_html"><div class="ttname"><a href="namespacegemmi.html">gemmi</a></div><div class="ttdef"><b>Definition</b> <a href="addends_8hpp_source.html#l00012">addends.hpp:12</a></div></div>
<div class="ttc" id="anamespacegemmi_html_a3f62254153177c2dc47654c00525006a"><div class="ttname"><a href="namespacegemmi.html#a3f62254153177c2dc47654c00525006a">gemmi::ce_almost_eq</a></div><div class="ttdeci">constexpr bool ce_almost_eq(double x, double y)</div><div class="ttdef"><b>Definition</b> <a href="elem_8hpp_source.html#l00070">elem.hpp:70</a></div></div>
<div class="ttc" id="anamespacegemmi_html_a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3"><div class="ttname"><a href="namespacegemmi.html#a40476b27b97bc7ac8284d3b077b36cbfab9ece18c950afbfa6b0fdbfa4ff731d3">gemmi::PointGroup::T</a></div><div class="ttdeci">@ T</div></div>
<div class="ttc" id="anamespacegemmi_html_a59eea58889ac2773d366635bcb820747"><div class="ttname"><a href="namespacegemmi.html#a59eea58889ac2773d366635bcb820747">gemmi::vdw_radius</a></div><div class="ttdeci">float vdw_radius(El el)</div><div class="ttdef"><b>Definition</b> <a href="elem_8hpp_source.html#l00161">elem.hpp:161</a></div></div>
<div class="ttc" id="anamespacegemmi_html_a7b4551085e2416e8e93fe486333990ab"><div class="ttname"><a href="namespacegemmi.html#a7b4551085e2416e8e93fe486333990ab">gemmi::cctbx_vdw_radius</a></div><div class="ttdeci">float cctbx_vdw_radius(El el)</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00017">solmask.hpp:17</a></div></div>
<div class="ttc" id="anamespacegemmi_html_a859416e005051e6c1fc41671ed345644"><div class="ttname"><a href="namespacegemmi.html#a859416e005051e6c1fc41671ed345644">gemmi::mask_points_in_varied_radius</a></div><div class="ttdeci">void mask_points_in_varied_radius(Grid&lt; T &gt; &amp;mask, const Model &amp;model, AtomicRadiiSet atomic_radii_set, double r_probe, T value, bool ignore_hydrogen, bool ignore_zero_occupancy_atoms)</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00122">solmask.hpp:122</a></div></div>
<div class="ttc" id="anamespacegemmi_html_a94546274ac42b2449734db86790c2cb5"><div class="ttname"><a href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5">gemmi::El</a></div><div class="ttdeci">El</div><div class="ttdef"><b>Definition</b> <a href="elem_8hpp_source.html#l00013">elem.hpp:13</a></div></div>
<div class="ttc" id="anamespacegemmi_html_a94546274ac42b2449734db86790c2cb5a0d61f8370cad1d412f80b84d143e1257"><div class="ttname"><a href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5a0d61f8370cad1d412f80b84d143e1257">gemmi::El::C</a></div><div class="ttdeci">@ C</div></div>
<div class="ttc" id="anamespacegemmi_html_a94546274ac42b2449734db86790c2cb5a8d9c307cb7f3c4a32822a51922d1ceaa"><div class="ttname"><a href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5a8d9c307cb7f3c4a32822a51922d1ceaa">gemmi::El::N</a></div><div class="ttdeci">@ N</div></div>
<div class="ttc" id="anamespacegemmi_html_a94546274ac42b2449734db86790c2cb5ab1a326c06d88bf042f73d70f50197905"><div class="ttname"><a href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5ab1a326c06d88bf042f73d70f50197905">gemmi::El::END</a></div><div class="ttdeci">@ END</div></div>
<div class="ttc" id="anamespacegemmi_html_a94546274ac42b2449734db86790c2cb5ac1d9f50f86825a1a2302ec2449c17196"><div class="ttname"><a href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5ac1d9f50f86825a1a2302ec2449c17196">gemmi::El::H</a></div><div class="ttdeci">@ H</div></div>
<div class="ttc" id="anamespacegemmi_html_a94546274ac42b2449734db86790c2cb5af186217753c37b9b9f958d906208506e"><div class="ttname"><a href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5af186217753c37b9b9f958d906208506e">gemmi::El::O</a></div><div class="ttdeci">@ O</div></div>
<div class="ttc" id="anamespacegemmi_html_a94546274ac42b2449734db86790c2cb5af623e75af30e62bbd73d6df5b50bb7b5"><div class="ttname"><a href="namespacegemmi.html#a94546274ac42b2449734db86790c2cb5af623e75af30e62bbd73d6df5b50bb7b5">gemmi::El::D</a></div><div class="ttdeci">@ D</div></div>
<div class="ttc" id="anamespacegemmi_html_a9fbc626485e7d96b417dd660dcfa045c"><div class="ttname"><a href="namespacegemmi.html#a9fbc626485e7d96b417dd660dcfa045c">gemmi::sq</a></div><div class="ttdeci">constexpr float sq(float x)</div><div class="ttdef"><b>Definition</b> <a href="math_8hpp_source.html#l00034">math.hpp:34</a></div></div>
<div class="ttc" id="anamespacegemmi_html_aaa6f51bdfc4c1bef1ad5eb77f5a0fe2b"><div class="ttname"><a href="namespacegemmi.html#aaa6f51bdfc4c1bef1ad5eb77f5a0fe2b">gemmi::unmask_symmetry_mates</a></div><div class="ttdeci">void unmask_symmetry_mates(Grid&lt; NodeInfo &gt; &amp;mask)</div><div class="ttdoc">Skip nodes that are closer to a symmetry mate of the model than to the original model.</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00376">solmask.hpp:376</a></div></div>
<div class="ttc" id="anamespacegemmi_html_ab2d80567b4e13921e484733ae47c757d"><div class="ttname"><a href="namespacegemmi.html#ab2d80567b4e13921e484733ae47c757d">gemmi::pi</a></div><div class="ttdeci">constexpr double pi()</div><div class="ttdef"><b>Definition</b> <a href="math_8hpp_source.html#l00016">math.hpp:16</a></div></div>
<div class="ttc" id="anamespacegemmi_html_ac0edc00331dd25cdcfc4cb424c30d700"><div class="ttname"><a href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700">gemmi::AtomicRadiiSet</a></div><div class="ttdeci">AtomicRadiiSet</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00014">solmask.hpp:14</a></div></div>
<div class="ttc" id="anamespacegemmi_html_ac0edc00331dd25cdcfc4cb424c30d700a1867bb6edc5eaf2b28b4553b28307e9e"><div class="ttname"><a href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700a1867bb6edc5eaf2b28b4553b28307e9e">gemmi::AtomicRadiiSet::Refmac</a></div><div class="ttdeci">@ Refmac</div></div>
<div class="ttc" id="anamespacegemmi_html_ac0edc00331dd25cdcfc4cb424c30d700a2ddc9e3f17539ab413109c3a54b9e4cc"><div class="ttname"><a href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700a2ddc9e3f17539ab413109c3a54b9e4cc">gemmi::AtomicRadiiSet::Cctbx</a></div><div class="ttdeci">@ Cctbx</div></div>
<div class="ttc" id="anamespacegemmi_html_ac0edc00331dd25cdcfc4cb424c30d700ac046eb74b3a7039a3814e202f3de33ed"><div class="ttname"><a href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700ac046eb74b3a7039a3814e202f3de33ed">gemmi::AtomicRadiiSet::VanDerWaals</a></div><div class="ttdeci">@ VanDerWaals</div></div>
<div class="ttc" id="anamespacegemmi_html_ac0edc00331dd25cdcfc4cb424c30d700acb17869fe51048b5a5c4c6106551a255"><div class="ttname"><a href="namespacegemmi.html#ac0edc00331dd25cdcfc4cb424c30d700acb17869fe51048b5a5c4c6106551a255">gemmi::AtomicRadiiSet::Constant</a></div><div class="ttdeci">@ Constant</div></div>
<div class="ttc" id="anamespacegemmi_html_ac765776aa3d0f876305aaff37b2f9911"><div class="ttname"><a href="namespacegemmi.html#ac765776aa3d0f876305aaff37b2f9911">gemmi::set_margin_around</a></div><div class="ttdeci">void set_margin_around(Grid&lt; T &gt; &amp;mask, double r, T value, T margin_value)</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00147">solmask.hpp:147</a></div></div>
<div class="ttc" id="anamespacegemmi_html_ace5bd65601f8e51653de63a7afa7f380"><div class="ttname"><a href="namespacegemmi.html#ace5bd65601f8e51653de63a7afa7f380">gemmi::fail</a></div><div class="ttdeci">void fail(const std::string &amp;msg)</div><div class="ttdef"><b>Definition</b> <a href="fail_8hpp_source.html#l00059">fail.hpp:59</a></div></div>
<div class="ttc" id="anamespacegemmi_html_ada7e288c35005235f4856f3a7f63b61e"><div class="ttname"><a href="namespacegemmi.html#ada7e288c35005235f4856f3a7f63b61e">gemmi::add_soft_edge_to_mask</a></div><div class="ttdeci">void add_soft_edge_to_mask(Grid&lt; T &gt; &amp;grid, double width)</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00419">solmask.hpp:419</a></div></div>
<div class="ttc" id="anamespacegemmi_html_adaea98457481d12c8ae29888b46325b2"><div class="ttname"><a href="namespacegemmi.html#adaea98457481d12c8ae29888b46325b2">gemmi::interpolate_grid_of_aligned_model2</a></div><div class="ttdeci">void interpolate_grid_of_aligned_model2(Grid&lt; T &gt; &amp;dest, const Grid&lt; T &gt; &amp;src, const Transform &amp;tr, const Model &amp;dest_model, double radius, int order=1)</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00396">solmask.hpp:396</a></div></div>
<div class="ttc" id="anamespacegemmi_html_ae01d979f5f2e15e9d9926359729f8487"><div class="ttname"><a href="namespacegemmi.html#ae01d979f5f2e15e9d9926359729f8487">gemmi::refmac_radius_for_bulk_solvent</a></div><div class="ttdeci">float refmac_radius_for_bulk_solvent(El el)</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00057">solmask.hpp:57</a></div></div>
<div class="ttc" id="anamespacegemmi_html_ae7462dc2fe0a8510289ae9ef5c90c74b"><div class="ttname"><a href="namespacegemmi.html#ae7462dc2fe0a8510289ae9ef5c90c74b">gemmi::mask_with_node_info</a></div><div class="ttdeci">void mask_with_node_info(Grid&lt; NodeInfo &gt; &amp;mask, const Model &amp;model, double radius)</div><div class="ttdoc">Populate NodeInfo grid for nodes near the model.</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00343">solmask.hpp:343</a></div></div>
<div class="ttc" id="anamespacegemmi_html_aea36cdb9bdf855f1c40a3fa79bdf8ac9"><div class="ttname"><a href="namespacegemmi.html#aea36cdb9bdf855f1c40a3fa79bdf8ac9">gemmi::mask_points_in_constant_radius</a></div><div class="ttdeci">void mask_points_in_constant_radius(Grid&lt; T &gt; &amp;mask, const Model &amp;model, double radius, T value, bool ignore_hydrogen, bool ignore_zero_occupancy_atoms)</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00107">solmask.hpp:107</a></div></div>
<div class="ttc" id="astructgemmi_1_1Atom_html"><div class="ttname"><a href="structgemmi_1_1Atom.html">gemmi::Atom</a></div><div class="ttdoc">Represents atom site in macromolecular structure (~100 bytes).</div><div class="ttdef"><b>Definition</b> <a href="model_8hpp_source.html#l00119">model.hpp:119</a></div></div>
<div class="ttc" id="astructgemmi_1_1Chain_html"><div class="ttname"><a href="structgemmi_1_1Chain.html">gemmi::Chain</a></div><div class="ttdef"><b>Definition</b> <a href="model_8hpp_source.html#l00476">model.hpp:476</a></div></div>
<div class="ttc" id="astructgemmi_1_1FTransform_html"><div class="ttname"><a href="structgemmi_1_1FTransform.html">gemmi::FTransform</a></div><div class="ttdoc">Like Transform, but apply() arg is Fractional (not Vec3 - for type safety).</div><div class="ttdef"><b>Definition</b> <a href="unitcell_8hpp_source.html#l00112">unitcell.hpp:112</a></div></div>
<div class="ttc" id="astructgemmi_1_1FloodFill_1_1Result_html"><div class="ttname"><a href="structgemmi_1_1FloodFill_1_1Result.html">gemmi::FloodFill::Result</a></div><div class="ttdef"><b>Definition</b> <a href="floodfill_8hpp_source.html#l00024">floodfill.hpp:24</a></div></div>
<div class="ttc" id="astructgemmi_1_1Fractional_html"><div class="ttname"><a href="structgemmi_1_1Fractional.html">gemmi::Fractional</a></div><div class="ttdoc">Fractional coordinates.</div><div class="ttdef"><b>Definition</b> <a href="unitcell_8hpp_source.html#l00050">unitcell.hpp:50</a></div></div>
<div class="ttc" id="astructgemmi_1_1GridOp_html"><div class="ttname"><a href="structgemmi_1_1GridOp.html">gemmi::GridOp</a></div><div class="ttdef"><b>Definition</b> <a href="grid_8hpp_source.html#l00116">grid.hpp:116</a></div></div>
<div class="ttc" id="astructgemmi_1_1Grid_html_a51f70fce4a1ec49d8119e69d74461c16"><div class="ttname"><a href="structgemmi_1_1Grid.html#a51f70fce4a1ec49d8119e69d74461c16">gemmi::Grid::Point</a></div><div class="ttdeci">typename GridBase&lt; T &gt;::Point Point</div><div class="ttdef"><b>Definition</b> <a href="grid_8hpp_source.html#l00313">grid.hpp:313</a></div></div>
<div class="ttc" id="astructgemmi_1_1HklValue_html"><div class="ttname"><a href="structgemmi_1_1HklValue.html">gemmi::HklValue</a></div><div class="ttdef"><b>Definition</b> <a href="asudata_8hpp_source.html#l00098">asudata.hpp:98</a></div></div>
<div class="ttc" id="astructgemmi_1_1HklValue_html_ad520912318e857a7c4ea826fd757780b"><div class="ttname"><a href="structgemmi_1_1HklValue.html#ad520912318e857a7c4ea826fd757780b">gemmi::HklValue::value</a></div><div class="ttdeci">T value</div><div class="ttdef"><b>Definition</b> <a href="asudata_8hpp_source.html#l00100">asudata.hpp:100</a></div></div>
<div class="ttc" id="astructgemmi_1_1Model_html"><div class="ttname"><a href="structgemmi_1_1Model.html">gemmi::Model</a></div><div class="ttdef"><b>Definition</b> <a href="model_8hpp_source.html#l00712">model.hpp:712</a></div></div>
<div class="ttc" id="astructgemmi_1_1Model_html_a8f2da0146c6e491d3a6de7d77f807c82"><div class="ttname"><a href="structgemmi_1_1Model.html#a8f2da0146c6e491d3a6de7d77f807c82">gemmi::Model::chains</a></div><div class="ttdeci">std::vector&lt; Chain &gt; chains</div><div class="ttdef"><b>Definition</b> <a href="model_8hpp_source.html#l00715">model.hpp:715</a></div></div>
<div class="ttc" id="astructgemmi_1_1NodeInfo_html"><div class="ttname"><a href="structgemmi_1_1NodeInfo.html">gemmi::NodeInfo</a></div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00335">solmask.hpp:335</a></div></div>
<div class="ttc" id="astructgemmi_1_1NodeInfo_html_ab5e8a45e0ddda45b5cd9a64242927581"><div class="ttname"><a href="structgemmi_1_1NodeInfo.html#ab5e8a45e0ddda45b5cd9a64242927581">gemmi::NodeInfo::dist_sq</a></div><div class="ttdeci">double dist_sq</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00336">solmask.hpp:336</a></div></div>
<div class="ttc" id="astructgemmi_1_1Position_html"><div class="ttname"><a href="structgemmi_1_1Position.html">gemmi::Position</a></div><div class="ttdoc">Coordinates in Angstroms - orthogonal (Cartesian) coordinates.</div><div class="ttdef"><b>Definition</b> <a href="unitcell_8hpp_source.html#l00032">unitcell.hpp:32</a></div></div>
<div class="ttc" id="astructgemmi_1_1Residue_html"><div class="ttname"><a href="structgemmi_1_1Residue.html">gemmi::Residue</a></div><div class="ttdef"><b>Definition</b> <a href="model_8hpp_source.html#l00183">model.hpp:183</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html">gemmi::SolventMasker</a></div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00208">solmask.hpp:208</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_a031007e032c981ce0caf4a60f572ef7e"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#a031007e032c981ce0caf4a60f572ef7e">gemmi::SolventMasker::invert</a></div><div class="ttdeci">void invert(Grid&lt; T &gt; &amp;grid) const</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00274">solmask.hpp:274</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_a3d430b33a52925901ca86d7ecf646402"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#a3d430b33a52925901ca86d7ecf646402">gemmi::SolventMasker::SolventMasker</a></div><div class="ttdeci">SolventMasker(AtomicRadiiSet choice, double constant_r_=0.)</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00218">solmask.hpp:218</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_a451f51fc443e3a7c576f852b502053f9"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#a451f51fc443e3a7c576f852b502053f9">gemmi::SolventMasker::remove_islands</a></div><div class="ttdeci">int remove_islands(Grid&lt; T &gt; &amp;grid) const</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00282">solmask.hpp:282</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_a60358ef7b47341240fe3d44ff7401888"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#a60358ef7b47341240fe3d44ff7401888">gemmi::SolventMasker::shrink</a></div><div class="ttdeci">void shrink(Grid&lt; T &gt; &amp;grid) const</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00267">solmask.hpp:267</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_a6a9a772220cb4b07fa404bf9834451b7"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#a6a9a772220cb4b07fa404bf9834451b7">gemmi::SolventMasker::set_to_zero</a></div><div class="ttdeci">void set_to_zero(Grid&lt; float &gt; &amp;grid, const Model &amp;model) const</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00309">solmask.hpp:309</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_a75c8cd56b6e08aafa61fbf0a2550322d"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#a75c8cd56b6e08aafa61fbf0a2550322d">gemmi::SolventMasker::island_min_volume</a></div><div class="ttdeci">double island_min_volume</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00214">solmask.hpp:214</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_a7b22453f65f25f386b4e651c8bec6512"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#a7b22453f65f25f386b4e651c8bec6512">gemmi::SolventMasker::put_mask_on_grid</a></div><div class="ttdeci">void put_mask_on_grid(Grid&lt; T &gt; &amp;grid, const Model &amp;model) const</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00300">solmask.hpp:300</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_aa9f001ab2532c847529a6999a49f901b"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#aa9f001ab2532c847529a6999a49f901b">gemmi::SolventMasker::ignore_hydrogen</a></div><div class="ttdeci">bool ignore_hydrogen</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00210">solmask.hpp:210</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_aafe4a3852c6b68bf1047ad27e0f2a6f1"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#aafe4a3852c6b68bf1047ad27e0f2a6f1">gemmi::SolventMasker::atomic_radii_set</a></div><div class="ttdeci">AtomicRadiiSet atomic_radii_set</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00209">solmask.hpp:209</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_abe72f0c761adc3d5b9262307827a0e66"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#abe72f0c761adc3d5b9262307827a0e66">gemmi::SolventMasker::rprobe</a></div><div class="ttdeci">double rprobe</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00212">solmask.hpp:212</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_acbeadd15ed0763713268dd67a41a8a52"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#acbeadd15ed0763713268dd67a41a8a52">gemmi::SolventMasker::set_radii</a></div><div class="ttdeci">void set_radii(AtomicRadiiSet choice, double constant_r_=0.)</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00223">solmask.hpp:223</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_ad29644fdd7a12d002208ae116bccfc26"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#ad29644fdd7a12d002208ae116bccfc26">gemmi::SolventMasker::symmetrize</a></div><div class="ttdeci">void symmetrize(Grid&lt; T &gt; &amp;grid) const</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00263">solmask.hpp:263</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_ad59b73bda12a1d8d840ad4710dafe25f"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#ad59b73bda12a1d8d840ad4710dafe25f">gemmi::SolventMasker::ignore_zero_occupancy_atoms</a></div><div class="ttdeci">bool ignore_zero_occupancy_atoms</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00211">solmask.hpp:211</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_ae2294311734255ae09ef757166b36798"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#ae2294311734255ae09ef757166b36798">gemmi::SolventMasker::clear</a></div><div class="ttdeci">void clear(Grid&lt; T &gt; &amp;grid) const</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00252">solmask.hpp:252</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_aec347c08f01cd6c5658a661cf5996ca2"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#aec347c08f01cd6c5658a661cf5996ca2">gemmi::SolventMasker::mask_points</a></div><div class="ttdeci">void mask_points(Grid&lt; T &gt; &amp;grid, const Model &amp;model) const</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00254">solmask.hpp:254</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_aedf42a476097be69f3f1dbb8769b2a91"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#aedf42a476097be69f3f1dbb8769b2a91">gemmi::SolventMasker::requested_spacing</a></div><div class="ttdeci">double requested_spacing</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00216">solmask.hpp:216</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_af8cf404e5a1cba354b0798c4c19be088"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#af8cf404e5a1cba354b0798c4c19be088">gemmi::SolventMasker::rshrink</a></div><div class="ttdeci">double rshrink</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00213">solmask.hpp:213</a></div></div>
<div class="ttc" id="astructgemmi_1_1SolventMasker_html_afe073ddb7f524282e151523bd3c28851"><div class="ttname"><a href="structgemmi_1_1SolventMasker.html#afe073ddb7f524282e151523bd3c28851">gemmi::SolventMasker::constant_r</a></div><div class="ttdeci">double constant_r</div><div class="ttdef"><b>Definition</b> <a href="solmask_8hpp_source.html#l00215">solmask.hpp:215</a></div></div>
<div class="ttc" id="astructgemmi_1_1Transform_html"><div class="ttname"><a href="structgemmi_1_1Transform.html">gemmi::Transform</a></div><div class="ttdef"><b>Definition</b> <a href="math_8hpp_source.html#l00388">math.hpp:388</a></div></div>
<div class="ttc" id="astructgemmi_1_1Transform_html_a30d4d1b7976f47b187d78d2c99f0e3d4"><div class="ttname"><a href="structgemmi_1_1Transform.html#a30d4d1b7976f47b187d78d2c99f0e3d4">gemmi::Transform::combine</a></div><div class="ttdeci">Transform combine(const Transform &amp;b) const</div><div class="ttdef"><b>Definition</b> <a href="math_8hpp_source.html#l00399">math.hpp:399</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
